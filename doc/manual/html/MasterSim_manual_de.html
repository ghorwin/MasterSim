<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<meta name="generator" content="Asciidoctor 2.0.10">
<meta name="author" content="Andreas Nicolai">
<title>MasterSim Benutzerhandbuch</title>
<link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Open+Sans:300,300italic,400,400italic,600,600italic%7CNoto+Serif:400,400italic,700,700italic%7CDroid+Sans+Mono:400,700">
<style>
/* Asciidoctor default stylesheet | MIT License | https://asciidoctor.org */
/* Uncomment @import statement to use as custom stylesheet */
/*@import "https://fonts.googleapis.com/css?family=Open+Sans:300,300italic,400,400italic,600,600italic%7CNoto+Serif:400,400italic,700,700italic%7CDroid+Sans+Mono:400,700";*/
article,aside,details,figcaption,figure,footer,header,hgroup,main,nav,section{display:block}
audio,video{display:inline-block}
audio:not([controls]){display:none;height:0}
html{font-family:sans-serif;-ms-text-size-adjust:100%;-webkit-text-size-adjust:100%}
a{background:none}
a:focus{outline:thin dotted}
a:active,a:hover{outline:0}
h1{font-size:2em;margin:.67em 0}
abbr[title]{border-bottom:1px dotted}
b,strong{font-weight:bold}
dfn{font-style:italic}
hr{-moz-box-sizing:content-box;box-sizing:content-box;height:0}
mark{background:#ff0;color:#000}
code,kbd,pre,samp{font-family:monospace;font-size:1em}
pre{white-space:pre-wrap}
q{quotes:"\201C" "\201D" "\2018" "\2019"}
small{font-size:80%}
sub,sup{font-size:75%;line-height:0;position:relative;vertical-align:baseline}
sup{top:-.5em}
sub{bottom:-.25em}
img{border:0}
svg:not(:root){overflow:hidden}
figure{margin:0}
fieldset{border:1px solid silver;margin:0 2px;padding:.35em .625em .75em}
legend{border:0;padding:0}
button,input,select,textarea{font-family:inherit;font-size:100%;margin:0}
button,input{line-height:normal}
button,select{text-transform:none}
button,html input[type="button"],input[type="reset"],input[type="submit"]{-webkit-appearance:button;cursor:pointer}
button[disabled],html input[disabled]{cursor:default}
input[type="checkbox"],input[type="radio"]{box-sizing:border-box;padding:0}
button::-moz-focus-inner,input::-moz-focus-inner{border:0;padding:0}
textarea{overflow:auto;vertical-align:top}
table{border-collapse:collapse;border-spacing:0}
*,*::before,*::after{-moz-box-sizing:border-box;-webkit-box-sizing:border-box;box-sizing:border-box}
html,body{font-size:100%}
body{background:#fff;color:rgba(0,0,0,.8);padding:0;margin:0;font-family:"Noto Serif","DejaVu Serif",serif;font-weight:400;font-style:normal;line-height:1;position:relative;cursor:auto;tab-size:4;-moz-osx-font-smoothing:grayscale;-webkit-font-smoothing:antialiased}
a:hover{cursor:pointer}
img,object,embed{max-width:100%;height:auto}
object,embed{height:100%}
img{-ms-interpolation-mode:bicubic}
.left{float:left!important}
.right{float:right!important}
.text-left{text-align:left!important}
.text-right{text-align:right!important}
.text-center{text-align:center!important}
.text-justify{text-align:justify!important}
.hide{display:none}
img,object,svg{display:inline-block;vertical-align:middle}
textarea{height:auto;min-height:50px}
select{width:100%}
.center{margin-left:auto;margin-right:auto}
.stretch{width:100%}
.subheader,.admonitionblock td.content>.title,.audioblock>.title,.exampleblock>.title,.imageblock>.title,.listingblock>.title,.literalblock>.title,.stemblock>.title,.openblock>.title,.paragraph>.title,.quoteblock>.title,table.tableblock>.title,.verseblock>.title,.videoblock>.title,.dlist>.title,.olist>.title,.ulist>.title,.qlist>.title,.hdlist>.title{line-height:1.45;color:#7a2518;font-weight:400;margin-top:0;margin-bottom:.25em}
div,dl,dt,dd,ul,ol,li,h1,h2,h3,#toctitle,.sidebarblock>.content>.title,h4,h5,h6,pre,form,p,blockquote,th,td{margin:0;padding:0;direction:ltr}
a{color:#2156a5;text-decoration:underline;line-height:inherit}
a:hover,a:focus{color:#1d4b8f}
a img{border:0}
p{font-family:inherit;font-weight:400;font-size:1em;line-height:1.6;margin-bottom:1.25em;text-rendering:optimizeLegibility}
p aside{font-size:.875em;line-height:1.35;font-style:italic}
h1,h2,h3,#toctitle,.sidebarblock>.content>.title,h4,h5,h6{font-family:"Open Sans","DejaVu Sans",sans-serif;font-weight:300;font-style:normal;color:#ba3925;text-rendering:optimizeLegibility;margin-top:1em;margin-bottom:.5em;line-height:1.0125em}
h1 small,h2 small,h3 small,#toctitle small,.sidebarblock>.content>.title small,h4 small,h5 small,h6 small{font-size:60%;color:#e99b8f;line-height:0}
h1{font-size:2.125em}
h2{font-size:1.6875em}
h3,#toctitle,.sidebarblock>.content>.title{font-size:1.375em}
h4,h5{font-size:1.125em}
h6{font-size:1em}
hr{border:solid #dddddf;border-width:1px 0 0;clear:both;margin:1.25em 0 1.1875em;height:0}
em,i{font-style:italic;line-height:inherit}
strong,b{font-weight:bold;line-height:inherit}
small{font-size:60%;line-height:inherit}
code{font-family:"Droid Sans Mono","DejaVu Sans Mono",monospace;font-weight:400;color:rgba(0,0,0,.9)}
ul,ol,dl{font-size:1em;line-height:1.6;margin-bottom:1.25em;list-style-position:outside;font-family:inherit}
ul,ol{margin-left:1.5em}
ul li ul,ul li ol{margin-left:1.25em;margin-bottom:0;font-size:1em}
ul.square li ul,ul.circle li ul,ul.disc li ul{list-style:inherit}
ul.square{list-style-type:square}
ul.circle{list-style-type:circle}
ul.disc{list-style-type:disc}
ol li ul,ol li ol{margin-left:1.25em;margin-bottom:0}
dl dt{margin-bottom:.3125em;font-weight:bold}
dl dd{margin-bottom:1.25em}
abbr,acronym{text-transform:uppercase;font-size:90%;color:rgba(0,0,0,.8);border-bottom:1px dotted #ddd;cursor:help}
abbr{text-transform:none}
blockquote{margin:0 0 1.25em;padding:.5625em 1.25em 0 1.1875em;border-left:1px solid #ddd}
blockquote cite{display:block;font-size:.9375em;color:rgba(0,0,0,.6)}
blockquote cite::before{content:"\2014 \0020"}
blockquote cite a,blockquote cite a:visited{color:rgba(0,0,0,.6)}
blockquote,blockquote p{line-height:1.6;color:rgba(0,0,0,.85)}
@media screen and (min-width:768px){h1,h2,h3,#toctitle,.sidebarblock>.content>.title,h4,h5,h6{line-height:1.2}
h1{font-size:2.75em}
h2{font-size:2.3125em}
h3,#toctitle,.sidebarblock>.content>.title{font-size:1.6875em}
h4{font-size:1.4375em}}
table{background:#fff;margin-bottom:1.25em;border:solid 1px #dedede}
table thead,table tfoot{background:#f7f8f7}
table thead tr th,table thead tr td,table tfoot tr th,table tfoot tr td{padding:.5em .625em .625em;font-size:inherit;color:rgba(0,0,0,.8);text-align:left}
table tr th,table tr td{padding:.5625em .625em;font-size:inherit;color:rgba(0,0,0,.8)}
table tr.even,table tr.alt{background:#f8f8f7}
table thead tr th,table tfoot tr th,table tbody tr td,table tr td,table tfoot tr td{display:table-cell;line-height:1.6}
h1,h2,h3,#toctitle,.sidebarblock>.content>.title,h4,h5,h6{line-height:1.2;word-spacing:-.05em}
h1 strong,h2 strong,h3 strong,#toctitle strong,.sidebarblock>.content>.title strong,h4 strong,h5 strong,h6 strong{font-weight:400}
.clearfix::before,.clearfix::after,.float-group::before,.float-group::after{content:" ";display:table}
.clearfix::after,.float-group::after{clear:both}
:not(pre):not([class^=L])>code{font-size:.9375em;font-style:normal!important;letter-spacing:0;padding:.1em .5ex;word-spacing:-.15em;background:#f7f7f8;-webkit-border-radius:4px;border-radius:4px;line-height:1.45;text-rendering:optimizeSpeed;word-wrap:break-word}
:not(pre)>code.nobreak{word-wrap:normal}
:not(pre)>code.nowrap{white-space:nowrap}
pre{color:rgba(0,0,0,.9);font-family:"Droid Sans Mono","DejaVu Sans Mono",monospace;line-height:1.45;text-rendering:optimizeSpeed}
pre code,pre pre{color:inherit;font-size:inherit;line-height:inherit}
pre>code{display:block}
pre.nowrap,pre.nowrap pre{white-space:pre;word-wrap:normal}
em em{font-style:normal}
strong strong{font-weight:400}
.keyseq{color:rgba(51,51,51,.8)}
kbd{font-family:"Droid Sans Mono","DejaVu Sans Mono",monospace;display:inline-block;color:rgba(0,0,0,.8);font-size:.65em;line-height:1.45;background:#f7f7f7;border:1px solid #ccc;-webkit-border-radius:3px;border-radius:3px;-webkit-box-shadow:0 1px 0 rgba(0,0,0,.2),0 0 0 .1em white inset;box-shadow:0 1px 0 rgba(0,0,0,.2),0 0 0 .1em #fff inset;margin:0 .15em;padding:.2em .5em;vertical-align:middle;position:relative;top:-.1em;white-space:nowrap}
.keyseq kbd:first-child{margin-left:0}
.keyseq kbd:last-child{margin-right:0}
.menuseq,.menuref{color:#000}
.menuseq b:not(.caret),.menuref{font-weight:inherit}
.menuseq{word-spacing:-.02em}
.menuseq b.caret{font-size:1.25em;line-height:.8}
.menuseq i.caret{font-weight:bold;text-align:center;width:.45em}
b.button::before,b.button::after{position:relative;top:-1px;font-weight:400}
b.button::before{content:"[";padding:0 3px 0 2px}
b.button::after{content:"]";padding:0 2px 0 3px}
p a>code:hover{color:rgba(0,0,0,.9)}
#header,#content,#footnotes,#footer{width:100%;margin-left:auto;margin-right:auto;margin-top:0;margin-bottom:0;max-width:62.5em;*zoom:1;position:relative;padding-left:.9375em;padding-right:.9375em}
#header::before,#header::after,#content::before,#content::after,#footnotes::before,#footnotes::after,#footer::before,#footer::after{content:" ";display:table}
#header::after,#content::after,#footnotes::after,#footer::after{clear:both}
#content{margin-top:1.25em}
#content::before{content:none}
#header>h1:first-child{color:rgba(0,0,0,.85);margin-top:2.25rem;margin-bottom:0}
#header>h1:first-child+#toc{margin-top:8px;border-top:1px solid #dddddf}
#header>h1:only-child,body.toc2 #header>h1:nth-last-child(2){border-bottom:1px solid #dddddf;padding-bottom:8px}
#header .details{border-bottom:1px solid #dddddf;line-height:1.45;padding-top:.25em;padding-bottom:.25em;padding-left:.25em;color:rgba(0,0,0,.6);display:-ms-flexbox;display:-webkit-flex;display:flex;-ms-flex-flow:row wrap;-webkit-flex-flow:row wrap;flex-flow:row wrap}
#header .details span:first-child{margin-left:-.125em}
#header .details span.email a{color:rgba(0,0,0,.85)}
#header .details br{display:none}
#header .details br+span::before{content:"\00a0\2013\00a0"}
#header .details br+span.author::before{content:"\00a0\22c5\00a0";color:rgba(0,0,0,.85)}
#header .details br+span#revremark::before{content:"\00a0|\00a0"}
#header #revnumber{text-transform:capitalize}
#header #revnumber::after{content:"\00a0"}
#content>h1:first-child:not([class]){color:rgba(0,0,0,.85);border-bottom:1px solid #dddddf;padding-bottom:8px;margin-top:0;padding-top:1rem;margin-bottom:1.25rem}
#toc{border-bottom:1px solid #e7e7e9;padding-bottom:.5em}
#toc>ul{margin-left:.125em}
#toc ul.sectlevel0>li>a{font-style:italic}
#toc ul.sectlevel0 ul.sectlevel1{margin:.5em 0}
#toc ul{font-family:"Open Sans","DejaVu Sans",sans-serif;list-style-type:none}
#toc li{line-height:1.3334;margin-top:.3334em}
#toc a{text-decoration:none}
#toc a:active{text-decoration:underline}
#toctitle{color:#7a2518;font-size:1.2em}
@media screen and (min-width:768px){#toctitle{font-size:1.375em}
body.toc2{padding-left:15em;padding-right:0}
#toc.toc2{margin-top:0!important;background:#f8f8f7;position:fixed;width:15em;left:0;top:0;border-right:1px solid #e7e7e9;border-top-width:0!important;border-bottom-width:0!important;z-index:1000;padding:1.25em 1em;height:100%;overflow:auto}
#toc.toc2 #toctitle{margin-top:0;margin-bottom:.8rem;font-size:1.2em}
#toc.toc2>ul{font-size:.9em;margin-bottom:0}
#toc.toc2 ul ul{margin-left:0;padding-left:1em}
#toc.toc2 ul.sectlevel0 ul.sectlevel1{padding-left:0;margin-top:.5em;margin-bottom:.5em}
body.toc2.toc-right{padding-left:0;padding-right:15em}
body.toc2.toc-right #toc.toc2{border-right-width:0;border-left:1px solid #e7e7e9;left:auto;right:0}}
@media screen and (min-width:1280px){body.toc2{padding-left:20em;padding-right:0}
#toc.toc2{width:20em}
#toc.toc2 #toctitle{font-size:1.375em}
#toc.toc2>ul{font-size:.95em}
#toc.toc2 ul ul{padding-left:1.25em}
body.toc2.toc-right{padding-left:0;padding-right:20em}}
#content #toc{border-style:solid;border-width:1px;border-color:#e0e0dc;margin-bottom:1.25em;padding:1.25em;background:#f8f8f7;-webkit-border-radius:4px;border-radius:4px}
#content #toc>:first-child{margin-top:0}
#content #toc>:last-child{margin-bottom:0}
#footer{max-width:100%;background:rgba(0,0,0,.8);padding:1.25em}
#footer-text{color:rgba(255,255,255,.8);line-height:1.44}
#content{margin-bottom:.625em}
.sect1{padding-bottom:.625em}
@media screen and (min-width:768px){#content{margin-bottom:1.25em}
.sect1{padding-bottom:1.25em}}
.sect1:last-child{padding-bottom:0}
.sect1+.sect1{border-top:1px solid #e7e7e9}
#content h1>a.anchor,h2>a.anchor,h3>a.anchor,#toctitle>a.anchor,.sidebarblock>.content>.title>a.anchor,h4>a.anchor,h5>a.anchor,h6>a.anchor{position:absolute;z-index:1001;width:1.5ex;margin-left:-1.5ex;display:block;text-decoration:none!important;visibility:hidden;text-align:center;font-weight:400}
#content h1>a.anchor::before,h2>a.anchor::before,h3>a.anchor::before,#toctitle>a.anchor::before,.sidebarblock>.content>.title>a.anchor::before,h4>a.anchor::before,h5>a.anchor::before,h6>a.anchor::before{content:"\00A7";font-size:.85em;display:block;padding-top:.1em}
#content h1:hover>a.anchor,#content h1>a.anchor:hover,h2:hover>a.anchor,h2>a.anchor:hover,h3:hover>a.anchor,#toctitle:hover>a.anchor,.sidebarblock>.content>.title:hover>a.anchor,h3>a.anchor:hover,#toctitle>a.anchor:hover,.sidebarblock>.content>.title>a.anchor:hover,h4:hover>a.anchor,h4>a.anchor:hover,h5:hover>a.anchor,h5>a.anchor:hover,h6:hover>a.anchor,h6>a.anchor:hover{visibility:visible}
#content h1>a.link,h2>a.link,h3>a.link,#toctitle>a.link,.sidebarblock>.content>.title>a.link,h4>a.link,h5>a.link,h6>a.link{color:#ba3925;text-decoration:none}
#content h1>a.link:hover,h2>a.link:hover,h3>a.link:hover,#toctitle>a.link:hover,.sidebarblock>.content>.title>a.link:hover,h4>a.link:hover,h5>a.link:hover,h6>a.link:hover{color:#a53221}
details,.audioblock,.imageblock,.literalblock,.listingblock,.stemblock,.videoblock{margin-bottom:1.25em}
details>summary:first-of-type{cursor:pointer;display:list-item;outline:none;margin-bottom:.75em}
.admonitionblock td.content>.title,.audioblock>.title,.exampleblock>.title,.imageblock>.title,.listingblock>.title,.literalblock>.title,.stemblock>.title,.openblock>.title,.paragraph>.title,.quoteblock>.title,table.tableblock>.title,.verseblock>.title,.videoblock>.title,.dlist>.title,.olist>.title,.ulist>.title,.qlist>.title,.hdlist>.title{text-rendering:optimizeLegibility;text-align:left;font-family:"Noto Serif","DejaVu Serif",serif;font-size:1rem;font-style:italic}
table.tableblock.fit-content>caption.title{white-space:nowrap;width:0}
.paragraph.lead>p,#preamble>.sectionbody>[class="paragraph"]:first-of-type p{font-size:1.21875em;line-height:1.6;color:rgba(0,0,0,.85)}
table.tableblock #preamble>.sectionbody>[class="paragraph"]:first-of-type p{font-size:inherit}
.admonitionblock>table{border-collapse:separate;border:0;background:none;width:100%}
.admonitionblock>table td.icon{text-align:center;width:80px}
.admonitionblock>table td.icon img{max-width:none}
.admonitionblock>table td.icon .title{font-weight:bold;font-family:"Open Sans","DejaVu Sans",sans-serif;text-transform:uppercase}
.admonitionblock>table td.content{padding-left:1.125em;padding-right:1.25em;border-left:1px solid #dddddf;color:rgba(0,0,0,.6)}
.admonitionblock>table td.content>:last-child>:last-child{margin-bottom:0}
.exampleblock>.content{border-style:solid;border-width:1px;border-color:#e6e6e6;margin-bottom:1.25em;padding:1.25em;background:#fff;-webkit-border-radius:4px;border-radius:4px}
.exampleblock>.content>:first-child{margin-top:0}
.exampleblock>.content>:last-child{margin-bottom:0}
.sidebarblock{border-style:solid;border-width:1px;border-color:#dbdbd6;margin-bottom:1.25em;padding:1.25em;background:#f3f3f2;-webkit-border-radius:4px;border-radius:4px}
.sidebarblock>:first-child{margin-top:0}
.sidebarblock>:last-child{margin-bottom:0}
.sidebarblock>.content>.title{color:#7a2518;margin-top:0;text-align:center}
.exampleblock>.content>:last-child>:last-child,.exampleblock>.content .olist>ol>li:last-child>:last-child,.exampleblock>.content .ulist>ul>li:last-child>:last-child,.exampleblock>.content .qlist>ol>li:last-child>:last-child,.sidebarblock>.content>:last-child>:last-child,.sidebarblock>.content .olist>ol>li:last-child>:last-child,.sidebarblock>.content .ulist>ul>li:last-child>:last-child,.sidebarblock>.content .qlist>ol>li:last-child>:last-child{margin-bottom:0}
.literalblock pre,.listingblock>.content>pre{-webkit-border-radius:4px;border-radius:4px;word-wrap:break-word;overflow-x:auto;padding:1em;font-size:.8125em}
@media screen and (min-width:768px){.literalblock pre,.listingblock>.content>pre{font-size:.90625em}}
@media screen and (min-width:1280px){.literalblock pre,.listingblock>.content>pre{font-size:1em}}
.literalblock pre,.listingblock>.content>pre:not(.highlight),.listingblock>.content>pre[class="highlight"],.listingblock>.content>pre[class^="highlight "]{background:#f7f7f8}
.literalblock.output pre{color:#f7f7f8;background:rgba(0,0,0,.9)}
.listingblock>.content{position:relative}
.listingblock code[data-lang]::before{display:none;content:attr(data-lang);position:absolute;font-size:.75em;top:.425rem;right:.5rem;line-height:1;text-transform:uppercase;color:inherit;opacity:.5}
.listingblock:hover code[data-lang]::before{display:block}
.listingblock.terminal pre .command::before{content:attr(data-prompt);padding-right:.5em;color:inherit;opacity:.5}
.listingblock.terminal pre .command:not([data-prompt])::before{content:"$"}
.listingblock pre.highlightjs{padding:0}
.listingblock pre.highlightjs>code{padding:1em;-webkit-border-radius:4px;border-radius:4px}
.listingblock pre.prettyprint{border-width:0}
.prettyprint{background:#f7f7f8}
pre.prettyprint .linenums{line-height:1.45;margin-left:2em}
pre.prettyprint li{background:none;list-style-type:inherit;padding-left:0}
pre.prettyprint li code[data-lang]::before{opacity:1}
pre.prettyprint li:not(:first-child) code[data-lang]::before{display:none}
table.linenotable{border-collapse:separate;border:0;margin-bottom:0;background:none}
table.linenotable td[class]{color:inherit;vertical-align:top;padding:0;line-height:inherit;white-space:normal}
table.linenotable td.code{padding-left:.75em}
table.linenotable td.linenos{border-right:1px solid currentColor;opacity:.35;padding-right:.5em}
pre.pygments .lineno{border-right:1px solid currentColor;opacity:.35;display:inline-block;margin-right:.75em}
pre.pygments .lineno::before{content:"";margin-right:-.125em}
.quoteblock{margin:0 1em 1.25em 1.5em;display:table}
.quoteblock:not(.excerpt)>.title{margin-left:-1.5em;margin-bottom:.75em}
.quoteblock blockquote,.quoteblock p{color:rgba(0,0,0,.85);font-size:1.15rem;line-height:1.75;word-spacing:.1em;letter-spacing:0;font-style:italic;text-align:justify}
.quoteblock blockquote{margin:0;padding:0;border:0}
.quoteblock blockquote::before{content:"\201c";float:left;font-size:2.75em;font-weight:bold;line-height:.6em;margin-left:-.6em;color:#7a2518;text-shadow:0 1px 2px rgba(0,0,0,.1)}
.quoteblock blockquote>.paragraph:last-child p{margin-bottom:0}
.quoteblock .attribution{margin-top:.75em;margin-right:.5ex;text-align:right}
.verseblock{margin:0 1em 1.25em}
.verseblock pre{font-family:"Open Sans","DejaVu Sans",sans;font-size:1.15rem;color:rgba(0,0,0,.85);font-weight:300;text-rendering:optimizeLegibility}
.verseblock pre strong{font-weight:400}
.verseblock .attribution{margin-top:1.25rem;margin-left:.5ex}
.quoteblock .attribution,.verseblock .attribution{font-size:.9375em;line-height:1.45;font-style:italic}
.quoteblock .attribution br,.verseblock .attribution br{display:none}
.quoteblock .attribution cite,.verseblock .attribution cite{display:block;letter-spacing:-.025em;color:rgba(0,0,0,.6)}
.quoteblock.abstract blockquote::before,.quoteblock.excerpt blockquote::before,.quoteblock .quoteblock blockquote::before{display:none}
.quoteblock.abstract blockquote,.quoteblock.abstract p,.quoteblock.excerpt blockquote,.quoteblock.excerpt p,.quoteblock .quoteblock blockquote,.quoteblock .quoteblock p{line-height:1.6;word-spacing:0}
.quoteblock.abstract{margin:0 1em 1.25em;display:block}
.quoteblock.abstract>.title{margin:0 0 .375em;font-size:1.15em;text-align:center}
.quoteblock.excerpt>blockquote,.quoteblock .quoteblock{padding:0 0 .25em 1em;border-left:.25em solid #dddddf}
.quoteblock.excerpt,.quoteblock .quoteblock{margin-left:0}
.quoteblock.excerpt blockquote,.quoteblock.excerpt p,.quoteblock .quoteblock blockquote,.quoteblock .quoteblock p{color:inherit;font-size:1.0625rem}
.quoteblock.excerpt .attribution,.quoteblock .quoteblock .attribution{color:inherit;text-align:left;margin-right:0}
table.tableblock{max-width:100%;border-collapse:separate}
p.tableblock:last-child{margin-bottom:0}
td.tableblock>.content>:last-child{margin-bottom:-1.25em}
td.tableblock>.content>:last-child.sidebarblock{margin-bottom:0}
table.tableblock,th.tableblock,td.tableblock{border:0 solid #dedede}
table.grid-all>thead>tr>.tableblock,table.grid-all>tbody>tr>.tableblock{border-width:0 1px 1px 0}
table.grid-all>tfoot>tr>.tableblock{border-width:1px 1px 0 0}
table.grid-cols>*>tr>.tableblock{border-width:0 1px 0 0}
table.grid-rows>thead>tr>.tableblock,table.grid-rows>tbody>tr>.tableblock{border-width:0 0 1px}
table.grid-rows>tfoot>tr>.tableblock{border-width:1px 0 0}
table.grid-all>*>tr>.tableblock:last-child,table.grid-cols>*>tr>.tableblock:last-child{border-right-width:0}
table.grid-all>tbody>tr:last-child>.tableblock,table.grid-all>thead:last-child>tr>.tableblock,table.grid-rows>tbody>tr:last-child>.tableblock,table.grid-rows>thead:last-child>tr>.tableblock{border-bottom-width:0}
table.frame-all{border-width:1px}
table.frame-sides{border-width:0 1px}
table.frame-topbot,table.frame-ends{border-width:1px 0}
table.stripes-all tr,table.stripes-odd tr:nth-of-type(odd),table.stripes-even tr:nth-of-type(even),table.stripes-hover tr:hover{background:#f8f8f7}
th.halign-left,td.halign-left{text-align:left}
th.halign-right,td.halign-right{text-align:right}
th.halign-center,td.halign-center{text-align:center}
th.valign-top,td.valign-top{vertical-align:top}
th.valign-bottom,td.valign-bottom{vertical-align:bottom}
th.valign-middle,td.valign-middle{vertical-align:middle}
table thead th,table tfoot th{font-weight:bold}
tbody tr th{display:table-cell;line-height:1.6;background:#f7f8f7}
tbody tr th,tbody tr th p,tfoot tr th,tfoot tr th p{color:rgba(0,0,0,.8);font-weight:bold}
p.tableblock>code:only-child{background:none;padding:0}
p.tableblock{font-size:1em}
ol{margin-left:1.75em}
ul li ol{margin-left:1.5em}
dl dd{margin-left:1.125em}
dl dd:last-child,dl dd:last-child>:last-child{margin-bottom:0}
ol>li p,ul>li p,ul dd,ol dd,.olist .olist,.ulist .ulist,.ulist .olist,.olist .ulist{margin-bottom:.625em}
ul.checklist,ul.none,ol.none,ul.no-bullet,ol.no-bullet,ol.unnumbered,ul.unstyled,ol.unstyled{list-style-type:none}
ul.no-bullet,ol.no-bullet,ol.unnumbered{margin-left:.625em}
ul.unstyled,ol.unstyled{margin-left:0}
ul.checklist{margin-left:.625em}
ul.checklist li>p:first-child>.fa-square-o:first-child,ul.checklist li>p:first-child>.fa-check-square-o:first-child{width:1.25em;font-size:.8em;position:relative;bottom:.125em}
ul.checklist li>p:first-child>input[type="checkbox"]:first-child{margin-right:.25em}
ul.inline{display:-ms-flexbox;display:-webkit-box;display:flex;-ms-flex-flow:row wrap;-webkit-flex-flow:row wrap;flex-flow:row wrap;list-style:none;margin:0 0 .625em -1.25em}
ul.inline>li{margin-left:1.25em}
.unstyled dl dt{font-weight:400;font-style:normal}
ol.arabic{list-style-type:decimal}
ol.decimal{list-style-type:decimal-leading-zero}
ol.loweralpha{list-style-type:lower-alpha}
ol.upperalpha{list-style-type:upper-alpha}
ol.lowerroman{list-style-type:lower-roman}
ol.upperroman{list-style-type:upper-roman}
ol.lowergreek{list-style-type:lower-greek}
.hdlist>table,.colist>table{border:0;background:none}
.hdlist>table>tbody>tr,.colist>table>tbody>tr{background:none}
td.hdlist1,td.hdlist2{vertical-align:top;padding:0 .625em}
td.hdlist1{font-weight:bold;padding-bottom:1.25em}
.literalblock+.colist,.listingblock+.colist{margin-top:-.5em}
.colist td:not([class]):first-child{padding:.4em .75em 0;line-height:1;vertical-align:top}
.colist td:not([class]):first-child img{max-width:none}
.colist td:not([class]):last-child{padding:.25em 0}
.thumb,.th{line-height:0;display:inline-block;border:solid 4px #fff;-webkit-box-shadow:0 0 0 1px #ddd;box-shadow:0 0 0 1px #ddd}
.imageblock.left{margin:.25em .625em 1.25em 0}
.imageblock.right{margin:.25em 0 1.25em .625em}
.imageblock>.title{margin-bottom:0}
.imageblock.thumb,.imageblock.th{border-width:6px}
.imageblock.thumb>.title,.imageblock.th>.title{padding:0 .125em}
.image.left,.image.right{margin-top:.25em;margin-bottom:.25em;display:inline-block;line-height:0}
.image.left{margin-right:.625em}
.image.right{margin-left:.625em}
a.image{text-decoration:none;display:inline-block}
a.image object{pointer-events:none}
sup.footnote,sup.footnoteref{font-size:.875em;position:static;vertical-align:super}
sup.footnote a,sup.footnoteref a{text-decoration:none}
sup.footnote a:active,sup.footnoteref a:active{text-decoration:underline}
#footnotes{padding-top:.75em;padding-bottom:.75em;margin-bottom:.625em}
#footnotes hr{width:20%;min-width:6.25em;margin:-.25em 0 .75em;border-width:1px 0 0}
#footnotes .footnote{padding:0 .375em 0 .225em;line-height:1.3334;font-size:.875em;margin-left:1.2em;margin-bottom:.2em}
#footnotes .footnote a:first-of-type{font-weight:bold;text-decoration:none;margin-left:-1.05em}
#footnotes .footnote:last-of-type{margin-bottom:0}
#content #footnotes{margin-top:-.625em;margin-bottom:0;padding:.75em 0}
.gist .file-data>table{border:0;background:#fff;width:100%;margin-bottom:0}
.gist .file-data>table td.line-data{width:99%}
div.unbreakable{page-break-inside:avoid}
.big{font-size:larger}
.small{font-size:smaller}
.underline{text-decoration:underline}
.overline{text-decoration:overline}
.line-through{text-decoration:line-through}
.aqua{color:#00bfbf}
.aqua-background{background:#00fafa}
.black{color:#000}
.black-background{background:#000}
.blue{color:#0000bf}
.blue-background{background:#0000fa}
.fuchsia{color:#bf00bf}
.fuchsia-background{background:#fa00fa}
.gray{color:#606060}
.gray-background{background:#7d7d7d}
.green{color:#006000}
.green-background{background:#007d00}
.lime{color:#00bf00}
.lime-background{background:#00fa00}
.maroon{color:#600000}
.maroon-background{background:#7d0000}
.navy{color:#000060}
.navy-background{background:#00007d}
.olive{color:#606000}
.olive-background{background:#7d7d00}
.purple{color:#600060}
.purple-background{background:#7d007d}
.red{color:#bf0000}
.red-background{background:#fa0000}
.silver{color:#909090}
.silver-background{background:#bcbcbc}
.teal{color:#006060}
.teal-background{background:#007d7d}
.white{color:#bfbfbf}
.white-background{background:#fafafa}
.yellow{color:#bfbf00}
.yellow-background{background:#fafa00}
span.icon>.fa{cursor:default}
a span.icon>.fa{cursor:inherit}
.admonitionblock td.icon [class^="fa icon-"]{font-size:2.5em;text-shadow:1px 1px 2px rgba(0,0,0,.5);cursor:default}
.admonitionblock td.icon .icon-note::before{content:"\f05a";color:#19407c}
.admonitionblock td.icon .icon-tip::before{content:"\f0eb";text-shadow:1px 1px 2px rgba(155,155,0,.8);color:#111}
.admonitionblock td.icon .icon-warning::before{content:"\f071";color:#bf6900}
.admonitionblock td.icon .icon-caution::before{content:"\f06d";color:#bf3400}
.admonitionblock td.icon .icon-important::before{content:"\f06a";color:#bf0000}
.conum[data-value]{display:inline-block;color:#fff!important;background:rgba(0,0,0,.8);-webkit-border-radius:100px;border-radius:100px;text-align:center;font-size:.75em;width:1.67em;height:1.67em;line-height:1.67em;font-family:"Open Sans","DejaVu Sans",sans-serif;font-style:normal;font-weight:bold}
.conum[data-value] *{color:#fff!important}
.conum[data-value]+b{display:none}
.conum[data-value]::after{content:attr(data-value)}
pre .conum[data-value]{position:relative;top:-.125em}
b.conum *{color:inherit!important}
.conum:not([data-value]):empty{display:none}
dt,th.tableblock,td.content,div.footnote{text-rendering:optimizeLegibility}
h1,h2,p,td.content,span.alt{letter-spacing:-.01em}
p strong,td.content strong,div.footnote strong{letter-spacing:-.005em}
p,blockquote,dt,td.content,span.alt{font-size:1.0625rem}
p{margin-bottom:1.25rem}
.sidebarblock p,.sidebarblock dt,.sidebarblock td.content,p.tableblock{font-size:1em}
.exampleblock>.content{background:#fffef7;border-color:#e0e0dc;-webkit-box-shadow:0 1px 4px #e0e0dc;box-shadow:0 1px 4px #e0e0dc}
.print-only{display:none!important}
@page{margin:1.25cm .75cm}
@media print{*{-webkit-box-shadow:none!important;box-shadow:none!important;text-shadow:none!important}
html{font-size:80%}
a{color:inherit!important;text-decoration:underline!important}
a.bare,a[href^="#"],a[href^="mailto:"]{text-decoration:none!important}
a[href^="http:"]:not(.bare)::after,a[href^="https:"]:not(.bare)::after{content:"(" attr(href) ")";display:inline-block;font-size:.875em;padding-left:.25em}
abbr[title]::after{content:" (" attr(title) ")"}
pre,blockquote,tr,img,object,svg{page-break-inside:avoid}
thead{display:table-header-group}
svg{max-width:100%}
p,blockquote,dt,td.content{font-size:1em;orphans:3;widows:3}
h2,h3,#toctitle,.sidebarblock>.content>.title{page-break-after:avoid}
#toc,.sidebarblock,.exampleblock>.content{background:none!important}
#toc{border-bottom:1px solid #dddddf!important;padding-bottom:0!important}
body.book #header{text-align:center}
body.book #header>h1:first-child{border:0!important;margin:2.5em 0 1em}
body.book #header .details{border:0!important;display:block;padding:0!important}
body.book #header .details span:first-child{margin-left:0!important}
body.book #header .details br{display:block}
body.book #header .details br+span::before{content:none!important}
body.book #toc{border:0!important;text-align:left!important;padding:0!important;margin:0!important}
body.book #toc,body.book #preamble,body.book h1.sect0,body.book .sect1>h2{page-break-before:always}
.listingblock code[data-lang]::before{display:block}
#footer{padding:0 .9375em}
.hide-on-print{display:none!important}
.print-only{display:block!important}
.hide-for-print{display:none!important}
.show-for-print{display:inherit!important}}
@media print,amzn-kf8{#header>h1:first-child{margin-top:1.25rem}
.sect1{padding:0!important}
.sect1+.sect1{border:0}
#footer{background:none}
#footer-text{color:rgba(0,0,0,.6);font-size:.9em}}
@media amzn-kf8{#header,#content,#footnotes,#footer{padding:0}}
</style>
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/4.7.0/css/font-awesome.min.css">
</head>
<body class="article toc2 toc-left">
<div id="header">
<h1>MasterSim Benutzerhandbuch</h1>
<div class="details">
<span id="author" class="author">Andreas Nicolai</span><br>
<span id="email" class="email"><a href="mailto:andreas.nicolai@tu-dresden.de">andreas.nicolai@tu-dresden.de</a></span><br>
<span id="revnumber">version 0.9.0,</span>
<span id="revdate">Sep 2021</span>
</div>
<div id="toc" class="toc2">
<div id="toctitle">Inhaltsverzeichnis</div>
<ul class="sectlevel1">
<li><a href="#_einführung_und_grundbegriffe">1. Einführung und Grundbegriffe</a>
<ul class="sectlevel2">
<li><a href="#_die_teile_des_programms">1.1. Die Teile des Programms</a></li>
<li><a href="#_unterstützte_fmu_varianten">1.2. Unterstützte FMU - Varianten</a></li>
<li><a href="#_entwicklungszieleschwerpunkte_aus_entwicklersicht">1.3. Entwicklungsziele/Schwerpunkte aus Entwicklersicht</a>
<ul class="sectlevel3">
<li><a href="#_besondere_funktionen_von_mastersim">1.3.1. Besondere Funktionen von <em>MasterSim</em></a></li>
</ul>
</li>
<li><a href="#_terminologie">1.4. Terminologie</a></li>
<li><a href="#workflow">1.5. Arbeitsabläufe</a>
<ul class="sectlevel3">
<li><a href="#_ersteinrichtung_eines_simulationsszenarios">1.5.1. Ersteinrichtung eines Simulationsszenarios</a></li>
<li><a href="#_variantenanalyse_nur_veröffentlichte_fmu_parameter_sind_modifiziert">1.5.2. Variantenanalyse: Nur veröffentlichte FMU-Parameter sind modifiziert</a></li>
<li><a href="#_variantenanalyse_fmus_ändern_das_interne_verhalten_aber_nicht_die_schnittstelle">1.5.3. Variantenanalyse: FMUs ändern das interne Verhalten, aber nicht die Schnittstelle</a></li>
<li><a href="#_variantenanalyse_fmus_ändern_parameter_aber_nicht_die_ein_und_ausgangsgrößen">1.5.4. Variantenanalyse: FMUs ändern Parameter aber nicht die Ein- und Ausgangsgrößen</a></li>
<li><a href="#_variantenanalyse_fmus_ändern_die_schnittstelle">1.5.5. Variantenanalyse: FMUs ändern die Schnittstelle</a></li>
</ul>
</li>
<li><a href="#_ein_überblick_über_den_simulations_algorithmus">1.6. Ein Überblick über den Simulations-Algorithmus</a></li>
<li><a href="#_initialisierung">1.7. Initialisierung</a>
<ul class="sectlevel3">
<li><a href="#_anfangsbedingungen">1.7.1. Anfangsbedingungen</a></li>
<li><a href="#_start_und_endzeit_der_simulation">1.7.2. Start- und Endzeit der Simulation</a></li>
</ul>
</li>
<li><a href="#timestep_adjustment">1.8. Anpassung der Kommunikationsschrittlängen</a>
<ul class="sectlevel3">
<li><a href="#_zeitschritt_verringerung_wenn_der_algorithmus_nicht_konvergiert">1.8.1. Zeitschritt-Verringerung, wenn der Algorithmus nicht konvergiert</a></li>
<li><a href="#error_control_and_time_step_adjustment">1.8.2. Fehlerkontrolle und Zeitschritt-Anpassung</a></li>
</ul>
</li>
<li><a href="#master_algorithms">1.9. Master-Algorithmen</a>
<ul class="sectlevel3">
<li><a href="#_gauss_jacobi">1.9.1. Gauss-Jacobi</a></li>
<li><a href="#_gauss_seidel">1.9.2. Gauss-Seidel</a></li>
<li><a href="#_newton_verfahren">1.9.3. Newton-Verfahren</a></li>
</ul>
</li>
<li><a href="#_schreiben_von_ergebnisgrößenausgangsvariablen">1.10. Schreiben von Ergebnisgrößen/Ausgangsvariablen</a></li>
</ul>
</li>
<li><a href="#_grafische_benutzeroberfläche">2. Grafische Benutzeroberfläche</a>
<ul class="sectlevel2">
<li><a href="#_startseite">2.1. Startseite</a>
<ul class="sectlevel3">
<li><a href="#_beispiele">2.1.1. Beispiele</a></li>
</ul>
</li>
<li><a href="#_symbolleiste_und_nützliche_tastenkombinationen">2.2. Symbolleiste und nützliche Tastenkombinationen</a>
<ul class="sectlevel3">
<li><a href="#_nützliche_tastenkürzel">2.2.1. Nützliche Tastenkürzel</a></li>
</ul>
</li>
<li><a href="#slave_definition_view">2.3. Ansicht zum Definieren der FMU-Slaves</a>
<ul class="sectlevel3">
<li><a href="#_slaves_hinzufügen">2.3.1. Slaves hinzufügen</a></li>
<li><a href="#_eigenschaftenparameterwerte_der_slaves">2.3.2. Eigenschaften/Parameterwerte der Slaves</a></li>
<li><a href="#_netzwerkansicht">2.3.3. Netzwerkansicht</a></li>
<li><a href="#_block_bearbeitungsdialog">2.3.4. Block-Bearbeitungsdialog</a></li>
</ul>
</li>
<li><a href="#connection_view">2.4. Verknüpfungsansicht</a>
<ul class="sectlevel3">
<li><a href="#_die_besonderheiten_automatischer_verbindungen">2.4.1. Die Besonderheiten automatischer Verbindungen</a></li>
<li><a href="#_eine_umrechnungsoperation_zwischen_variablen_definieren">2.4.2. Eine Umrechnungsoperation zwischen Variablen definieren</a></li>
</ul>
</li>
<li><a href="#simulation_settings_view">2.5. Simulationsansicht</a></li>
<li><a href="#_einstellungs_dialog">2.6. Einstellungs-Dialog</a></li>
</ul>
</li>
<li><a href="#_mastersimulator_das_befehlszeilen_programm">3. <em>MasterSimulator</em> - Das Befehlszeilen-Programm</a>
<ul class="sectlevel2">
<li><a href="#command_line_arguments">3.1. Befehlszeilenargumente</a>
<ul class="sectlevel3">
<li><a href="#solver_working_dir">3.1.1. Anpassung des Arbeits- und Ausgabeverzeichnis</a></li>
<li><a href="#_anpassung_der_ausgabedetailstufe">3.1.2. Anpassung der Ausgabedetailstufe</a></li>
<li><a href="#_spezielle_optionen_unter_windows">3.1.3. Spezielle Optionen unter Windows</a></li>
</ul>
</li>
<li><a href="#working_directory_structure">3.2. Struktur und Inhalt des Arbeitsverzeichnis</a>
<ul class="sectlevel3">
<li><a href="#_verzeichnis_log">3.2.1. Verzeichnis <code>log</code></a></li>
<li><a href="#_verzeichnis_fmus">3.2.2. Verzeichnis <code>fmus</code></a></li>
<li><a href="#dir_slaves">3.2.3. Verzeichnis <code>Slaves</code></a></li>
</ul>
</li>
<li><a href="#_return_code_des_mastersimulator_programms">3.3. Return-Code des <em>MasterSimulator</em> -Programms</a></li>
<li><a href="#simulation_outputs">3.4. Simulationsausgaben</a>
<ul class="sectlevel3">
<li><a href="#_slave_ausgabewerte">3.4.1. Slave-Ausgabewerte</a></li>
<li><a href="#_dateiformat_der_ergebnisdateien">3.4.2. Dateiformat der Ergebnisdateien</a></li>
<li><a href="#summary_txt_file">3.4.3. Simulations-Statistik/Zusammenfassung</a></li>
</ul>
</li>
</ul>
</li>
<li><a href="#project_file_format">4. Format der Projekt-Datei</a>
<ul class="sectlevel2">
<li><a href="#simulator_settings">4.1. Einstellungen für die Simulation</a>
<ul class="sectlevel3">
<li><a href="#_fortgeschrittene_konfigurationen">4.1.1. Fortgeschrittene Konfigurationen</a></li>
</ul>
</li>
<li><a href="#slave_definition">4.2. Simulator-/Slave-Definitionen</a>
<ul class="sectlevel3">
<li><a href="#csv_filereader_slaves">4.2.1. CSV-Datei-Lese-Slaves</a></li>
<li><a href="#_zeitpunkte_und_zeiteinheiten">4.2.2. Zeitpunkte und Zeiteinheiten</a></li>
<li><a href="#_interpretation_der_von_den_datei_lese_slaves_bereitgestellten_daten">4.2.3. Interpretation der von den Datei-Lese-Slaves bereitgestellten Daten</a></li>
</ul>
</li>
<li><a href="#connection_graph">4.3. Verbindungsgraph</a>
<ul class="sectlevel3">
<li><a href="#_fmu_parameter">4.3.1. FMU-Parameter</a></li>
</ul>
</li>
<li><a href="#_blockmod_dateiformat_der_netzwerkdarstellungsdatei">4.4. BlockMod - Dateiformat der Netzwerkdarstellungsdatei</a></li>
</ul>
</li>
<li><a href="#_testreihen_und_validierung">5. Testreihen und Validierung</a>
<ul class="sectlevel2">
<li><a href="#_regressionstests">5.1. Regressionstests</a>
<ul class="sectlevel3">
<li><a href="#_verzeichnisstruktur">5.1.1. Verzeichnisstruktur</a></li>
<li><a href="#_durchlauf_der_tests">5.1.2. Durchlauf der Tests</a></li>
<li><a href="#_aktualisierung_der_referenzergebnisse">5.1.3. Aktualisierung der Referenzergebnisse</a></li>
</ul>
</li>
<li><a href="#_regeln_für_quervergleiche_und_die_fmi_standard_org_übersicht">5.2. Regeln für Quervergleiche und die FMI Standard.org Übersicht</a></li>
<li><a href="#_verschieden_möglichkeiten_test_fmus_zu_erstellen">5.3. Verschieden Möglichkeiten, Test-FMUs zu erstellen</a>
<ul class="sectlevel3">
<li><a href="#_native_c_fmus">5.3.1. Native C++ FMUs</a></li>
<li><a href="#_modelica_basierte_fmus">5.3.2. Modelica-basierte FMUs</a></li>
<li><a href="#_erstellen_einer_fmu_mit_openmodelica">5.3.3. Erstellen einer FMU mit OpenModelica</a></li>
</ul>
</li>
</ul>
</li>
<li><a href="#fmu_dev_helpers">6. Assistenzfunktionen für FMU-Entwicklung und Fehlerbeseitigung</a>
<ul class="sectlevel2">
<li><a href="#skip_FMU_extraction">6.1. Einfache Veränderung/Reparatur von fehlerhaften FMUs</a></li>
</ul>
</li>
<li><a href="#_informationen_für_entwickler">7. Informationen für Entwickler</a>
<ul class="sectlevel2">
<li><a href="#_erstellen_von_bibliotheken_und_ausführbaren_programmen">7.1. Erstellen von Bibliotheken und ausführbaren Programmen</a>
<ul class="sectlevel3">
<li><a href="#_erstellen_mit_die_befehlszeile">7.1.1. Erstellen mit die Befehlszeile</a></li>
<li><a href="#_bibliotheken">7.1.2. Bibliotheken</a></li>
</ul>
</li>
<li><a href="#_entwicklungsumgebungen_und_projekt_sitzungsdateien">7.2. Entwicklungsumgebungen und Projekt-/Sitzungsdateien</a>
<ul class="sectlevel3">
<li><a href="#_qt_creator">7.2.1. Qt Creator</a></li>
<li><a href="#_visual_studio">7.2.2. Visual Studio</a></li>
</ul>
</li>
<li><a href="#_weitere_entwickler_informationen">7.3. Weitere Entwickler-Informationen</a></li>
</ul>
</li>
</ul>
</div>
</div>
<div id="content">
<div id="preamble">
<div class="sectionbody">
<div class="paragraph">
<p>Dieses Handbuch ist verfügbar als:</p>
</div>
<div class="ulist">
<ul>
<li>
<p><a href="https://bauklimatik-dresden.de/mastersim/help/MasterSim_manual_de.pdf">PDF Version (Deutsch)</a></p>
</li>
<li>
<p><a href="https://bauklimatik-dresden.de/mastersim/help/MasterSim_manual_en.pdf">PDF Version (Englisch)</a></p>
</li>
<li>
<p><a href="https://bauklimatik-dresden.de/mastersim/help/MasterSim_manual_de.html">Online Handbuch (Deutsch)</a></p>
</li>
<li>
<p><a href="https://bauklimatik-dresden.de/mastersim/help/MasterSim_manual_en.html">Online Handbuch (Englisch)</a></p>
</li>
</ul>
</div>
<div class="paragraph">
<p>Das Programm ist verfügbar unter: <a href="https://bauklimatik-dresden.de/mastersim" class="bare">https://bauklimatik-dresden.de/mastersim</a></p>
</div>
</div>
</div>
<div class="sect1">
<h2 id="_einführung_und_grundbegriffe">1. Einführung und Grundbegriffe</h2>
<div class="sectionbody">
<div class="paragraph">
<p><em>MasterSim</em> ist ein Co-Simulations-Masterprogramm, welches die FMI-Co-Simulation unterstützt. Wenn die Co-Simulation für Sie etwas gänzlich Neues ist oder Sie mit dem funktionalen Mock-Up-Interface (FMI) noch nicht vertraut sind, empfehle ich Ihnen, zunächst ein wenig über die Grundlagen zu lesen, z. B. auf der <a href="https://fmi-standard.org">fmi-standard.org</a>-Web-Seite.</p>
</div>
<div class="paragraph">
<p>Grundsätzlich verbindet <em>MasterSim</em> verschiedene Simulationsmodelle und tauscht Daten zwischen Simulation-Slaves zur <em>Laufzeit</em> aus. Die folgende Grafik illustriert die einzelnen Komponenten des Programms und den Datenaustausch zwischen diesen.</p>
</div>
<div class="imageblock">
<div class="content">
<img src="../images/DataFlowDiagram.png" alt="Datenaustausch zwischen Programmkomponenten">
</div>
<div class="title">Abbildung 1. Diagramm über den Datenfluss (Dateien) und beteiligten Programme</div>
</div>
<div class="sect2">
<h3 id="_die_teile_des_programms">1.1. Die Teile des Programms</h3>
<div class="paragraph">
<p><em>MasterSim</em> besteht aus zwei Teilen:</p>
</div>
<div class="olist loweralpha">
<ol class="loweralpha">
<li>
<p>einer grafischen Benutzeroberfläche (<em>graphical user interface</em> - GUI) und</p>
</li>
<li>
<p>dem Simulationsprogramm <em>MasterSimulator</em> für die Befehlszeile</p>
</li>
</ol>
</div>
<div class="paragraph">
<p>Die Oberfläche macht es sehr einfach, Simulations-Projekte zu erzeugen, anzupassen und abzuändern. Ein Simulations-Projekt wird in zwei Dateien gespeichert, dem <em>MasterSim</em>-Projekt und der grafischen Darstellung (Verknüpfungsschematik). Letzteres ist optional und nicht notwendig für die Simulation.</p>
</div>
<div class="paragraph">
<p>Die Simulation wird durch das Befehlszeilen-Programm  <em>MasterSimulator</em> ausgeführt, welches Projekt-Dateien liest, referenzierte FMUs importiert und die Simulation durchführt. Die erzeugten Ergebnisse, sowohl von <em>MasterSimulator</em> selbst als auch diejenigen der Slaves werden dann von weiterverarbeitenden Werkzeugen genutzt, um die Ergebnisse zu visualisieren und zu analysieren (das kostenfreie Analysetool mit <a href="https://bauklimatik-dresden.de/postproc">PostProc 2</a> ist dafür sehr gut geeignet und meine Empfehlung für die <em>MasterSim</em> Ergebnisauswertung).</p>
</div>
<div class="paragraph">
<p>Die Trennung zwischen der Benutzeroberfläche und dem eigentlichen Simulator macht es sehr einfach, <em>MasterSim</em> in einer geskripteten Umgebung oder für eine systematische Variantenuntersuchung zu nutzen, wie sie weiter unten im Abschnitt <a href="#workflow">Arbeitsabläufe</a> beschrieben wird.</p>
</div>
</div>
<div class="sect2">
<h3 id="_unterstützte_fmu_varianten">1.2. Unterstützte FMU - Varianten</h3>
<div class="ulist">
<ul>
<li>
<p>FMI für die Co-Simulation in der Version 1</p>
</li>
<li>
<p>FMI für die Co-Simulation in der Version 2, inklusive der Unterstützung für Zustandssicherung/-Rücksetzung (Serialisierungsfunktionen)</p>
</li>
</ul>
</div>
<div class="paragraph">
<p>Es werden keine asynchronen FMU-Varianten unterstützt.</p>
</div>
<div class="paragraph">
<p><em>MasterSim</em> ist für Linux und MacOS als 64-Bit-Anwendung verfügbar. Für Windows ist  <em>MasterSim</em> sowohl als 32-Bit als auch 64-Bit-Anwendung vorhanden.</p>
</div>
<div class="admonitionblock important">
<table>
<tr>
<td class="icon">
<i class="fa icon-important" title="Important"></i>
</td>
<td class="content">
<div class="paragraph">
<p>Nutzen Sie für 32-Bit-FMUs eine 32-Bit-Version, für 64-Bit-FMUs eine mit 64 Bit. Gemischte FMU-Plattform-Typen (32 Bit und 64 Bit) werden nicht unterstützt.</p>
</div>
</td>
</tr>
</table>
</div>
</div>
<div class="sect2">
<h3 id="_entwicklungszieleschwerpunkte_aus_entwicklersicht">1.3. Entwicklungsziele/Schwerpunkte aus Entwicklersicht</h3>
<div class="ulist">
<ul>
<li>
<p>Betriebssystemübergreifend: Windows, MacOS, Linux</p>
</li>
<li>
<p>Projektdateien sind im ASCII-Format abgelegt und dadurch leicht editierbar oder durch Skripte zu modifizieren</p>
</li>
<li>
<p>da Projektdateien und Netzwerkbeschreibungsdateien ASCII-Format haben, sind sie sehr gut für die Verwendung in  Versionskontrollsystemen geeignet</p>
</li>
<li>
<p>enthält Instrumentierung und stellt Zähler und Zeitmessungen für den Leistungsvergleich von Master-Algorithmen und FMU bereit</p>
</li>
<li>
<p>keine Abhängigkeit von extern installierten Bibliotheken, alle Quelltexte sind im Repository enthalten (Ausnahme: Standard C++ Laufzeitbibliotheken und die Qt 5-Bibliothek), insbesondere gibt es keine Abhängigkeit von FMI-unterstützenden Bibliotheken; den Quelltext vom Repository zu holen und zu erstellen sollte leicht sein (ebenso das Verpacken und Veröffentlichen für andere Plattformen)</p>
</li>
<li>
<p>vollständige, in die <em>MasterSim</em>-Bibliothek eingebettete Master-Funktionalität, nutzbar über das Kommandozeilen-Werkzeug und die Oberfläche</p>
</li>
<li>
<p>Meldungen/Ausgaben sind gekapselt, um GUI-Einbindung und Log-Dateien zu unterstützen, keine direkten <code>printf()</code>- oder <code>std::cout</code> -Ausgaben</p>
</li>
<li>
<p>unterstützt FMU-Fehlerdiagnose: kann das Entpacken  deaktivieren (dauerhafte dll/so/dylib-Dateien), der Quelltextzugang erlaubt die Fehlersuche während des Ladens von gemeinsam genutzten Bibliotheken und angefügten Debuggern</p>
</li>
<li>
<p>High-Level- C++-Code (lesbar und wartungsfreundlich)</p>
</li>
<li>
<p>der Code ist angepasst für die Fehleranalyse des Master-Algorhitmus - alle Variablen sind typspezifisch für eine <em>einfache Analyse im Debugger</em> in Datenfeldern gruppiert</p>
</li>
</ul>
</div>
<div class="paragraph">
<p>Für Details über Funktionen, die insbesondere für FMU-Entwickler und bei Problemen der Fehlerbeseitigung von Co-Simulationen wichtig sind, lesen Sie bitte das Kapitel <a href="#fmu_dev_helpers">Assistenzfunktionen für FMU-Entwicklung und Fehlerbeseitigung</a>.</p>
</div>
<div class="sect3">
<h4 id="_besondere_funktionen_von_mastersim">1.3.1. Besondere Funktionen von <em>MasterSim</em></h4>
<div class="paragraph">
<p>Einige Funktionen in <em>MasterSim</em> sind (aus meiner Sicht) sehr praktisch und gibt es so in anderen Co-Simulations-Masterprogrammen nicht.</p>
</div>
<div class="paragraph">
<p>Es gibt eine besondere Funktion in <em>MasterSim</em>, welche hilfreich für die Verwendung von FMUs ist, welche  eigene Ausgabedaten schreiben. <em>MasterSim</em> erstellt für jede FMU Instanz/jeden Slave ein beschreibbares, <em>slave-spezifisches</em> Ausgabeverzeichnis. Der Pfad zu diesem Verzeichnis setzt <em>MasterSim</em> im Parameter <code>ResultsRootDir</code>. Falls ein Slave einen solchen Parameter definiert, erhält die FMU über den Parameter ein verlässliches, gültiges Verzeichnis zum Hineinschreiben seiner Daten (siehe auch Abschnitt <a href="#dir_slaves">Verzeichnis <em>Slaves</em></a>).</p>
</div>
<div class="paragraph">
<p>Zyklen bei der Definition von verknüpften Slaves können explizit definiert werden und reduzieren damit dem Aufwand für iterative Masteralgorithmen (siehe auch Abschnitt <a href="#cycles">Zyklen</a>).</p>
</div>
<div class="paragraph">
<p><em>MasterSim</em> beinhaltet eine Zeitmessung und Erfassung der Ausführungshäufigkeiten für einzelne Funktionen. Dies ist hilfreich, zeitkritische Simulationen zu optimieren oder Fehler zu finden (siehe Abschnitt <a href="#summary_txt_file">Simulations-Statistik/Zusammenfassung</a>).</p>
</div>
<div class="paragraph">
<p>Verknüpfungen zwischen Ausgangs- und Eingangsvariablen können in <em>MasterSim</em> mit Umrechnungsfaktoren und Verschiebungen definiert werden, was besonders für Einheitenumrechnungen und Flussverknüpfungen mit Vorzeichenumkehr praktisch ist (siehe Abschnitt <a href="#connection_graph">Verbindungsgraph</a>).</p>
</div>
</div>
</div>
<div class="sect2">
<h3 id="_terminologie">1.4. Terminologie</h3>
<div class="paragraph">
<p>Die folgenden Begriffe werden sowohl im Handbuch als auch in der Benennung von Klassen/Variablen genutzt:</p>
</div>
<div class="hdlist">
<table>
<tr>
<td class="hdlist1">
FMU
</td>
<td class="hdlist2">
<p>beschreibt das FMU-Archiv inklusive der Modellbeschreibung und der Laufzeit-Bibliotheken</p>
</td>
</tr>
<tr>
<td class="hdlist1">
Slave/Simulator
</td>
<td class="hdlist2">
<p>beschreibt ein Simulationsmodell, dass aus einer FMU erstellt(instanziiert) wird; dabei können mehrere Slaves durch eine einzige FMU erstellt werden, falls die Fähigkeit/Eigenschaft <strong>canBeInstantiatedOnlyOncePerProcess</strong> deaktiviert ist</p>
</td>
</tr>
<tr>
<td class="hdlist1">
Master
</td>
<td class="hdlist2">
<p>beschreibt den gesamten Rahmen der Simulationskontrolle, der die generelle Verwaltungsarbeit übernimmt</p>
</td>
</tr>
<tr>
<td class="hdlist1">
Simulationsszenario
</td>
<td class="hdlist2">
<p>definiert eine Reihe von Slaves und deren Verbindungen (Datenaustausch) ebenso wie weiteren Eigenschaften, wie z. B. Start- und Endzeit, algorithmische Optionen, Ausgabeeinstellungen; alternativ auch <strong>System</strong> genannt</p>
</td>
</tr>
<tr>
<td class="hdlist1">
Netzwerk-Graph
</td>
<td class="hdlist2">
<p>eine andere Beschreibung für die räumliche Struktur miteinander verbundener Slaves</p>
</td>
</tr>
<tr>
<td class="hdlist1">
Masteralgorithmus
</td>
<td class="hdlist2">
<p>beschreibt die Implementierung eines mathematischen Algorithmus, der die zeitliche gekoppelte Simulation beschreibt; kann ein Iterationsverfahren enthalten</p>
</td>
</tr>
<tr>
<td class="hdlist1">
Fehlerkontrolle
</td>
<td class="hdlist2">
<p>bezeichnet die Prüfung eines lokale Fehlers (Schritt-basiert), genutzt für die Anpassung des Kommunikationsschritts</p>
</td>
</tr>
<tr>
<td class="hdlist1">
Masterzeit
</td>
<td class="hdlist2">
<p>Zeitpunkt der Mastersimulation, startet mit 0; die Zeiteinheit ist nicht strikt definiert (es muss eine gemeinsame Festlegung zwischen FMUs geben, normalerweise werden Sekunden verwendet; Ausnahmen sind Datei-Lese-Slaves, siehe Abschnitt <a href="#csv_filereader_slaves">CSV-FileReader-Slaves</a>).</p>
</td>
</tr>
<tr>
<td class="hdlist1">
Gegenwärtige (Master-)Zeit
</td>
<td class="hdlist2">
<p>Zeitpunkt des aktuellen Master-Zustands; ändert sich <strong>ausschließlich</strong> am Ende eines erfolgreichen <code>doStep()</code>- oder <code>restoreState()</code>- Aufrufs.</p>
</td>
</tr>
</table>
</div>
</div>
<div class="sect2">
<h3 id="workflow">1.5. Arbeitsabläufe</h3>
<div class="paragraph">
<p>Wie bei anderen Simulationsmodellen beinhalten die meisten Arbeitsabläufe eine Variantenanlyse. Im Kontext der Co-Simulation werden solche Varianten häufig durch die Modifizierung von FMUs und ihrer Parameter erzeugt. <em>MasterSim</em> enthält Funktionen, um diesen Arbeitsprozess zu optimieren.</p>
</div>
<div class="admonitionblock tip">
<table>
<tr>
<td class="icon">
<i class="fa icon-tip" title="Tip"></i>
</td>
<td class="content">
<div class="paragraph">
<p>Viele Arbeitsabläufe beinhalten mehrfache Ausführungen von <em>MasterSim</em> mit nur kleinen oder gar keinen Modifikationen in der Projektdatei. Manchmal ist ist es sehr komfortabel, die selbe Projektdatei zu nutzen und zu verändern, aber ein anderes Arbeitsverzeichnis (für Ergebnisse) zu bestimmen, damit das Resultat verschiedener Varianten verglichen werden kann (siehe auch das <code>--working-dir</code>-Befehlszeilenargument, beschrieben in Abschnitt <a href="#solver_working_dir">Arbeits-und Ausgangsverzeichnis</a>).</p>
</div>
</td>
</tr>
</table>
</div>
<div class="paragraph">
<p>Nachfolgend sind einige typische Arbeitsabläufe/Verwendungsvarianten skizziert:</p>
</div>
<div class="sect3">
<h4 id="_ersteinrichtung_eines_simulationsszenarios">1.5.1. Ersteinrichtung eines Simulationsszenarios</h4>
<div class="paragraph">
<p>Das ist eine recht direkte Vorgehensweise:</p>
</div>
<div class="olist arabic">
<ol class="arabic">
<li>
<p>Importieren Sie alle FMUs und weisen Sie Slave-ID-Namen zu</p>
</li>
<li>
<p>(optional) Legen Sie Parametermeterwerte für die Slaves fest</p>
</li>
<li>
<p>(optional) Definieren Sie die grafische Darstellung der Slaves</p>
</li>
<li>
<p>Verbinden Sie die Ausgangs- und Eingangsgrößen</p>
</li>
<li>
<p>Legen Sie die Simulationsparameter fest</p>
</li>
<li>
<p>Führen Sie eine Simulation durch</p>
</li>
<li>
<p>Prüfen und Bewerten Sie die Ergebnisse</p>
</li>
</ol>
</div>
</div>
<div class="sect3">
<h4 id="_variantenanalyse_nur_veröffentlichte_fmu_parameter_sind_modifiziert">1.5.2. Variantenanalyse: Nur veröffentlichte FMU-Parameter sind modifiziert</h4>
<div class="paragraph">
<p>Dies ist ein sehr einfacher Fall und, wenn von FMUs unterstützt, durchaus eine praktikable Methode. In <em>MasterSim</em> müssen nur die den veröffentlichten Parametern zugewiesenen Werte geändert werden (dies kann auch direkt in der Projekt-Datei getan werden, z. B. auch mit Skripten) und die Simulation kann wiederholt werden.</p>
</div>
</div>
<div class="sect3">
<h4 id="_variantenanalyse_fmus_ändern_das_interne_verhalten_aber_nicht_die_schnittstelle">1.5.3. Variantenanalyse: FMUs ändern das interne Verhalten, aber nicht die Schnittstelle</h4>
<div class="paragraph">
<p>Dies ist einer der häufigsten Fälle. Hier bleiben die Namen der Eingangs- und Ausgangsgrößen unverändert (d.h. die FMU-Schnittstelle bleibt unverändert). Auch die publizierten Parameter bleiben gleich. Jedoch ändert sich das interne Verhalten aufgrund der Anpassung des internen Modellverhaltens, wonach die FMU nochmals exportiert wurde. Da <em>MasterSim</em> selbst die FMU-Archive nur über einen Dateipfad referenziert, können FMU-Dateien in solchen Fällen einfach ersetzt und der Simulator ohne weitere Anpassungen gestartet werden.</p>
</div>
</div>
<div class="sect3">
<h4 id="_variantenanalyse_fmus_ändern_parameter_aber_nicht_die_ein_und_ausgangsgrößen">1.5.4. Variantenanalyse: FMUs ändern Parameter aber nicht die Ein- und Ausgangsgrößen</h4>
<div class="paragraph">
<p>In dieser Situation, in der ein Parameter in <em>MasterSim</em> konfiguriert worden ist, der nicht länger existiert (oder dessen Name geändert wurde), muss die entsprechende Definition in der Projekt-Datei geändert oder von der Benutzeroberfläche entfernt werden.</p>
</div>
</div>
<div class="sect3">
<h4 id="_variantenanalyse_fmus_ändern_die_schnittstelle">1.5.5. Variantenanalyse: FMUs ändern die Schnittstelle</h4>
<div class="paragraph">
<p>Wenn eine importierte FMU einen Teil ihrer Schnittstelle ändert (z. B.  Ein- oder Ausgangsgrößen wurden modifiziert), dann wird dies in der Benutzeroberfläche durch Hervorhebung der falschen/nun fehlenden Verbindungen angezeigt.  Wenn nur Variablennamen verändert wurden, editieren Sie am besten die Projekt-Datei und benennen dort die Größenbezeichnung um. Ansonsten sollte man einfach die Verbindung entfernen und eine neue erzeugen.</p>
</div>
<div class="paragraph">
<p>Wenn sich der Variablentyp einer Eingangs-/Ausgangsgröße ändert, sodass eine ungültige Verbindung entsteht (oder die Kausalität geändert wird), dann zeigt die Benutzeroberfläche die ungültige Verbindung nicht unbedingt direkt an. Allerdings wird das Befehlszeilenprogramm des  <em>MasterSimulator</em> den Fehler während der Initialisierung anzeigen und abbrechen. Auch hier ist empfehlenswert, die fehlerhafte Verbindung zu löschen und neu zu erstellen.</p>
</div>
</div>
</div>
<div class="sect2">
<h3 id="_ein_überblick_über_den_simulations_algorithmus">1.6. Ein Überblick über den Simulations-Algorithmus</h3>
<div class="paragraph">
<p><em>MasterSim</em> hat folgende zentrale Bausteine:</p>
</div>
<div class="ulist">
<ul>
<li>
<p>Initialisierung (Lesen der Projekt-Datei, Extraktion von FMUs, Überprüfung &#8230;&#8203;)</p>
</li>
<li>
<p>Anfangsbedingungen</p>
</li>
<li>
<p>Korrekturschleife während der Laufzeit</p>
</li>
<li>
<p>Master-Algorithmus (d.h. er versucht Schritte durchzuführen)</p>
</li>
<li>
<p>Fehleranalyse</p>
</li>
<li>
<p>Ausgaben zu angeforderten Zeitpunkten schreiben</p>
</li>
</ul>
</div>
<div class="paragraph">
<p>Diese Bausteine werden nachfolgend näher erläutert.</p>
</div>
</div>
<div class="sect2">
<h3 id="_initialisierung">1.7. Initialisierung</h3>
<div class="paragraph">
<p>Zu Beginn der aktuellen Simulation (das Befehlszeilenprogramm <em>MasterSimulator</em>, siehe Abschnitt <a href="#command_line_arguments">Befehlszeilen-Argumente </a> zu Details zum Simulationsstart) wird die Struktur des Arbeitsverzeichnisses erzeugt und das Schreiben der Log-Datei gestartet.</p>
</div>
<div class="paragraph">
<p>Danach wird die Projekt-Datei gelesen und alle referenzierten FMUs werden entpackt. Wenn Verweise auf CSV-Dateien auftauchen (siehe Abschnitt <a href="#csv_filereader_slaves">CSV-FileReader-Slaves</a>), werden diese Dateien eingelesen und für die Berechnung ausgewertet/vorbereitet.</p>
</div>
<div class="admonitionblock tip">
<table>
<tr>
<td class="icon">
<i class="fa icon-tip" title="Tip"></i>
</td>
<td class="content">
<div class="paragraph">
<p>Das Entpacken der FMU-Archive kann mit der Befehlszeilen-Option <code>--skip-unzip</code> übersprungen werden (siehe Abschnitt <a href="#skip_FMU_extraction">Modifikation/Fixierung des FMU-Inhalts</a>).</p>
</div>
</td>
</tr>
</table>
</div>
<div class="paragraph">
<p>Als erster Schritt der aktuellen Co-Sim-Initialisierung werden alle FMU-Slaves erzeugt (dynamische Bibliotheken werden geladen und Symbole importiert, danach wird <code>fmiInstantiateSlave()</code> oder <code>fmi2Instantiate()</code> aufgerufen (entsprechend für FMI 1.0 bzw. FMI 2.0-Slaves). Es folgt eine Zusammenstellung aller Austauschvariablen und das Erstellen einer Variablenzuordnung.</p>
</div>
<div class="paragraph">
<p>Treten Fehler während der Initialisierung auf, führt dies zu einem Abbruch des Simulators mit einer entsprechenden Fehlermeldung.</p>
</div>
<div class="sect3">
<h4 id="_anfangsbedingungen">1.7.1. Anfangsbedingungen</h4>
<div class="paragraph">
<p>Die erste Aufgabe des Simulators ist es, für alle Slaves konsistente Anfangswerte zu erhalten. Das ist bereits eine nicht-triviale Aufgabe und nicht in allen Fällen überhaupt möglich. Die einzige Prozedur, die sowohl für FMI 1 und FMI 2-Slaves zum Einsatz kommen kann, ist das  schrittweise Lesen und Setzen von Eingangs- und Ausgangsgrößen in allen Slaves. Dieses wird wiederholt, bis keine Änderungen mehr beobachtet werden.</p>
</div>
<div class="paragraph">
<p>Der Algorithmus in <em>MasterSim</em> ist:</p>
</div>
<div class="listingblock">
<div class="content">
<pre>Schleife über alle Slaves:
  - setupExperiment() für den aktuellen Slave aufrufen
  - setzen aller Variablen der Kausalitäten INPUT oder PARAMETER auf ihre Standardwerte, wie sie in der modelDescription.xml gegeben sind
  - setzen aller Parameter auf die in der Projektdatei angegebenen Werte (falls Werte zugewiesen wurden)

nur für FMI 2: in allen Slaves enterInitializationMode() aufrufen

Schreife mit max. 3 Wiederholungen:
  Schleife über alle Slaves:
    alle Ausgangsvariablen des aktuellen Slave abfragen und in der globalen Variablenzuordnung speichern
  Schleife über alle Slaves:
    setzen aller Eingangsvariablen auf Werte der globalen Variablenzuordnung

nur für FMI 2: in allen Slaves exitInitializationMode() aufrufen</pre>
</div>
</div>
<div class="paragraph">
<p>Der Berechnungsalgorithmus für die Anfangsbedingungen ist derzeit ein Gauss-Jacobi-Algorithmus und als solcher nicht übermäßig stabil oder effizient.</p>
</div>
<div class="admonitionblock caution">
<table>
<tr>
<td class="icon">
<i class="fa icon-caution" title="Achtung"></i>
</td>
<td class="content">
<div class="paragraph">
<p>Wenn Sie mehr als 3 Slaves in einer Sequenz mit direktem Durchgang von Ein- zu Ausgangsvariablen verbunden haben, z. B. wenn die Ausgangsvariablen mit den Eingangsvariablen via algebraischer Verbindungen verknüpft sind, werden die 3 Wiederholungen des Gauss-Jacobi-Algorithmus eventuell nicht genügen, um alle Slaves korrekt zu initialisieren.</p>
</div>
<div class="paragraph">
<p>Durch eine Uneindeutigkeit im aktuellen FMI-Standard wird von Co-Simulations-Slaves nicht gefordert, die Ergebnisvariablen immer dann zu aktualisieren, wenn sich Eingangsvariablen ändern. Die meisten FMUs aktualisieren ihre Ausgangswerte tatsächlich erst nach der Aufforderung <code>doStep()</code>. Daher ist es mit dem gegenwärtigen Standard nicht möglich, zwischen den direkten mathematischen Beziehungen von Aus- und Eingängen zu unterscheiden. Dies heißt eine Änderung der Ergebnisvariablen <strong>ohne Aufruf</strong> von <code>doStep()</code> und <strong>nach einem Aufruf</strong> von <code>doStep()</code>.</p>
</div>
<div class="paragraph">
<p><em>MasterSim</em> wählt hier die Funktionalität von FMI 1.0, d.h. keine Schleifen innerhalb einer Iteration nur um Ein- und Ausgänge zu synchronisieren. Dies erfolgt unter der Annahme, dass die Ausgangsgrößen sich nicht direkt ändern, sobald neue Eingangsvariablen gesetzt wurden (dies gilt für die meisten FMUs). Unter dieser Bedingung sind 3 Wiederholungen immer ausreichend.</p>
</div>
</td>
</tr>
</table>
</div>
</div>
<div class="sect3">
<h4 id="_start_und_endzeit_der_simulation">1.7.2. Start- und Endzeit der Simulation</h4>
<div class="paragraph">
<p><em>MasterSim</em> behandelt die Simulationszeit in der Programmoberfläche als gegeben in <em>Sekunden</em>.</p>
</div>
<div class="admonitionblock tip">
<table>
<tr>
<td class="icon">
<i class="fa icon-tip" title="Tip"></i>
</td>
<td class="content">
<div class="paragraph">
<p>Wenn die gekoppelten FMUs eine unterschiedliche Zeiteinheit verwenden (d. h. Jahre), benutzen Sie einfach Sekunden auf der Benutzeroberfläche und der Projektdatei und interpretieren die Werte als Jahre.</p>
</div>
</td>
</tr>
</table>
</div>
<div class="paragraph">
<p>Die Simulationszeit wird in der Benutzeroberfläche und der Projektdatei in Sekunden eingetragen (oder irgend einer anderen unterstützten Einheit, die in Sekunden umgewandelt werden kann). Während der Simulation werden alle erfassten Zeiten (Start- und Endzeit und die Zeitstufengrößen und Größenbegrenzung) zuerst in Sekunden umgewandelt und danach ohne irgend eine weitere Einheitenumrechnung benutzt.</p>
</div>
<div class="paragraph">
<p>Beispiel: Wenn Sie einen Endzeitpunkt auf <code>1 h</code> festlegen, wird der Master bis zur Simulationszeit <code>3600</code> (s) laufen, welche dann als <em>Endzeitpunkt des Kommunikationsintervals</em> im letzten <code>doStep()</code>-Aufruf gesendet wird.</p>
</div>
<div class="paragraph">
<p>Das gesamte Simulationszeit-Intervall wird an die Slaves im <code>setupExperiment()</code>-Aufruf weitergegeben. Wenn Sie die Startzeit anders als mit 0 festlegen, wird der Master-Simulator sein erstes Kommunikationsintervall zu diesem Zeitpunkt starten (der Slave braucht dies, um den <code>setupExperiment()</code>-Aufruf korrekt zu verarbeiten und den Slave zum Startzeitpunkt zu initialisieren).</p>
</div>
<div class="admonitionblock warning">
<table>
<tr>
<td class="icon">
<i class="fa icon-warning" title="Warning"></i>
</td>
<td class="content">
<div class="paragraph">
<p>Der korrekte Umgang mit der Startzeit ist wichtig für alle FMUs, die eine Form der Bilanzierung oder Integration durchführen.</p>
</div>
</td>
</tr>
</table>
</div>
<div class="paragraph">
<p>Die Endzeit der Simulation wird zur FMU auch per <code>setupExperiment()</code>-Aufruf übermittelt (das Argument <code>stopTimeDefined</code> ist durch <em>MasterSim</em> immer auf <code>fmiTrue</code> gesetzt).</p>
</div>
</div>
</div>
<div class="sect2">
<h3 id="timestep_adjustment">1.8. Anpassung der Kommunikationsschrittlängen</h3>
<div class="paragraph">
<p>Sobald das Kommunikationsintervall abgeschlossen ist, geht der Simulator in die Zeitschrittsanpassungsschleife über. Wenn die Anpassung der Zeitschritte über die Eigenschaft <strong>adjustStepSize</strong> deaktiviert ist (siehe Abschnitt <a href="#simulator_settings">Einstellungen für die Simulation</a>), wird der Schleifeninhalt nur einmal ausgeführt. Für FMI 1.0 Slaves oder FMI 2.0 Slaves ohne die Fähigkeit zur Speicherung/Wiederherstellung des Slave-Status ist eine Wiederholung eines Schritts ebenfalls nicht möglich (tatsächlich löst das Abfragen eines Wiederholungs-Algorithmus für solche Slaves einen Fehler während der Initialisierung aus).</p>
</div>
<div id="fig_timestep_adjustment" class="imageblock">
<div class="content">
<img src="../images/timestep_adjustment.png" alt="timestep adjustment">
</div>
<div class="title">Abbildung 2. Simulationsbeispiel bei dem sowohl Fehlerschätzerüberschreitungen als auch Konvergenzfehler eine drastische Veränderung des Kommunikationszeitschritts bedingen</div>
</div>
<div class="paragraph">
<p>Innerhalb der Schleife versucht der ausgewählte <em>Master-Algorithmus</em> einen einzelnen Schritt mit der gegenwärtig vorgeschlagenen Zeitschrittgröße zu machen (für eine Methode mit konstanter Schrittweiter wird der <strong>hStart</strong>-Parameter genutzt). Dabei kann der <em>Master-Algorithmus</em> möglicherweise eine iterative Auswertung der Slaves beinhalten (siehe unten).</p>
</div>
<div class="paragraph">
<p>Für einen sich wiederholenden Master-Algorithmus ist es dabei möglich, dass die Methode nicht innerhalb der gegebenen Grenzen konvergiert (siehe Parameter <strong>maxIterations</strong> in Abschnitt <a href="#simulator_settings">Einstellungen für die Simulation</a>).</p>
</div>
<div class="sect3">
<h4 id="_zeitschritt_verringerung_wenn_der_algorithmus_nicht_konvergiert">1.8.1. Zeitschritt-Verringerung, wenn der Algorithmus nicht konvergiert</h4>
<div class="paragraph">
<p>Wenn der Algorithmus nicht innerhalb des vorgegebenen Wiederholungslimits konvergiert, wird die Kommunikationsschrittlänge um den Faktor 5 reduziert:</p>
</div>
<div class="literalblock">
<div class="content">
<pre>h_new = h/5</pre>
</div>
</div>
<div class="paragraph">
<p>Der Faktor 5 ist so ausgewählt, dass die Zeitschrittgröße schnell reduziert werden kann. Falls zum Beispiel eine Unstetigkeit auftritt, z. B. ausgelöst durch eine stufenweise Änderung diskreter Signale, muss der Simulator die Zeitschritte schnell auf einen niedrigen Wert reduzieren, um die Unstetigkeit zu passieren.</p>
</div>
<div class="paragraph">
<p>Die Schrittgröße wird dann mit der unteren Schrittlängengrenze verglichen  (Parameter <strong>hMin</strong>). Dies ist notwendig, um zu verhindern, dass die Simulation in extrem langsamen Zeitschritten stecken bleibt. Falls der Fehlerkontrollalgorithmus die Schrittgröße unter den Wert von <strong>hMin</strong> reduziert würde, <strong>wird die Simulation abgebrochen</strong>.</p>
</div>
<div class="paragraph">
<p>In manchen Fällen kann die Interaktion zwischen zwei Slaves das Konvergieren jedweder Master-Algorithmen verhindern (sogar beim Newton-Algorithmus). Dennoch kann in diesen Fällen der verbleibende Fehler unerheblich sein und die Simulation kann in winzigen Schritten langsam über die problematische Zeit hinweggehen und danach die Schritte wieder vergrößern. In diesen Fällen können Sie den Parameter <strong>hFallBackLimit</strong> festlegen, welcher größer sein muss als <strong>hMin</strong>. Wird  <code>h</code> auf einen Wert unter diese <em>zulässige</em> Kommunikationsschrittlänge reduziert, wird der Master-Algorithmus nach Durchlaufen alle Iterationen den Schritt als erfolgreich akzeptieren. Der Schritt wird dadurch als <em>sich angenähert</em> behandelt und die Simulation geht zum nächsten Intervall weiter.</p>
</div>
<div class="paragraph">
<p>Die Publikation</p>
</div>
<div class="paragraph">
<p>Nicolai, A.: <em>Co-Simulations-Masteralgorithmen - Analyse und Details der Implementierung am Beispiel des Masterprogramms MASTERSIM</em>, <a href="http://nbn-resolving.de/urn:nbn:de:bsz:14-qucosa2-319735" class="bare">http://nbn-resolving.de/urn:nbn:de:bsz:14-qucosa2-319735</a></p>
</div>
<div class="paragraph">
<p>illustriert das Verhalten der Simulation beim Benutzen dieser Parameter.</p>
</div>
</div>
<div class="sect3">
<h4 id="error_control_and_time_step_adjustment">1.8.2. Fehlerkontrolle und Zeitschritt-Anpassung</h4>
<div class="paragraph">
<p>Wenn eine Fehlertestmethode (<strong>ErrorControlMode</strong>) festgelegt ist, folgt nach einem  konvergiertem Schritt eine lokale Fehlerschätzung. Derzeit basiert diese Fehlerprüfung auf der Schritt-Verdopplungs-Technik und kann als solche nur eingesetzt werden, wenn die Slaves die FMI 2.0 Funktionalität zum Speichern/-Rücksetzen des Zustands unterstützen.</p>
</div>
<div class="paragraph">
<p>Grundsätzlich läuft der Test folgendermaßen ab:</p>
</div>
<div class="listingblock">
<div class="content">
<pre>- der Slave-Zustand wird zurückgesetzt, um das aktuelle Kommunikationsintervall zu starten
- es werden zwei Schritte (jeweils mit einem kompletten Master-Algorithmus pro Schritt) nacheinander durchgeführt
- die Fehlerkriterien 1 und 2 werden ausgewertet
- der Zustand der Slaves wird auf den Zustand nach dem ursprünglichen Master-Algorithmus zurückgesetzt</pre>
</div>
</div>
<div class="admonitionblock note">
<table>
<tr>
<td class="icon">
<i class="fa icon-note" title="Note"></i>
</td>
<td class="content">
<div class="paragraph">
<p>Der Fehlertest benötigt demnach zwei weitere Durchgänge des <em>Master-Algorithmus</em> pro Kommunikationsschritt. Für wiederholende Master-Algorithmen oder den Newton-Algorithmus kann dadurch der zusätzliche Aufwand für den Fehlertest erheblich sein.</p>
</div>
</td>
</tr>
</table>
</div>
<div class="paragraph">
<p>Die mathematischen Formeln und detaillierte Beschreibungen der Fehlertests sind in der folgenden Publikation dokumentiert:</p>
</div>
<div class="paragraph">
<p>Nicolai, A.: <em>Co-Simulation-Test Case: Predator-Prey (Lotka-Volterra) System</em> (siehe <a href="https://bauklimatik-dresden.de/mastersim/documentation.php">MasterSim Dokumentations-Webpage</a>).</p>
</div>
<div class="paragraph">
<p>Die Fehlersuche nutzt die Parameter <code>relTol</code> und <code>absTol</code> um die akzeptable Differenz zwischen Voll- und Halbschritt einzugrenzen (oder deren Anstiege). Abhängig von der lokalen Fehlerschätzung existieren zwei Optionen:</p>
</div>
<div class="ulist">
<ul>
<li>
<p>die lokale Fehlerschätzung ist klein genug und der Zeitschritt wird vergrößert, oder</p>
</li>
<li>
<p>die Fehlersuche scheitert; die Schrittgröße wird entfernt und der gesamte Kommunikationsschritt wird wiederholt.</p>
</li>
</ul>
</div>
<div class="admonitionblock tip">
<table>
<tr>
<td class="icon">
<i class="fa icon-tip" title="Tip"></i>
</td>
<td class="content">
<div class="paragraph">
<p>Wenn Sie einen Fehlersuche-Algorithmus in <em>MasterSim</em> benutzen, sollten Sie ein Rückfall-Zeitschrittlimit setzen (<strong>hFallBackLimit</strong>). Andernfalls könnte <em>MasterSim</em> versuchen, die eventuell große Dynamik der Veränderungen von Variablen von Schritt zu Schritt dadurch zu verfolgen, dass die Zeitschritte auf extrem niedrige Werte reduziert werden (und damit die  Simulation sehr langsam wird).</p>
</div>
</td>
</tr>
</table>
</div>
</div>
</div>
<div class="sect2">
<h3 id="master_algorithms">1.9. Master-Algorithmen</h3>
<div class="paragraph">
<p>Ein <em>Master-Algorithmus</em> bezeichnet grundsätzlich die mathematische Prozedur, um die gekoppelte Simulation einen Schritt voran zu bringen. Solch ein Co-Simulations-Master-Algorithmus verfügt über einen charakteristischen Satz an Regeln, wie Werte von einer FMU abgerufen werden, wann und wie diese Werte an andere FMUs übergeben werden und die Kriterien für das Konvergieren von Iterationsverfahren.</p>
</div>
<div class="paragraph">
<p><em>MasterSim</em> enthält mehrere Standard-Algorithmen. Eine detaillierte Diskussion der  unterschiedlichen Algorithmen und wie die Wahl von Algorithmen und Parametern Ergebnisse beeinflusst, kann in der folgenden Publikation nachgelesen werden:</p>
</div>
<div class="paragraph">
<p>Nicolai, A.: <em>Co-Simulations-Masteralgorithmen - Analyse und Details der Implementierung am Beispiel des Masterprogramms MASTERSIM</em>, <a href="http://nbn-resolving.de/urn:nbn:de:bsz:14-qucosa2-319735" class="bare">http://nbn-resolving.de/urn:nbn:de:bsz:14-qucosa2-319735</a></p>
</div>
<div class="sect3">
<h4 id="_gauss_jacobi">1.9.1. Gauss-Jacobi</h4>
<div class="paragraph">
<p>Basis-Algorithmus:</p>
</div>
<div class="listingblock">
<div class="content">
<pre>Schleife über alle Slaves:
  Holen aller Ausgangswerte

Schleife über alle Slaves:
  setzen aller Eingangswerte
  den Slave einen Schritt durchführen lassen (`doStep()`)</pre>
</div>
</div>
<div class="paragraph">
<p>Gauss-Jacobi wird stets ohne Iteration ausgeführt. Wie in der Publikation gezeigt (siehe oben), ergibt es wirklich keinen Sinn, eine Iteration zu nutzen.</p>
</div>
<div class="admonitionblock tip">
<table>
<tr>
<td class="icon">
<i class="fa icon-tip" title="Tip"></i>
</td>
<td class="content">
<div class="paragraph">
<p>Anstatt einen Schritt zur Datenübertragung für 10 Sekunden zu nutzen und Gauss-Jacobi mit 2 Iterationen zu nutzen, ist es effizienter die Iterationen zu deaktivieren (festlegen von <strong>maxIterations=1</strong>) und die Größe der Datenübertragungsschritte auf 5 Sekunden zu begrenzen. Der Aufwand für die Simultion ist exakt der Gleiche (2 FMU-Auswertungen je 10 Sekunden Laufzeit), jedoch läuft die Simulation mit dem 5-sekündigem Kommunikationsintervall genauer ab (und stabiler).</p>
</div>
</td>
</tr>
</table>
</div>
</div>
<div class="sect3">
<h4 id="_gauss_seidel">1.9.2. Gauss-Seidel</h4>
<div class="paragraph">
<p>Basis-Algorithmus:</p>
</div>
<div class="listingblock">
<div class="content">
<pre>Iterationsschleife:
  Schleife über alle Slaves:
    setzen aller Eingangswerte aus globaler Variablenzuordnungsliste
    den Slave einen Schritt durchführen lassen (`doStep()`)
    Ergebnisgrößen vom Slave abrufen
    globale Variablenzuordnungsliste aktualisieren
  Konvergenztest durchführen</pre>
</div>
</div>
<div class="paragraph">
<p>Durch die Aktualisierung der Variablenliste nach jedem Slave erhalten die nachfolgenden Slaves bereits aktualisierte Größen für den Kommunikationsschritt, welches das Gauss-Seidel-Verfahren auszeichnet.</p>
</div>
<div class="sect4">
<h5 id="cycles">Zyklen</h5>
<div class="paragraph">
<p><em>MasterSim</em> enthält eine Funktion zur Reduktion des Rechenaufwands, wenn viele FMUs involviert sind und nicht alle direkt miteinander verbunden sind. Abb. <a href="#fig_cycles">Abbildung 3</a> zeigt ein Simulationsszenario, in dem die Berechnung in drei Stufen ausgeführt werden kann.</p>
</div>
<div id="fig_cycles" class="imageblock">
<div class="content">
<img src="../images/algorithm_cycles.png" alt="Cycles in iterative algorithms">
</div>
<div class="title">Abbildung 3. Zyklen in sich wiederholenden Algorithmen</div>
</div>
<div class="hdlist">
<table>
<tr>
<td class="hdlist1">
(1)
</td>
<td class="hdlist2">
<p>Diese FMU erzeugt nur Ergebnisse und wird als Erstes und nur ein einziges Mal im Gauss-Seidel-Algorithmus ausgewertet werden</p>
</td>
</tr>
<tr>
<td class="hdlist1">
(2)
</td>
<td class="hdlist2">
<p>Diese zwei FMUs tauschen Werte aus, sie sind in einem <em>Zyklus</em> verbunden. Wenn der Gauss-Seidel-Algorithmus mit aktivierter Iteration ausgeführt wird, brauchen nur diese beiden FMUs aktualisiert werden und Werte austauschen, denn sie erfordern keine weiteren Ergebnisgrößen der anderen FMUs (abgesehen von der ersten FMU, deren Ausgangsvariablen bereits bekannt sind)</p>
</td>
</tr>
<tr>
<td class="hdlist1">
(3)
</td>
<td class="hdlist2">
<p>Die letzten beiden FMUs sind auch in einem Zyklus gekoppelt, aber wiederum nur miteinander. Sie werden in der letzten Phase ausgewertet. Da die Ergebnisse der anderen drei FMUs bereits berechnet wurden und bekannt sind, müssen wieder nur zwei FMUs im Zyklus ausiteriert werden.</p>
</td>
</tr>
</table>
</div>
<div class="paragraph">
<p>Die Anzahl an FMUs in einem Zyklus zu begrenzen reduziert nicht nur den gesamten Aufwand, sondern berücksichtigt auch die Steifigkeit der Kopplung. In einem Zyklus könnten die FMUs nur lose miteinander verbunden sein und die Konvergenz ist mit 2 oder 3 Wiederholungen erreicht. In anderen Zyklen können die FMUs in einer nichtlinearen Beziehung gekoppelt sein oder sensibler auf Änderungen der Eingangswerte reagieren (= starre Kopplung) wodurch zehn oder mehr Wiederholungen benötigt würden. Das Trennen der Zyklen kann daher <em>den Rechenaufwand</em> bei der Gauss-Seidel signifikant <em>verkleinern</em>.</p>
</div>
<div class="paragraph">
<p>Jede FMU kann einem Zyklus zugewiesen werden. Die Zyklen sind durchnummeriert (beginnend bei 0) und werden in der Reihenfolge der Zyklusnummer berechnet (siehe Simulatordefinition im Abschnitt <a href="#slave_definition">Simulator-/Slave-Definitionen</a>).</p>
</div>
</div>
</div>
<div class="sect3">
<h4 id="_newton_verfahren">1.9.3. Newton-Verfahren</h4>
<div class="paragraph">
<p>Basis-Algorithmus:</p>
</div>
<div class="listingblock">
<div class="content">
<pre>Iterationsschleife:
  In der ersten Iteration berechne Newton/Jacobi-Matrix mittels Differenzquotienten

  Schleife über alle Slaves:
    setzen aller Eingangswerte aus globaler Variablenzuordnungsliste
    den Slave einen Schritt durchführen lassen (doStep())

  Schleife über alle Slaves:
    Ergebnisgrößen vom Slave abrufen

  Newton-Gleichungssystem lösen
  Berechnen der Korrekturgrößen für die Variablen und Aktualisieren der
  Variablen

  Konvergenz-Test durchführen</pre>
</div>
</div>
<div class="paragraph">
<p>Zyklen werden genauso behandelt wie beim Gauss-Seidel-Algorithmus.</p>
</div>
<div class="admonitionblock note">
<table>
<tr>
<td class="icon">
<i class="fa icon-note" title="Note"></i>
</td>
<td class="content">
<div class="paragraph">
<p>Für den Fall, dass nur eine einzige FMU innerhalb des Zyklus ist, wird der Newton-Master-Algorithmus diese FMU nur einmal auswerten und die Ergebnisse als bereits konvergiert behandeln. Natürlich wird in diesem Fall keine Newton-Matrix benötigt und erstellt. Allerdings wird dies in dem (seltenen) Fall, dass eine solche FMU seine Eingangswerte mit <em>seinen eigenen Ausgängen</em> verbindet, zu Problemen führen, da potentiell ungültige/unpassende FMU-Bedingungen vom Newton-Schritt akzeptiert werden.</p>
</div>
</td>
</tr>
</table>
</div>
</div>
</div>
<div class="sect2">
<h3 id="_schreiben_von_ergebnisgrößenausgangsvariablen">1.10. Schreiben von Ergebnisgrößen/Ausgangsvariablen</h3>
<div class="paragraph">
<p>Ergebnisgrößen werden nach jedem vollendeten Schritt geschrieben, aber nur, wenn die Zeitspanne seit dem letzten Schreiben mindestens so lang ist wie im Parameter <strong>hOutputMin</strong> festgelegt.</p>
</div>
<div class="admonitionblock tip">
<table>
<tr>
<td class="icon">
<i class="fa icon-tip" title="Tip"></i>
</td>
<td class="content">
<div class="paragraph">
<p>Wenn Sie Ausgänge wirklich nach jedem einzelnen Kommunikationsinterval/Berechnungsschritt haben wollen, setzen Sie <strong>hOutputMin</strong> auf 0.</p>
</div>
</td>
</tr>
</table>
</div>
</div>
</div>
</div>
<div class="sect1">
<h2 id="_grafische_benutzeroberfläche">2. Grafische Benutzeroberfläche</h2>
<div class="sectionbody">
<div class="paragraph">
<p><em>MasterSim</em> verfügt über eine komfortable grafische Benutzeroberfläche, um <em>Simulations-Szenarios</em> festzulegen und anzupassen. Mit <em>Simulations-Szenario</em> meine ich die Festlegung, welche FMUs zu importieren sind, welche Slave (oder Slaves) erstellt werden sollen, wie Eingangs-und Ausgangsvariablen verbunden sind und die Definition aller Eigenschaften im Zusammenhang mit den Berechnungsalgorithmen. Grundsätzlich behaltet ein <em>Szenario</em> alles, das gebraucht wird, um eine Co-Simulation durchzuführen.</p>
</div>
<div class="sect2">
<h3 id="_startseite">2.1. Startseite</h3>
<div class="paragraph">
<p>Die Software startet mit einer Startseite, welche eine Liste kürzlich verwendeter Projekte und einiger webbasierter Neuigkeiten enthält (diese werden von der Datei <a href="https://bauklimatik-dresden.de/downloads/mastersim/news.html" class="bare">https://bauklimatik-dresden.de/downloads/mastersim/news.html</a> bezogen, welche aktualisiert wird, sobald eine neue Veröffentlichung oder Funktion zur Verfügung steht).</p>
</div>
<div class="imageblock">
<div class="content">
<img src="../images/gui_welcome_page.png" alt="Welcome page">
</div>
<div class="title">Abbildung 4. Startseite mit kürzlich verwendeten Projekten und webbasierten Neuigkeiten</div>
</div>
<div class="hdlist">
<table>
<tr>
<td class="hdlist1">
(1)
</td>
<td class="hdlist2">
<p>Miniaturansicht mit der Vorschau eines Simulations-Szenarios</p>
</td>
</tr>
<tr>
<td class="hdlist1">
(2)
</td>
<td class="hdlist2">
<p>Kurze Beschreibung des Projekts. Die Beschreibung entstammt der Kommentarzeile der Projektzeilenüberschriften (siehe Abschnitt <a href="#project_file_format">Format der Projekt-Datei</a>).</p>
</td>
</tr>
</table>
</div>
<div class="admonitionblock tip">
<table>
<tr>
<td class="icon">
<i class="fa icon-tip" title="Tip"></i>
</td>
<td class="content">
<div class="paragraph">
<p>Die auf der Startseite angezeigten Miniaturansichten werden immer dann  erzeugt/aktualisiert, wenn das Projekt gespeichert wird. Die Dateien werden innerhalb des Programm-Benutzerverzeichnisses platziert:</p>
</div>
<div class="ulist">
<ul>
<li>
<p>bei Windows in <code>%APPDATA\Roaming\MasterSim\thumbs</code> und</p>
</li>
<li>
<p>bei Linux/MacOS in <code>~/.local/share/MasterSim</code></p>
</li>
</ul>
</div>
<div class="paragraph">
<p>und die Bilddatei ist genauso benannt wie die Projektdatei mit angehängter Erweiterung <code>png</code>.</p>
</div>
</td>
</tr>
</table>
</div>
<div class="sect3">
<h4 id="_beispiele">2.1.1. Beispiele</h4>
<div class="paragraph">
<p>Beim Öffnen eines Beispiels von der Startseite/Beispielseite werden Sie aufgefordert, das Projekt zunächst in einer benutzerdefinierten Stelle zu sichern (Beispiele sind im Installationsverzeichnis abgelegt, welches gewöhnlich schreibgeschützt ist).</p>
</div>
</div>
</div>
<div class="sect2">
<h3 id="_symbolleiste_und_nützliche_tastenkombinationen">2.2. Symbolleiste und nützliche Tastenkombinationen</h3>
<div class="paragraph">
<p>Sobald ein Projekt erstellt/geöffnet ist, wird eine der Projektinhaltsansichten gezeigt und eine Symbolleiste an der linken Seite des Programms angezeigt. Die Symbole der Symbolleiste haben die folgenden Funktionen (sie werden auch durch einen Tooltip angezeigt, wenn man mit dem Mauszeiger über das Symbol fährt):</p>
</div>
<div class="hdlist">
<table>
<tr>
<td class="hdlist1">
Programminformation
</td>
<td class="hdlist2">
<p>Zeigt Programminformationsfenster</p>
</td>
</tr>
<tr>
<td class="hdlist1">
Neues Projekt
</td>
<td class="hdlist2">
<p>Erzeugt ein neues Projekt (Kürzel <strong>Strg + N</strong>)</p>
</td>
</tr>
<tr>
<td class="hdlist1">
Projekt öffnen
</td>
<td class="hdlist2">
<p>Öffnet eine <code>*.msim</code>-Projektdatei (Kürzel <strong>Strg + O</strong>)</p>
</td>
</tr>
<tr>
<td class="hdlist1">
Projekt speichern
</td>
<td class="hdlist2">
<p>Sichert das aktuelle Projekt (Kürzel <strong>Strg + S</strong>) (sichert außerdem die graphische Netzwerk-Darstellung)</p>
</td>
</tr>
<tr>
<td class="hdlist1">
Öffnet Post-Prozessing
</td>
<td class="hdlist2">
<p>Öffnet das Postprozessing-Werkzeug, angegeben im Einstellungsdialog. Ich würde grundsätzlich empfehlen, <a href="https://bauklimatik-dresden.de/postproc">PostProc 2</a> zu nutzen. Sie können hier jede andere Software starten oder sogar ein automatisches Analyseskript. Setzen Sie einfach die entsprechende Kommandozeile im Einstellungsdialog.</p>
</td>
</tr>
<tr>
<td class="hdlist1">
FMU Analyse
</td>
<td class="hdlist2">
<p><em>MasterSim</em> wird alle referenzierten FMUs entpacken und deren Modellbeschreibungs-Dateien lesen. Es aktualisiert außerdem die grafischen Schemata und Verbindungsansichten, wenn die FMU-Oberflächen sich geändert haben. Ebenso wird die Eigenschaftentabelle auf den neuesten Stand gebracht. Nutzen Sie diese Funktion, wenn Sie eine FMU im Dateiensystem aktualisiert haben und diese Änderungen in der <em>MasterSim</em>-Benutzeroberfläche anwenden/ansehen wollen (alternativ laden sie das Projekt einfach neu).</p>
</td>
</tr>
<tr>
<td class="hdlist1">
Slave-Definitionsansicht
</td>
<td class="hdlist2">
<p>Wechselt zur <a href="#slave_definition_view">Ansicht zum Definieren der FMU-Slaves</a>. Hier legen Sie fest, welche FMUs verwendet werden und setzen Parameter der FMU-Slaves. Außerdem können Sie eine grafische Darstellung des Netzwerkes erstellen.</p>
</td>
</tr>
<tr>
<td class="hdlist1">
Verknüpfungsansicht
</td>
<td class="hdlist2">
<p>Wechselt zur <a href="#connection_view">Verknüpfungsansicht</a>. Hier können Sie die Verbindungen zwischen den Slave Ein- und Ausgangsvariablen verwalten und spezielle Attribute (Transformationen) zwischen den Verbindungen zuweisen.</p>
</td>
</tr>
<tr>
<td class="hdlist1">
Simulationseinstellungen
</td>
<td class="hdlist2">
<p>Wechselt zur <a href="#simulation_settings_view">Simulationsansicht</a>. Alle Simulationsparameter und numerischen Algorithmusoptionen sind hier spezialisiert. Die Start der eigentlichen Simulation erfolgt ebenso von dieser Ansicht.</p>
</td>
</tr>
<tr>
<td class="hdlist1">
Undo/Redo
</td>
<td class="hdlist2">
<p>Die nächsten zwei Buttons steuern die Funktionen <em>Rückgängig</em> und <em>Wiederholen</em> der Benutzeroberfläche. Alle im Projekt gemachten Änderungen können zurückgenommen und noch einmal gemacht (Kürzel sind <strong>Strg + Z</strong> für <em>Rückgängig machen</em> und <strong>Strg + Shift + Z</strong> für <em>Wiederholen</em>).</p>
</td>
</tr>
<tr>
<td class="hdlist1">
Sprache umschalten
</td>
<td class="hdlist2">
<p>Diese Schaltfläche öffnet ein Kontextmenü mit einer Sprachauswahl. Sie müssen die Anwendung neu starten, um die neue Sprache zu aktivieren.</p>
</td>
</tr>
<tr>
<td class="hdlist1">
Beenden
</td>
<td class="hdlist2">
<p>Schließt die Software. Wenn das Projekt verändert worden ist, wird der Benutzer gefragt, ob er die Änderungen speichern oder verwerfen möchte.</p>
</td>
</tr>
</table>
</div>
<div class="sect3">
<h4 id="_nützliche_tastenkürzel">2.2.1. Nützliche Tastenkürzel</h4>
<div class="paragraph">
<p>Hier ist eine Liste der nützlichen programmweiten Tastaturkürzel:</p>
</div>
<table class="tableblock frame-all grid-all stretch">
<caption class="title">Tabelle 1. Programmweite Tastenkombinationen</caption>
<colgroup>
<col style="width: 20%;">
<col style="width: 40%;">
<col style="width: 40%;">
</colgroup>
<thead>
<tr>
<th class="tableblock halign-left valign-top">Windows/Linux</th>
<th class="tableblock halign-left valign-top">MacOS</th>
<th class="tableblock halign-left valign-top">Command</th>
</tr>
</thead>
<tbody>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><strong>Strg + N</strong></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><strong>CMD + N</strong></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">erstellt ein neues Projekt</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><strong>Strg + O</strong></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><strong>CMD + O</strong></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">lädt ein Projekt</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><strong>Strg + S</strong></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><strong>CMD + S</strong></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">speichert ein Projekt</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><strong>Strg + Shift + S</strong></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><strong>CMD + Shift + S</strong></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">speichert das Projekt mit einem neuen Dateinamen</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><strong>Strg + Z</strong></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><strong>CMD + Z</strong></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">rückgängig machen</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><strong>Strg + Shift + Z</strong></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><strong>CMD + Shift + Z</strong></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">erneut versuchen</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><strong>F2</strong></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><strong>F2</strong></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">öffnet die Projektdatei im Texteditor</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><strong>F8</strong></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><strong>F8</strong></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">öffnet das Verzeichnis der Projektdatei in der Dateiverwaltung</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><strong>F9</strong></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><strong>F9</strong></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">startet die Simulation (kann von jeder Ansicht genutzt werden, es ist nicht notwendig, zunächst zur Ansicht der Simulationsumgebung zu wechseln!)</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><strong>CMD + .</strong></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">öffnet den Einstellungs-Dialog</p></td>
</tr>
</tbody>
</table>
</div>
</div>
<div class="sect2">
<h3 id="slave_definition_view">2.3. Ansicht zum Definieren der FMU-Slaves</h3>
<div class="paragraph">
<p>Die Eingabe eines Simulations-Szenarios ist in drei Ansichten aufgeteilt. Das Erstellen einer Simulation startet mit dem Importieren von FMUs/Slaves. Somit ist die Ansicht zum Festlegen der Slaves die Erste (und Wichtigste).</p>
</div>
<div class="imageblock">
<div class="content">
<img src="../images/gui_slave_view.png" alt="Slave view">
</div>
<div class="title">Abbildung 5. Die Slave-Ansicht zeigt eine Liste importierter FMUs, zugewiesene Slave-ID-Namen und eine optionale graphische Darstellung.</div>
</div>
<div class="paragraph">
<p>Elemente der Ansicht:</p>
</div>
<div class="hdlist">
<table>
<tr>
<td class="hdlist1">
(1)
</td>
<td class="hdlist2">
<p>Fügt einen neuen Slave durch das Auswählen einer FMU-Datei (<code>*.fmu</code>) oder eines Datei-lese-Slaves zu (<code>csv</code> or <code>tsv</code> file, siehe Abschnitt <a href="#csv_filereader_slaves">CSV FileReader Slaves</a>)</p>
</td>
</tr>
<tr>
<td class="hdlist1">
(2)
</td>
<td class="hdlist2">
<p>Entfernt den gegenwärtig ausgewählten Slave (und alle zu ihm gemachten Verbindungen)</p>
</td>
</tr>
<tr>
<td class="hdlist1">
(3)
</td>
<td class="hdlist2">
<p>Durch Doppelklicken wird die Farbe des Slaves geändert (die Farbe wird genutzt, um den Slave in der Verbindungsansicht identifizieren zu können)</p>
</td>
</tr>
<tr>
<td class="hdlist1">
(4)
</td>
<td class="hdlist2">
<p>Der ID-Name des Slaves. Standardmäßig weist <em>MasterSim</em> den Basisdateinamen der FMU-Datei zu. Durch Doppelklicken dieser Zelle kann dies geändert werden. Beachten Sie: Slave-ID-namen müssen innerhalb des Simulations-Szenarios einzigartig sein.</p>
</td>
</tr>
<tr>
<td class="hdlist1">
(5)
</td>
<td class="hdlist2">
<p>Pfad zu einer FMU-Datei, entweder der absolute Pfad oder relativ zur aktuellen <em>MasterSim</em> -Projekt-Datei, abhängig vom Kontrollkästchen <em>"Zeige FMU Pfade relativ zur Projektdatei"</em>. Außerdem muss die Projektdatei gespeichert worden sein, bevor relative Pfade angezeigt werden können.</p>
</td>
</tr>
<tr>
<td class="hdlist1">
(6)
</td>
<td class="hdlist2">
<p>Definiert, in welchem Zyklus der FMU-Slave berechnet werden soll (standardmäßig sind alle Slaves im Zyklus 0 verknüpft und damit werden alle gekoppelt berechnet. Siehe Zyklen-Beschreibung im Abschnitt <a href="#master_algorithms">Master-Algorithmus</a>).</p>
</td>
</tr>
<tr>
<td class="hdlist1">
(7)
</td>
<td class="hdlist2">
<p>Aktivieren des grafischen Verbindungsmodus (siehe Diskussion unten). Wenn dieser Modus aktiv ist, können Sie eine neue Verbindung von einem Ausgang zu einem Eingang im Netzwerk ziehen.</p>
</td>
</tr>
<tr>
<td class="hdlist1">
(8)
</td>
<td class="hdlist2">
<p>Druckt Netzwerkschemata oder exportiert eine PDF-Datei.</p>
</td>
</tr>
<tr>
<td class="hdlist1">
(9)
</td>
<td class="hdlist2">
<p>Dies ist ein grafisches Netzwerkschema - rein optional, aber es hilft, das Co-Simulations-Szenario zu verstehen.</p>
</td>
</tr>
</table>
</div>
<div class="sect3">
<h4 id="_slaves_hinzufügen">2.3.1. Slaves hinzufügen</h4>
<div class="paragraph">
<p>Neue Slaves werden durch das Auswählen von <code>fmu</code>- oder  <code>csv</code>- oder <code>tsv</code>-Dateien zugefügt. <em>MasterSim</em> nutzt automatisch den Basisnamen der ausgewählten Datei als ID-Namen für den Slave. Falls bereits ein solcher ID-Name existiert, fügt <em>MasterSim</em> eine Nummer zum Basisnamen hinzu. In jedem Fall müssen die Slave-ID-Namen einzigartig innerhalb des Projekts sein.</p>
</div>
<div class="admonitionblock tip">
<table>
<tr>
<td class="icon">
<i class="fa icon-tip" title="Tip"></i>
</td>
<td class="content">
<div class="paragraph">
<p>Sie können die gleiche FMU mehrere Male importieren. In diesem Fall werden die Slaves unterschiedliche ID-Namen haben, referenzieren aber trotzdem die gleiche FMU-Datei. Parameter und das visuelle Auftreten können für einen Slave der selben FMU unterschiedlich gesetzt sein. Es ist zu beachten, dass eine FMU die Fähigkeit <strong>canBeInstantiatedOnlyOncePerProcess</strong> auf <em>false</em> gesetzt haben muss, wenn man sie mehrfach in einem Simulationsszenario verwenden möchte.</p>
</div>
</td>
</tr>
</table>
</div>
</div>
<div class="sect3">
<h4 id="_eigenschaftenparameterwerte_der_slaves">2.3.2. Eigenschaften/Parameterwerte der Slaves</h4>
<div class="paragraph">
<p>Unterhalb der Tabelle mit den verwendeten Slaves ist eine Liste der von den FMUs publizierten Parameter. Die Liste gilt für den  <em>gegenwärtig ausgewählten</em> Slave. Ein Simulations-Slave kann in der Slave-Tabelle oder durch Anklicken eines Blocks in der Netzwerkansicht ausgewählt werden.</p>
</div>
<div class="imageblock">
<div class="content">
<img src="../images/gui_slave_view_properties.png" alt="Slave parameter table">
</div>
<div class="title">Abbildung 6. Tabelle mit Slave-spezifischen Parameterwerten</div>
</div>
<div class="hdlist">
<table>
<tr>
<td class="hdlist1">
(1)
</td>
<td class="hdlist2">
<p>Schwarze und fette Schrift gibt an, dass dieser Parameter modifiziert oder auf einen bestimmten Wert gesetzt worden ist. Grauer, kursiver Text zeigt einen standardmäßigen, unveränderten Wert.</p>
</td>
</tr>
<tr>
<td class="hdlist1">
(2)
</td>
<td class="hdlist2">
<p>Fährt man mit der Maus über einen Parameterwert, zeigt sich ein Tooltip mit den Standardparametern. Dies kann genutzt werden, um den Standardwert zu sehen, falls der Parameter bereits verändert wurde.</p>
</td>
</tr>
<tr>
<td class="hdlist1">
(3)
</td>
<td class="hdlist2">
<p>Parameter, die in schwarzer Fettschrift geschrieben sind, wurden von <em>MasterSim</em> gesetzt (während der Initialisierung).</p>
</td>
</tr>
</table>
</div>
<div class="paragraph">
<p>Parameter können durch <strong>Doppeklicken</strong> der Wertezelle editiert werden. Das Löschen des Inhalts der Zelle setzt die Parameter auf ihre standardmäßigen Werte zurück.</p>
</div>
</div>
<div class="sect3">
<h4 id="_netzwerkansicht">2.3.3. Netzwerkansicht</h4>
<div class="paragraph">
<p>Die Netzwerkansicht <strong>(9)</strong> zeigt ein simples Schema aller FMU-Slaves und ihrer Verbindungen.  Diese Netzwerkansicht ist optional und wird für die Simulation nicht wirklich gebraucht. Dennoch ist die visuelle Darstellung des Simulations-Szenarios wichtig für die Kommunikation und die Prüfung der Eingabe.</p>
</div>
<div class="admonitionblock tip">
<table>
<tr>
<td class="icon">
<i class="fa icon-tip" title="Tip"></i>
</td>
<td class="content">
<div class="paragraph">
<p>Mit dem Scrollrad der Maus können Sie in der Netzwerkansicht heraus- und hineinzoomen. Es wird zu der Stelle gezoomt, an der sich der Mauszeiger befindet.</p>
</div>
</td>
</tr>
</table>
</div>
<div class="paragraph">
<p>Das Netzwerk zeigt <strong><em>Blöcke</em></strong> (je importiertem Simulator/Slave), und in jedem Block eine oder mehrere <strong><em>Anschlussstellen/Sockel</em></strong> (engl. <em>socket</em>). Diese <strong><em>Sockel</em></strong> zeigen die Eingangs-/Ausgangsvariablen eines jeden Simuations-Slaves an. Die Blöcke werden in unterschiedlichen Farben angezeigt, welche individuelle <a href="#block_states">Blockzustände</a> anzeigen.</p>
</div>
<div class="paragraph">
<p>Blöcke können markiert und dann mit der Maus verschoben werden. Ebenso können Verbindungslinien verschoben werden.</p>
</div>
<div class="admonitionblock tip">
<table>
<tr>
<td class="icon">
<i class="fa icon-tip" title="Tip"></i>
</td>
<td class="content">
<div class="paragraph">
<p>Falls Sie mehrere Blöcke gleichzeitig verschieben wollen, können sie mehrere Blöcke mittels <strong>Strg + Click</strong> auswählen. Wenn Sie nun einen der Blöcke verschieben, werden sich die anderen ausgewählten Blöcke ebenso bewegen.</p>
</div>
</td>
</tr>
</table>
</div>
<div class="sect4">
<h5 id="_verbindungen_in_der_netzwerkansicht_herstellen">Verbindungen in der Netzwerkansicht herstellen</h5>
<div class="paragraph">
<p>Sie können eine neue Verbindung zwischen Ein- und Ausgängen von Slaves herstellen, indem Sie zunächst das Netzwerk durch das Drücken des Buttons <strong>(7)</strong> in den  <em>Verknüpfungsmodus</em> versetzen. Wenn der Verbindungsmodus aktiv ist, wandelt sich der Zeiger innerhalb des Netzwerkansicht-Fensters zu einem Kreuz. Sie können die Maus dann über einen Variablenausgang bewegen (Dreieck). <em>Drücken und halten</em> Sie die linke Maustaste und ziehen Sie die Verbindung zu einem <em>freien</em> Variableneingang (leerer Halbkreis). Wenn die Verbindung hergestellt wurde, wird der Verbindungsmodus wieder ausgeschaltet und die Blöcke und Verbindungen können bewegt werden.</p>
</div>
<div class="admonitionblock tip">
<table>
<tr>
<td class="icon">
<i class="fa icon-tip" title="Tip"></i>
</td>
<td class="content">
<div class="paragraph">
<p>Sie können den <em>Verbindungsmodus</em> verlassen, indem Sie in der Netzwerkansicht die rechte Maustaste drücken.</p>
</div>
</td>
</tr>
</table>
</div>
<div class="paragraph">
<p>Verbindungen zwischen Slaves können in der <a href="#connection_view">Verknüpfungsansicht</a> bequemer festgelegt werden (welche ebenso effizienter ist, wenn mehr Verbindungen hergestellt werden, vergleichbar zum manuellen Ziehen der Verbindung mit der Maus).</p>
</div>
</div>
<div class="sect4">
<h5 id="block_states">Block-Zustandsanzeige</h5>
<div class="paragraph">
<p>Da <em>MasterSim</em> die verwendeten FMUs selbst nur referenziert, erhält die Programmoberfläche nur dann Kenntnis vom eigentlichen Inhalt (z. B. Anschlusseigenschaften aus der <code>modelDescription.xml</code> Datei), wenn die FMU analysisert wird. Der FMU-Analyseschritt wird automatisch vorgenommen, wenn ein Projekt geöffnet ist und ein neuer FMU-Slave hinzugefügt wird.</p>
</div>
<div class="paragraph">
<p>Beim Analysieren einer FMU versucht die Benutzeroberfläche, das FMU-Archiv zu entpacken und dessen Inhalt zu analysieren. Wenn die <code>modelDescription.xml</code>-Datei korrekt gelesen werden konnte, bietet <em>MasterSim</em> an, den Block-Bearbeitungsdialog zu öffnen. Innerhalb dieses Dialogs können Sie die grundlegende Geometrie des Blocks (SLave-Darstellung) und die Gestaltung der Anschlüsse (die Position der Eingangs-/Ausgangsvariablen) festlegen. Sie können diesen Schritt aber auch überspringen. Grundsätzlich kann eine Block eines FMU-Slaves drei Zustände haben, die in der UI unterschiedlich dargestellt sind:</p>
</div>
<div class="imageblock">
<div class="content">
<img src="../images/bm_block_states.png" alt="Block states">
</div>
<div class="title">Abbildung 7. Unterschiedliche Zustände von Blöcken und deren visuelle Darstellung</div>
</div>
<div class="hdlist">
<table>
<tr>
<td class="hdlist1">
(1)
</td>
<td class="hdlist2">
<p>Die entsprechende <code>fmu</code>-Datei existiert nicht oder kann nicht gelesen werden (kein Archiv, kann nicht extrahiert werden, beinhaltet keine <code>modelDescription.xml</code>-Datei, die XML-Datei ist ungültig/fehlerhaft, oder &#8230;&#8203; viele Dinge können hier schief gehen)</p>
</td>
</tr>
<tr>
<td class="hdlist1">
(2)
</td>
<td class="hdlist2">
<p>Die Modellbeschreibung wurde für diese FMU erfolgreich analysiert, aber die Blockdefinition stimmt nicht mit dem der Modellbeschreibung überein, oder es wurde noch gar keine Blockdefinition erstellt. Typischerweise, wenn eine FMU zum ersten Mal importiert wird, gibt es noch keine Definition der graphischen Darstellung dieser FMU. Es wird dann  einfache eine rote Box angezeigt. Sie können diese Box  <strong>doppelt anklicken</strong>, um den Block-Bearbeitungsdialog zu öffnen.</p>
</td>
</tr>
<tr>
<td class="hdlist1">
(3)
</td>
<td class="hdlist2">
<p>Das Block-Erscheinungsbild ist bereits definiert worden und die Anschlüsse passen zu der Modellbeschreibung (Name und Eingangs-/Ausgangstypen stimmen überein).</p>
</td>
</tr>
</table>
</div>
</div>
</div>
<div class="sect3">
<h4 id="_block_bearbeitungsdialog">2.3.4. Block-Bearbeitungsdialog</h4>
<div class="paragraph">
<p>Der Block-Bearbeitungsdialog erlaubt Ihnen, die grundlegende, rechteckige Gestalt der FMU festzulegen und die Abschlüsse zu auszurichten. Der Block-Bearbeitungsdialog wird entweder direkt nach dem Import einer FMU geöffnet oder indem Sie auf einen Block in der Netzwerkansicht <strong>doppelklicken</strong>.</p>
</div>
<div class="imageblock">
<div class="content">
<img src="../images/bm_block_editor.png" alt="Block Editor">
</div>
<div class="title">Abbildung 8. Bearbeitungsdialog für die Blockgeometrie und die Gestaltung des Sockels</div>
</div>
<div class="hdlist">
<table>
<tr>
<td class="hdlist1">
(1)
</td>
<td class="hdlist2">
<p>Slave-ID-Name</p>
</td>
</tr>
<tr>
<td class="hdlist1">
(2)
</td>
<td class="hdlist2">
<p>Zeigt die Anzahl der veröffentlichten Eingangs- und Ausgangsvariablen</p>
</td>
</tr>
<tr>
<td class="hdlist1">
(3)
</td>
<td class="hdlist2">
<p>Wenn angeschaltet, wird das FMU-Archiv nach der Image-Datei <code>model.png</code> durchsucht (die sollte neben der <code>modelDescription.xml</code>-Datei im Hauptverzeichnis des FMU-Archivs liegen). Wenn vorhanden, wird das Bild skaliert entsprechend der Blockgröße angezeigt.</p>
</td>
</tr>
<tr>
<td class="hdlist1">
(4)
</td>
<td class="hdlist2">
<p>Hier können Sie die Weite und Höhe des Blocks in Rasterlinien festlegen.</p>
</td>
</tr>
<tr>
<td class="hdlist1">
(5)
</td>
<td class="hdlist2">
<p>Dieser Knopf richtet die Anschlüsse aus. Eingänge sind an der linken, oberen Seite ausgerichtet, Ausgänge an der rechten, unteren Seite. Falls es nicht genügend Platz für alle Anschlüsse gibt, werden die verbleibenden Anschlüsse übereinander platziert.</p>
</td>
</tr>
<tr>
<td class="hdlist1">
(6)
</td>
<td class="hdlist2">
<p>Markierung eines Variableneingangs (Eingangsvariable)</p>
</td>
</tr>
<tr>
<td class="hdlist1">
(7)
</td>
<td class="hdlist2">
<p>Markierung eines Variablenausgangs (Ausgangsvariable)</p>
</td>
</tr>
</table>
</div>
<div class="admonitionblock tip">
<table>
<tr>
<td class="icon">
<i class="fa icon-tip" title="Tip"></i>
</td>
<td class="content">
<div class="paragraph">
<p>In einer der nächsten Programmversionen wird es möglich sein, das Erscheinungsbild eines Blocks als Vorlage für die Nutzung bei ähnlichen oder gleichen FMUs zu speichern. Gegenwärtig müssen Sie den Block jedes Mal konfigurieren, wenn Sie eine FMU importieren. Ebenso ist die verbesserte Anwendung und der benutzerdefinierte Sockel-Speicherort noch nicht umgesetzt.</p>
</div>
<div class="paragraph">
<p>Wenn dieses Feature benötigt wird, bitte ein <a href="https://github.com/ghorwin/MasterSim/issues">Ticket anlegen</a>.</p>
</div>
</td>
</tr>
</table>
</div>
</div>
</div>
<div class="sect2">
<h3 id="connection_view">2.4. Verknüpfungsansicht</h3>
<div class="paragraph">
<p>In dieser Ansicht können Sie Slaves verknüpfen, indem Sie Ausgangs- und Eingangsvariablen verbinden.</p>
</div>
<div class="imageblock">
<div class="content">
<img src="../images/gui_connection_view.png" alt="Connection view">
</div>
<div class="title">Abbildung 9. Verknüpfungsansicht mit Anzeige der Eingangs- und Ausgangsvariablen für alle Slaves und der bereits festgelegten Verbindungen</div>
</div>
<div class="hdlist">
<table>
<tr>
<td class="hdlist1">
(1)
</td>
<td class="hdlist2">
<p>Zeigt alle veröffentlichten Ausgangs- und Eingangsvariablen aller Slaves.</p>
</td>
</tr>
<tr>
<td class="hdlist1">
(2)
</td>
<td class="hdlist2">
<p>Zeigt die Eingangsvariablen aller Slaves, welche noch <strong>nicht</strong> verbunden worden sind.</p>
</td>
</tr>
<tr>
<td class="hdlist1">
(3)
</td>
<td class="hdlist2">
<p>Wählen Sie zunächst eine Ausgangsvariable und eine Eingangsvariable aus, welche verbunden werden sollen und drücken dann diesen Knopf, um eine Verbindung herzustellen.</p>
</td>
</tr>
<tr>
<td class="hdlist1">
(4)
</td>
<td class="hdlist2">
<p>Hier können Sie gleich mehrere Verknüpfungen zwischen zwei Slaves erstellen (siehe Erklärung unten)</p>
</td>
</tr>
<tr>
<td class="hdlist1">
(5)
</td>
<td class="hdlist2">
<p>Dies entfernt die aktuell ausgewählte Verbindung in der Tabelle (6)</p>
</td>
</tr>
<tr>
<td class="hdlist1">
(6)
</td>
<td class="hdlist2">
<p>Zeigt alle bisher erzeugten Verknüpfungen. Durch einen <strong>Doppelklick</strong> auf die letzte Spalte kann eine Umrechenoperation (z.B. für Einheitenumrechnung oder Vorzeichenwechsel) definiert werden.</p>
</td>
</tr>
<tr>
<td class="hdlist1">
(7)
</td>
<td class="hdlist2">
<p>Eine Tabelle mit allen Slaves und ihren zugeordneten Farben (erleichtert die Identifikation der Variablen nach Slave-Farbe)</p>
</td>
</tr>
</table>
</div>
<div class="sect3">
<h4 id="_die_besonderheiten_automatischer_verbindungen">2.4.1. Die Besonderheiten automatischer Verbindungen</h4>
<div class="paragraph">
<p>Diese Funktion ist sehr hilfreich, wenn FMUs miteinander verbunden werden sollen, deren Ausgangs- und Eingangsvariablen den gleichen Namen haben. Dies ist insbesondere hilfreich, wenn Sie viele Eingangs- und Ausgangsvariablen zwischen zwei Slaves verbinden müssen. Falls Sie FMUs mit passender Namensgebung der Variablen erzeugen, können Sie den folgenden Ablauf nutzen:</p>
</div>
<div class="olist arabic">
<ol class="arabic">
<li>
<p>wählen sie in den Auswahllistenboxen die zu verbindenden Slaves aus, und</p>
</li>
<li>
<p>drücken Sie den Verknüpfungsknopf.</p>
</li>
</ol>
</div>
<div class="paragraph">
<p>Eine Verbindung wird erstellt, wenn:</p>
</div>
<div class="ulist">
<ul>
<li>
<p>der Variablenname übereinstimmt</p>
</li>
<li>
<p>der Datentyp der Variable passt</p>
</li>
<li>
<p>eine Variable eine Eingangsvariable ist (Causality = INPUT) und die andere eine Ausgangsvariable ist (Causality = OUTPUT)</p>
</li>
</ul>
</div>
<div class="paragraph">
<p><a href="#ex_autoconnect">Beispiel 1</a> verdeutlicht eine solche automatische Verknüpfung.</p>
</div>
<div id="ex_autoconnect" class="exampleblock">
<div class="title">Beispiel 1. Automatische Verknüpfung zweier Slaves</div>
<div class="content">
<div class="olist arabic">
<ol class="arabic">
<li>
<p>Slave1 publiziert:</p>
<div class="ulist">
<ul>
<li>
<p><code>Raum1.Temperatur</code> (real, Ausgang)</p>
</li>
<li>
<p><code>Raum1.Heizleistung</code> (real, Eingang)</p>
</li>
<li>
<p><code>Raum1.Betriebstemperatur</code> (real, Ausgang)</p>
</li>
</ul>
</div>
</li>
<li>
<p>Slave2 publiziert:</p>
<div class="ulist">
<ul>
<li>
<p><code>Raum1.Temperatur</code> (real, Eingang)</p>
</li>
<li>
<p><code>Raum1.Heizleistung</code> (real, Ausgang)</p>
</li>
<li>
<p><code>Raum2.OperativeTemperatur</code> (real, Eingang)</p>
</li>
</ul>
</div>
</li>
</ol>
</div>
<div class="paragraph">
<p>Die automatische Verbindung erstellt:</p>
</div>
<div class="ulist">
<ul>
<li>
<p><code>Slave1.Raum1.Temperatur  -&gt; Slave2.Raum1.Temperatur</code></p>
</li>
<li>
<p><code>Slave1.Raum1.Heizleistung -&gt; Slave2.Raum1.Heizleistung</code></p>
</li>
</ul>
</div>
<div class="paragraph">
<p>Die dritte Verbindung wird nicht hergestellt, da <em>Raum1.Betriebstemperatur</em> namentlich nicht zu <em>Raum2.OperativeTemperatur</em> passt.</p>
</div>
</div>
</div>
</div>
<div class="sect3">
<h4 id="_eine_umrechnungsoperation_zwischen_variablen_definieren">2.4.2. Eine Umrechnungsoperation zwischen Variablen definieren</h4>
<div class="paragraph">
<p>Falls Sie die Umwandlung einer Einheit oder andere Änderungen (Zeichenumkehrung, Skalierung) zwischen Ausgangs- und Eingangsvariablen vornehmen wollen, können Sie in der dritten Spalte der Tabelle <strong>(6)</strong> <strong>doppelklicken</strong>, um einen Dialog für das Bearbeiten der Umrechungsoperation zu öffnen (siehe Abschnitt <a href="#connection_graph">Verbindungsgraph</a> für eine detaillierte Beschreibung).</p>
</div>
</div>
</div>
<div class="sect2">
<h3 id="simulation_settings_view">2.5. Simulationsansicht</h3>
<div class="paragraph">
<p>In dieser Ansicht werden alle Einstellungen zu den Co-Simulations-Algorithmen festgelegt. Eine detaillierte Beschreibung der Einstellungen und ihrer Anwendung findet man im Abschnitt <a href="#master_algorithms">Master-Algorithmen</a>.</p>
</div>
<div class="admonitionblock tip">
<table>
<tr>
<td class="icon">
<i class="fa icon-tip" title="Tip"></i>
</td>
<td class="content">
<div class="paragraph">
<p>Abschnitt <a href="#simulator_settings">Projektdatei-Referenz - Simulationseinstellungen</a> beschreibt die zugehörigen Einträge in der <em>MasterSim</em>-Projekt-Datei.</p>
</div>
</td>
</tr>
</table>
</div>
<div class="imageblock">
<div class="content">
<img src="../images/gui_simulation_settings_view.png" alt="Simulation view">
</div>
<div class="title">Abbildung 10. Simulationseinstellungen und die Startansicht der Simulation</div>
</div>
<div class="hdlist">
<table>
<tr>
<td class="hdlist1">
(1)
</td>
<td class="hdlist2">
<p>Hier können sie den Start- und Endzeitpunkt ihrer Simulation festlegen.</p>
</td>
</tr>
<tr>
<td class="hdlist1">
(2)
</td>
<td class="hdlist2">
<p>Die anfängliche Intervallgröße der Datenübertragung. Wenn die Zeitschritt-Anpassung <strong>(7)</strong> deaktiviert ist, wird diese Intervallgröße konstant verwendet, bis das Ende der Simulationszeit erreicht wurde.</p>
</td>
</tr>
<tr>
<td class="hdlist1">
(3)
</td>
<td class="hdlist2">
<p>Auswahl des Master-Algorithmus</p>
</td>
</tr>
<tr>
<td class="hdlist1">
(4)
</td>
<td class="hdlist2">
<p>Maximale Anzahl an Wiederholungen, 1 deaktiviert Wiederholung.</p>
</td>
</tr>
<tr>
<td class="hdlist1">
(5)
</td>
<td class="hdlist2">
<p>Die relativen und absoluten Toleranzen werden für einen Konvergenztest in iterativen Algorithmen und, falls eingeschaltet, für die Prüfung des lokalen Fehlers und die Zeitschritt-Anpassung genutzt.</p>
</td>
</tr>
<tr>
<td class="hdlist1">
(6)
</td>
<td class="hdlist2">
<p>Hier können Sie eine Fehlerkontroll-Methode auswählen, siehe Abschnitt <a href="#error_control_and_time_step_adjustment">Fehlerkontrolle und Zeitschritt-Anpassung</a>.</p>
</td>
</tr>
<tr>
<td class="hdlist1">
(7)
</td>
<td class="hdlist2">
<p>Wenn eingeschaltet, wird <em>MasterSim</em> den Zeitschritt adaptiv verändern. Dies verlangt, dass FMUs die Fähigkeit <strong>canHandleVariableCommunicationStepSize</strong> unterstützen.</p>
</td>
</tr>
<tr>
<td class="hdlist1">
(8)
</td>
<td class="hdlist2">
<p>Diese drei Parameter legen fest, wie der Zeitschritt im Fall einer Anpassung/Scheitern des Fehlertests angepasst wird.</p>
</td>
</tr>
<tr>
<td class="hdlist1">
(9)
</td>
<td class="hdlist2">
<p>Wenn eingeschaltet, wird <em>MasterSim</em> die Schrittgröße an das letzte Intervall so anpassen, dass es den Endzeitpunkt der Simulation als Ende des <em>letzten</em> Kommunikationsintervalls  <em>exakt</em> erreicht, ohne dabei Rücksicht auf das Option <strong>(7)</strong> zu nehmen (siehe Diskussion in Abschnitt <a href="#timestep_adjustment">Anpassung der Kommunikationsschrittlängen</a>).</p>
</td>
</tr>
<tr>
<td class="hdlist1">
(10)
</td>
<td class="hdlist2">
<p>Legt das minimale Zeitintervall zwischen dem Schreiben von Ausgabegrößen fest. Dies hilft, die Anzahl an Ausgaben im Fall variabler Zeitschritte zu reduzieren, wenn diese Zeitschritte viel kleiner als ein aussagekräftiges Ausgangsraster werden können.</p>
</td>
</tr>
<tr>
<td class="hdlist1">
(11)
</td>
<td class="hdlist2">
<p>Wenn eingeschaltet, schreibt <em>MasterSim</em> auch die Werte interner Variablen in die Ausgabedateien, ansonsten nur die Ausgabevariablen (Causality = OUTPUT). Dies ist hauptsächlich nützlich für Analysieren und die Fehlersuche in FMUs, oder um interne Werte zu erhalten, die nicht von der FMU selbst als Ausgaben bereitgestellt werden.</p>
</td>
</tr>
<tr>
<td class="hdlist1">
(12)
</td>
<td class="hdlist2">
<p>Damit kann die Detailstufe der Anwendungsmeldungen angepasst werden (siehe Abschnitt <a href="#command_line_arguments">Befehlszeilenargumente</a>).</p>
</td>
</tr>
<tr>
<td class="hdlist1">
(13)
</td>
<td class="hdlist2">
<p>Befehlszeile, welche für den Start des Simulators verwendet wird. Kann für die automatische Verarbeitung in einem Shell-Skript oder einer Batch-Datei kopiert werden.</p>
</td>
</tr>
<tr>
<td class="hdlist1">
(14)
</td>
<td class="hdlist2">
<p>Der große, dicke Start-Button. <strong>Auf die Plätze, Fertig, Los!</strong></p>
</td>
</tr>
</table>
</div>
<div class="paragraph">
<p>Wenn Sie die Simulation startet, wird ein Konsolenfenster mit einer Fortschritts-/Warnungs-/Fehlermeldung für die laufende Simulation auftauchen. Da einige Simulationen sehr schnell sein können, und damit das Fenster auch sehr schnell wieder verschwindet, wird sich nach ungefähr 2 Sekunden das Ausgabenmeldungsfenster mit dem gegenwärtigen Inhalt des Bildschirmprotokolls angezeigt.</p>
</div>
<div class="admonitionblock caution">
<table>
<tr>
<td class="icon">
<i class="fa icon-caution" title="Achtung"></i>
</td>
<td class="content">
<div class="paragraph">
<p>Beachten Sie, dass die Simulation vielleicht noch im Hintergrund laufen könnte, selbst wenn das Protokollfenster bereits gezeigt wurde. Wenn Sie die Simulation indes mehrere Male starten, werden mehrere Simulationsprozesse parallel laufen. Das wäre aber nur eine Rechenverschwendung, da die parallelen Simulationen ins selbe Verzeichnis schreiben und sich gegenseitig die Dateien überschreiben würden.</p>
</div>
</td>
</tr>
</table>
</div>
</div>
<div class="sect2">
<h3 id="_einstellungs_dialog">2.6. Einstellungs-Dialog</h3>
<div class="paragraph">
<p>Der Einstellungs-Dialog, geöffnet im Hauptmenü oder durch die Anwendung des Tastatur-Kürzels, bietet derzeit Konfigurationsoptionen für den externen Texteditor (wird genutzt, um die Projekt-Datei mittels Kürzel <strong>F2</strong> zu editieren) und das ausführbare Post-Prozessing-Programm an.</p>
</div>
<div class="imageblock">
<div class="content">
<img src="../images/gui_preferences_tools.png" alt="Preferences dialog">
</div>
<div class="title">Abbildung 11. Einstellungsdialog mit Eingangsoptionen für den Texteditor und das ausführbare Nachbearbeitungsprogramm</div>
</div>
<div class="paragraph">
<p>Folgende (leichtgewichtige und open-source) Texteditoren bevorzuge ich:</p>
</div>
<div class="ulist">
<ul>
<li>
<p>Linux: Geany</p>
</li>
<li>
<p>Windows: Notepad++</p>
</li>
<li>
<p>MacOS : Brackets (<a href="http://brackets.io" class="bare">http://brackets.io</a>)</p>
</li>
</ul>
</div>
<div class="admonitionblock tip">
<table>
<tr>
<td class="icon">
<i class="fa icon-tip" title="Tip"></i>
</td>
<td class="content">
<div class="paragraph">
<p>Wenn Sie eine Textdatei im externen Texteditor bearbeiten und die Datei speichern, oder die Projektdatei anderweitig in einem externen Programm verändert wird, fragt die <em>MasterSim</em>-Benutzeroberfläche nach, wenn es das nächste Mal in den Vordergrund geholt wird, ob die Projektdatei neu geladen werden soll.</p>
</div>
</td>
</tr>
</table>
</div>
</div>
</div>
</div>
<div class="sect1">
<h2 id="_mastersimulator_das_befehlszeilen_programm">3. <em>MasterSimulator</em> - Das Befehlszeilen-Programm</h2>
<div class="sectionbody">
<div class="paragraph">
<p>Die eigentliche Simulation wird mit dem Befehlszeilen-Programm <em>MasterSimulator</em> durchgeführt. Es führt  grundsätzlich die folgenden Schritte aus:</p>
</div>
<div class="olist arabic">
<ol class="arabic">
<li>
<p>Es liest die msim-Projektdatei (die Netzwerkdarstellung wird ignoriert, da sie nur visuelle Informationen enthält).</p>
</li>
<li>
<p>Danach wird ein Arbeitsverzeichnis für die Simulationsdaten erzeugt (der Pfad kann angepasst werden, siehe: <code>--working-dir</code>-Befehlzeilen-Option unten).</p>
</li>
<li>
<p>Die FUMs werden extrahiert (dies kann übersprungen werden, falls die FMUs bereits entpackt vorliegen, siehe Befehlszeilen-Option <code>--skip-unzip</code> unten).</p>
</li>
<li>
<p>Die Simulation wird, wie in der Projekt-Datei konfiguriert, durchgeführt.</p>
</li>
</ol>
</div>
<div class="sidebarblock">
<div class="content">
<div class="title">Benutzen von <em>MasterSim</em> in einer geskripteten Umgebung</div>
<div class="paragraph">
<p>Da die <em>MasterSim</em>-Projekt-Datei einfacher ASCII-Text ist und der Rechenkern durch die Befehlszeile gestartet werden kann, ist es möglich, <em>MasterSim</em> in einer geskripteten Umgebung und in automatisierten Prozessen zu nutzen (z. B. für Optimierungsrechnungen).</p>
</div>
</div>
</div>
<div class="sect2">
<h3 id="command_line_arguments">3.1. Befehlszeilenargumente</h3>
<div class="paragraph">
<p>Allgemeine Syntax für das <em>MasterSimulator</em> Kommandozeilenprogramm:</p>
</div>
<div class="listingblock">
<div class="content">
<pre>Syntax: MasterSimulator [Schalter] [Optionen] &lt;Projektdatei&gt;

Schalter:
  --help            Zeigt diese Hilfsseite.
  --man-page        Generiert eine man-Hilfeseite (Quellversion)
  --cmd-line        Zeigt die Befehlszeile, wie sie vom Befehlszeilen-Syntaxanalysierer verstanden wurde.
  --options-left    Zeigt alle Schalter/Optionen, die dem Befehszeilen-Syntaxanalysierer unbekannt sind.
  -v, --version     Zeigt die Versionsinformation.
  -x, --close-on-exit  Schließt das Konsolenfenster nach dem Beenden der Simulation (nur Windows).
  -t, --test-init   Startet die Initialisierung und stoppt sie direkt danach.
  --skip-unzip      Überspringt den Schritt zum Entpacken der FMUs und erwartet bereits entpackte FMU-Archive im Arbeitsverzeichnis.

Optionen:
  --verbosity-level=&lt;0..4&gt;
                    Detailstufe für Programmmeldungen (0-4).
  --working-dir=&lt;working-directory&gt;
                    Arbeitsverzeichnis für den Master.</pre>
</div>
</div>
<div class="sect3">
<h4 id="solver_working_dir">3.1.1. Anpassung des Arbeits- und Ausgabeverzeichnis</h4>
<div class="paragraph">
<p>Wenn kein Arbeitsverzeichnis vorgegeben wird, wird der Verzeichnis-Pfad zum Arbeitsverzeichnis aus dem Pfad zur Projektdatei ohne Dateierweiterung generiert. Zum Beispiel:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="rouge highlight"><code data-lang="bash"><span class="c"># Pfad zur Projektdatei</span>
/simulations/myScenario.msim

<span class="c"># Basisverzeichnis für Simulationsdaten und -ergebnisse</span>
/simulations/myScenario/...</code></pre>
</div>
</div>
<div class="paragraph">
<p>Im Abschnitt <a href="#working_directory_structure">Struktur und Inhalt des Arbeitsverzeichnis</a> wird der Inhalt und die Struktur des Arbeitsverzeichnisses erklärt.</p>
</div>
</div>
<div class="sect3">
<h4 id="_anpassung_der_ausgabedetailstufe">3.1.2. Anpassung der Ausgabedetailstufe</h4>
<div class="paragraph">
<p><em>MasterSimulator</em> schreibt Fortschrittsinformationen/Warnungen und Fehlermeldungen in das Konsolenfenster und in die Datei <code>&lt;working-dir&gt;/logs/screenlog.txt</code>. Die Menge an geschriebenem Text und die Detailstufe wird durch den <code>--verbosity-level</code> Parameter kontrolliert, welcher die Menge der erzeugten Fehler-/Analyseinformationen festlegt.</p>
</div>
<div class="paragraph">
<p>Bei der Detailstufe 0 (<code>--verbosity-level=0</code>) wird so ziemlich je Ausgabe abgeschaltet. Die Detailstufe 1 ist der Standard mit normalen Fortschrittsmeldungen. Nutzen Sie eine höhere Ausgabedetailstufe zur Analyse der integrierten Algorithmen oder zur Eingrenzung von Fehlern.</p>
</div>
<div class="admonitionblock note">
<table>
<tr>
<td class="icon">
<i class="fa icon-note" title="Note"></i>
</td>
<td class="content">
<div class="paragraph">
<p>Die Detailstufe der Protokolldatei ist während der Initialisierungsphase immer auf 3 gesetzt, um möglichst detaillierte FMU-Analyseausgaben in der Protokolldatei zu erhalten. Während der Simulation wird die Ausgabedetailstufe dann auf den Standardwert 1 zurückgesetzt, um eine Verlangsamung der Simulation aufgrund des exzessiven Ausgabeschreibens zu vermeiden. Falls der <code>--verbosity-level</code>-Befehlszeilenparameter angegeben ist, wird dieser Wert auch während der Simulation für die Protokolldatei verwendet.</p>
</div>
</td>
</tr>
</table>
</div>
</div>
<div class="sect3">
<h4 id="_spezielle_optionen_unter_windows">3.1.3. Spezielle Optionen unter Windows</h4>
<div class="paragraph">
<p>Normalerweise bleibt das Konsolenfenster (bei Windows) am Ende der Simulation offen. Man kann aber durch  Angabe des <code>-x</code> Befehlszeilenschalters das Fenster nach Ende der Simulation automatisch schließen lassen.</p>
</div>
</div>
</div>
<div class="sect2">
<h3 id="working_directory_structure">3.2. Struktur und Inhalt des Arbeitsverzeichnis</h3>
<div class="paragraph">
<p><em>MasterSim</em> erstellt eine Verzeichnisstruktur nach folgendem Schema. Angenommen es gibt eine Projekt-Datei <code>simProject.msim</code>, welche im Simulationsszenario zwei FMUs <code>part1.fmu</code> und <code>part2.fmu</code> verwendet. Diese werden innerhalb des Projekts jeweils als Simulations-Slaves <strong>P1</strong> und <strong>P2</strong> bezeichnet. Nehmen wir an, diese Dateien sind in einem Unterverzeichnis abgelegt:</p>
</div>
<div class="listingblock">
<div class="content">
<pre>/sim_projects/pro1/simProject.msim
/sim_projects/pro1/fmus/part1.fmu
/sim_projects/pro1/fmus/part2.fmu</pre>
</div>
</div>
<div class="paragraph">
<p>Bei Ausführung des Master-Simulators wird ein Arbeitsverzeichnis erstellt. Standardmäßig entspricht der Dateipfad zu diesem Arbeitsverzeichnis dem Projekt-Dateinamen ohne Dateierweiterung.</p>
</div>
<div class="paragraph">
<p>Die Verzeichnisstruktur sähe dann so aus:</p>
</div>
<div class="listingblock">
<div class="content">
<pre>/sim_projects/pro1/simProject/             - Arbeitsverzeichnis
/sim_projects/pro1/simProject/log/         - Logdateien und Statistiken
/sim_projects/pro1/simProject/fmus/        - Entpackte FMUs
/sim_projects/pro1/simProject/fmus/part1   - Entpackte part1.fmu
/sim_projects/pro1/simProject/fmus/part2   - Entpackte part2.fmu
/sim_projects/pro1/simProject/slaves/      - Ausgabe-/Arbeitsverzeichnis für FMU Slaves
/sim_projects/pro1/simProject/slaves/P1    - Ausgabe-/Arbeitsverzeichnis für Slave P1
/sim_projects/pro1/simProject/slaves/P2    - Ausgabe-/Arbeitsverzeichnis für Slave P2
/sim_projects/pro1/simProject/results/     - Ausgabeverzeichnis für Simulationsergebnisse</pre>
</div>
</div>
<div class="paragraph">
<p>Der Basisname des Verzeichnisses, hier <code>simProject</code>, kann durch Angabe das Befehlszeilenarguments <code>--working-directory</code> verändert werden.</p>
</div>
<div class="sect3">
<h4 id="_verzeichnis_log">3.2.1. Verzeichnis <code>log</code></h4>
<div class="paragraph">
<p>Dieses Verzeichnis beinhaltet 3 Dateien:</p>
</div>
<div class="hdlist">
<table>
<tr>
<td class="hdlist1">
<code>progress.txt</code>
</td>
<td class="hdlist2">
<p>beinhaltet den Simulations-Fortschritt (siehe Formatbeschreibung unten)</p>
</td>
</tr>
<tr>
<td class="hdlist1">
<code>screenlog.txt</code>
</td>
<td class="hdlist2">
<p>beinhaltet die Konsolenausgabe von <em>MasterSim</em>, welche in das Konsolenfenster mit der jeweils angeforderten Detailstufe geschrieben wurde (während der Initialisierung wird immer eine detaillierte Ausgabe an die Log-Datei geschrieben, selbst wenn die Bildschirmausgabe mit <code>--verbosity-level=0</code> deaktiviert wurde)</p>
</td>
</tr>
<tr>
<td class="hdlist1">
<code>summary.txt</code>
</td>
<td class="hdlist2">
<p>nachdem die Simulation <em>erfolgreich</em> vollendet ist, beinhaltet diese Datei eine Zusammenfassung der relevanten Lösungs- und Algorithmusstatistiken.</p>
</td>
</tr>
</table>
</div>
<div class="paragraph">
<p>Das Format der Datei <code>progress.txt</code> ist recht simpel:</p>
</div>
<div class="listingblock">
<div class="content">
<pre>   Simtime [s] 	   Realtime [s]	 Percentage [%]
            600	       0.000205	         0.0019
           1200	        0.00023	         0.0038
           1800	       0.000251	         0.0057
           2400	       0.000271	         0.0076
            ...             ...             ...</pre>
</div>
</div>
<div class="paragraph">
<p>Die Datei besitzt 3 Spalten, getrennt durch ein Tabulatorzeichen. Die Datei wird bei laufender Simulation geschrieben und aktualisiert und kann von anderen Werkzeugen genutzt werden, um den Gesamtfortschritt aufzugreifen und Fortschrittsdiagramme zu erzeugen. (Geschwindigkeit/Prozentsatz etc.)</p>
</div>
<div class="paragraph">
<p>Die Bedeutung der verschiedenen Werte im <code>summary.txt</code> werden im Abschnitt <a href="#summary_txt_file">Simulations-Statistik/Zusammenfassung</a> erklärt.</p>
</div>
</div>
<div class="sect3">
<h4 id="_verzeichnis_fmus">3.2.2. Verzeichnis <code>fmus</code></h4>
<div class="paragraph">
<p>Innerhalb dieses Verzeichnis werden die importierten FMUs extrahiert, jedes in ein Unterverzeichnis mit dem Basisdatei der FMU (<code>part1.fmu</code> &#8594; <code>part1</code>).</p>
</div>
<div class="paragraph">
<p>Wenn ein <em>MasterSim</em>-Projekt auf verschiedene FMUs desselben Basisnamen Bezug nimmt, welche zum Beispiel in verschiedenen Unterverzeichnissen stehen, wird es den Pfadnamen anpassen. Beispiel:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="rouge highlight"><code data-lang="python"><span class="n">slave1</span> <span class="p">:</span> <span class="o">/</span><span class="n">path</span><span class="o">/</span><span class="n">to</span><span class="o">/</span><span class="n">fmus</span><span class="o">/</span><span class="n">s1</span><span class="o">.</span><span class="n">fmu</span>
<span class="n">slave2</span> <span class="p">:</span> <span class="o">/</span><span class="n">path</span><span class="o">/</span><span class="n">to</span><span class="o">/</span><span class="n">fmus</span><span class="o">/</span><span class="n">s1</span><span class="o">.</span><span class="n">fmu</span>                <i class="conum" data-value="1"></i><b>(1)</b>
<span class="n">slave3</span> <span class="p">:</span> <span class="o">/</span><span class="n">path</span><span class="o">/</span><span class="n">other</span><span class="o">/</span><span class="n">project</span><span class="o">/</span><span class="n">fmus</span><span class="o">/</span><span class="n">s1</span><span class="o">.</span><span class="n">fmu</span>     <i class="conum" data-value="2"></i><b>(2)</b>

<span class="c1"># von _MasterSim_ erzeugte Verzeichnisse
</span><span class="o">.../</span><span class="n">fmus</span><span class="o">/</span><span class="n">s1</span>
<span class="o">.../</span><span class="n">fmus</span><span class="o">/</span><span class="n">s1_2</span>                                <i class="conum" data-value="3"></i><b>(3)</b></code></pre>
</div>
</div>
<div class="colist arabic">
<table>
<tr>
<td><i class="conum" data-value="1"></i><b>1</b></td>
<td>zweite Instanz der gleichen FMU (wird nur einmal entpackt)</td>
</tr>
<tr>
<td><i class="conum" data-value="2"></i><b>2</b></td>
<td>andere FMU mit gleichem Basisnamen</td>
</tr>
<tr>
<td><i class="conum" data-value="3"></i><b>3</b></td>
<td>Suffix <code>_2</code> (bzw. <code>_3</code> etc.) wird durch <em>MasterSim</em> angehängt</td>
</tr>
</table>
</div>
<div class="paragraph">
<p>Grundsätzlich wird jede FMU-Datei nur einmal entpackt.</p>
</div>
<div class="admonitionblock tip">
<table>
<tr>
<td class="icon">
<i class="fa icon-tip" title="Tip"></i>
</td>
<td class="content">
<div class="paragraph">
<div class="title">Überspringen des FMU-Extraktions-Schritts</div>
<p><em>MasterSim</em> unterstützt die Befehlszeilen-Option <code>--skip-unzip</code>, welche sehr nützlich ist, um FMUs durch Korrektur einer fehlerhaften <code>modelDescription.xml</code>-Datei oder fehlender Ressourcen zu reparieren. Wenn solch eine FMU auftaucht, können Sie <em>MasterSimulater</em> einmal durchlaufen lassen, um die FMUs in die Verzeichnisse zu extrahieren. Dann kann man die fehlerhaften Dateien im jeweiligen Entpack-Verzeichnis überarbeiten/anpassen und danach die Simulation noch einmal mit <code>--skip-unzip</code> durchlaufen lassen. <em>MasterSim</em> wird nun die (veränderten) Dateien direkt lesen und Sie können sich selbst die Mühe des Komprimierens und Umbenennens der FMUs sparen. Ebenso können Sie die <code>modelDescription.xml</code> im Editor geöffnet lassen und die wiederholte "Bearbeiten-und-Testsimulieren"-Prozedur schnell durchlaufen, bis alles funktioniert.</p>
</div>
<div class="paragraph">
<p>Siehe auch Erläuterungen im Abschnitt <a href="#skip_FMU_extraction">Einfache Veränderung/Reparatur von fehlerhaften FMUs</a>.</p>
</div>
</td>
</tr>
</table>
</div>
</div>
<div class="sect3">
<h4 id="dir_slaves">3.2.3. Verzeichnis <code>Slaves</code></h4>
<div class="paragraph">
<p>Oft schreiben nicht-triviale Simulations-Slaves ihre eigenen Ausgabedateien, anstatt die gesamten Ausgabedaten per FMU-Ausgabevariablen zum Master zu verschieben. Bei FMUs, in denen partielle Differentialgleichungen gelöst werden, und Feldausgaben mit mehreren tausenden Datenpunkten je Zeitschritt erzeugt werden, wäre dies auch nicht sinnvoll (oder effizient). Für das Schreiben derartiger Ausgaben bräuchte die FMU einen Zielpfad, in den die FMU schreiben darf.</p>
</div>
<div class="paragraph">
<p>Da eine FMU mehrere Male instanziiert werden kann (d.h. mehrere Slaves werden aus der gleichen FMU-Datei erzeugt), ist die feste Programmierung eines Ausgabepfads innerhalb der FMU im Allgemeinen keine gute Idee (obgleich gegenwärtig noch immer häufige Praxis). Die Ausgaben der unterschiedlichen Slaves würden sich sonst gegenseitig überschreiben.</p>
</div>
<div class="paragraph">
<p>Ausgaben ins gegenwärtige Arbeitsverzeichnis zu schreiben ist ebenso ungeschickt, da das Arbeitsverzeichnis zwischen den Aufrufen der FMUs eventuell durch den Master geändert werden muss. Dadurch sollte der Zugriff auf das Arbeitsverzeichnis am besten vermieden werden.</p>
</div>
<div class="paragraph">
<p>Leider unterstützt der FMU-Standard keine Option, einem Slave ein gültiges Ergebnis-/Arbeitsverzeichnis zu übergeben. <em>MasterSim</em> behebt das Problem, indem es Slave-spezifische Verzeichnispfade in einem Parameter, genannt <code>ResultsRootDir</code>, angibt. Dazu braucht die FMU lediglich diesen Zeichenketten-Parameter zu deklarieren. Man kann in <em>MasterSim</em> den Wert dieses Parameters natürlich wie bei allen anderen Parametern manuell festlegen.
Wenn allerdings kein Wert in der Projekt-Datei für diesen Parameter festgelegt ist, wird <em>MasterSim</em> den für den Slave erzeugten Pfad im Arbeitsverzeichnis eintragen. Die FMU kann den von <em>MasterSim</em> erzeugten Slave-spezifischen Pfad nutzen und Ausgaben oder andere Daten dort hinein schreiben.</p>
</div>
<div class="admonitionblock tip">
<table>
<tr>
<td class="icon">
<i class="fa icon-tip" title="Tip"></i>
</td>
<td class="content">
<div class="paragraph">
<p>Das Analysetool <em>PostProc</em> wird bei Angabe des Projektbasisverzeichnis auch die Ausgaben in den Slave-Verzeichnissen finden und zur Analyse anzeigen.</p>
</div>
</td>
</tr>
</table>
</div>
</div>
</div>
<div class="sect2">
<h3 id="_return_code_des_mastersimulator_programms">3.3. Return-Code des <em>MasterSimulator</em> -Programms</h3>
<div class="paragraph">
<p><em>MasterSimulator</em> gibt folgende Return-Code zurück:</p>
</div>
<div class="hdlist">
<table>
<tr>
<td class="hdlist1">
0
</td>
<td class="hdlist2">
<p>bei Erfolg</p>
</td>
</tr>
<tr>
<td class="hdlist1">
1
</td>
<td class="hdlist2">
<p>wenn ein Fehler aufgetreten ist (alle Ursachen, von schlechten oder fehlenden FMUs, oder Fehlern während der Berechnung,&#8230;&#8203;), die Datei  <code>screenlog.txt</code> beinhaltet Details.</p>
</td>
</tr>
</table>
</div>
</div>
<div class="sect2">
<h3 id="simulation_outputs">3.4. Simulationsausgaben</h3>
<div class="sect3">
<h4 id="_slave_ausgabewerte">3.4.1. Slave-Ausgabewerte</h4>
<div class="paragraph">
<p><em>MasterSim</em> erstellt zwei Ergebnisdateien innerhalb des <code>results</code>-Unterverzeichnis:</p>
</div>
<div class="hdlist">
<table>
<tr>
<td class="hdlist1">
<code>values.csv</code>
</td>
<td class="hdlist2">
<p>Ausgabe aller Ausgabevariablen vom Typ Zahl (einschließlich Booleans) von allen Slaves (egal, ob sie verbunden sind oder nicht).</p>
</td>
</tr>
<tr>
<td class="hdlist1">
<code>strings.csv</code>
</td>
<td class="hdlist2">
<p>Werte aller Ausgabevariablen vom Typ Zeichenketter aller Slaves.</p>
</td>
</tr>
</table>
</div>
<div class="paragraph">
<p>Abhängig davon, ob <em>synonyme Variablen</em> in der ModelDescription (siehe unten) definiert sind, die Datei <code>synonymous_variables.txt</code>.</p>
</div>
<div class="paragraph">
<p>Zeichenketten-Ausgabe-Dateien werden nur erzeugt, wenn tatsächlich Ausgaben dieses Datentyps von Slaves erzeugt werden.</p>
</div>
</div>
<div class="sect3">
<h4 id="_dateiformat_der_ergebnisdateien">3.4.2. Dateiformat der Ergebnisdateien</h4>
<div class="paragraph">
<p>Die Ergebnisdateien haben die Erweiterung <code>csv</code>, nutzen aber Tabulatorzeichen als Trennzeichen. In der ersten Spalte steht immer der Zeitpunkt. Im Spaltenkopf jeder Spalte kann in [] die Zeiteinheit angegeben werden.</p>
</div>
<div class="paragraph">
<p>Beispiel <code>values.csv</code>-Datei:</p>
</div>
<div class="listingblock">
<div class="content">
<pre>Time [s] 	slave1.h [-] 	slave1.v [-]
0	1	0
0.001	0.999995099905	-0.0098100000000001
0.0019999999999999	0.99998038981	-0.019619999999999
0.0030000000000001	0.999955869715	-0.029430000000002
0.0040000000000002	0.99992153962	-0.039240000000001</pre>
</div>
</div>
<div class="paragraph">
<p>Das Dateiformat entspricht dem der csv-Dateien, die als Datei-Lese-Slaves genutzt werden, siehe Abschnitt <a href="#csv_filereader_slaves">CSV-Datei-Lese-Slaves</a>, mit:</p>
</div>
<div class="ulist">
<ul>
<li>
<p>durch Tabulatoren getrennte Spalten,</p>
</li>
<li>
<p>Nummern sind im englischen Nummernformat geschrieben, und</p>
</li>
<li>
<p>eine einzelne Überschrift bestimmt die Variablen.</p>
</li>
</ul>
</div>
<div class="paragraph">
<p>Den FMI- Variablennamen sind die entsprechenden Slave-Namen vorangestellt. Die Einheiten sind in Klammern angegeben und für einheitslose ganzzahlige und boolesche Datentypen, wird die Einheit [-] genutzt.</p>
</div>
<div class="admonitionblock note">
<table>
<tr>
<td class="icon">
<i class="fa icon-note" title="Note"></i>
</td>
<td class="content">
<div class="paragraph">
<p>Vektorwertige Variablen, z.B. mit Namen "var[12]" werden immer einheitenlos geschrieben, sodass das <em>PostProc</em> Programm erkennt, dass es sich bei [12] nicht um eine Einheit handelt.</p>
</div>
</td>
</tr>
</table>
</div>
<div class="sect4">
<h5 id="_synonyme_variablen">Synonyme Variablen</h5>
<div class="paragraph">
<p>Einige  FMUs, z.B. solche, die von Modelica Modellen erstellt wurden, können verschiedene (interne) Variblen aufweisen, welche den selben Wert referenzieren. Das passiert, wenn die symbolische Analyse des Modelica Modells diese Variablen als die selben erkennen konnte, z.B. bei einer Gleichung "a = b", wird eine FMU sicher intern nur eine Variable halten, aber gegebenenfalls bei Variablen getrennt als Ausgaben anbieten. Beide Variablen hätten in der <code>modelDescription.xml</code>-Datei die gleiche <code>valueReference</code> (Wertereferenz).</p>
</div>
<div class="paragraph">
<p>In diesem Fall schreibt <em>MasterSim</em> die Ausgabevariablen nicht doppelt (dies wäre eine Verschwendung von Festplattenkapazitäten und Simulationszeit, siehe Ticket #47), sondern erstellt eine Datei <code>synonymous_variables.txt</code> mit einer Tabelle synonymer Variablen.</p>
</div>
<div class="paragraph">
<p>Die Tabelle wird als einfache Textdatei geschrieben mit durch Tabulatoren getrennte Spalten:</p>
</div>
<div class="olist arabic">
<ol class="arabic">
<li>
<p>FMU-Dateiname (gegenwärtig wird nur der Dateiname geschrieben - im Fall, dass der <em>gleiche Dateiname</em> mit <em>unterschiedlichen Dateipfaden</em> genutzt wird, muss dies geändert werden)</p>
</li>
<li>
<p>der Name der Variablen, erscheint in der <code>values.csv</code>-Datei</p>
</li>
<li>
<p>die synonyme Variable, die nicht in die Ausgabedatei geschrieben wird, da sie ohnehin den gleichen Wert hat.</p>
</li>
</ol>
</div>
<div class="paragraph">
<p>Ein Beispiel für eine <code>synonymous_variables.txt</code>-Datei:</p>
</div>
<div class="listingblock">
<div class="content">
<pre>ControlledTemperature.fmu	heatCapacitor.T	heatCapacitor.port.T
ControlledTemperature.fmu	heatCapacitor.T	heatingResistor.T_heatPort
ControlledTemperature.fmu	heatCapacitor.T	heatingResistor.heatPort.T
ControlledTemperature.fmu	heatCapacitor.T	temperatureSensor.port.T
ControlledTemperature.fmu	heatCapacitor.T	thermalConductor.port_a.T
ControlledTemperature.fmu	heatingResistor.p.v	heatingResistor.v
ControlledTemperature.fmu	heatingResistor.p.v	idealSwitch.n.v
ControlledTemperature.fmu	constantVoltage.i	constantVoltage.n.i
ControlledTemperature.fmu	constantVoltage.i	constantVoltage.p.i
ControlledTemperature.fmu	constantVoltage.i	heatingResistor.i
ControlledTemperature.fmu	constantVoltage.i	heatingResistor.n.i
ControlledTemperature.fmu	constantVoltage.i	heatingResistor.p.i
ControlledTemperature.fmu	constantVoltage.i	idealSwitch.i
ControlledTemperature.fmu	constantVoltage.i	idealSwitch.n.i
ControlledTemperature.fmu	constantVoltage.i	idealSwitch.p.i
ControlledTemperature.fmu	heatingResistor.LossPower	heatingResistor.heatPort.Q_flow
ControlledTemperature.fmu	fixedTemperature.port.Q_flow	thermalConductor.Q_flow
ControlledTemperature.fmu	fixedTemperature.port.Q_flow	thermalConductor.port_a.Q_flow
ControlledTemperature.fmu	fixedTemperature.port.Q_flow	thermalConductor.port_b.Q_flow
ControlledTemperature.fmu	onOffController.reference	ramp.y
ControlledTemperature.fmu	onOffController.u	temperatureSensor.T
ControlledTemperature.fmu	idealSwitch.control	logicalNot.y
ControlledTemperature.fmu	logicalNot.u	onOffController.y</pre>
</div>
</div>
<div class="paragraph">
<p>Aus dieser Datei wird ersichtlich, dass die Variablen <code>heatCapacitor.T</code>, <code>heatCapacitor.port.T</code>, <code>heatingResistor.T_heatPort</code>, <code>heatingResistor.heatPort.T</code>, <code>temperatureSensor.port.T</code> und <code>thermalConductor.port_a.T</code> alle den gleichen Wert haben und damit die Variablennamen Synonyme sind.</p>
</div>
</div>
</div>
<div class="sect3">
<h4 id="summary_txt_file">3.4.3. Simulations-Statistik/Zusammenfassung</h4>
<div class="paragraph">
<p><em>MasterSim</em> beinhaltet eine interne Zeitmessfunktion, welche die Ausführungszeiten der verschiedenen Teile der Software überwachen. Ebenso werden Ausführungshäufigkeiten für verschiedene wichtige Funktionen gezeigt.
Die Statistik wird ins Konsolenfenster (bei <code>verbosity-level</code> &gt; 0) und in die Log-Datei <code>screenlog.txt</code>  geschrieben. Dabei wird folgendes Format verwendet (die unteren Zeilen beginnend ab "Part1" sind projektspezifisch).</p>
</div>
<div class="listingblock">
<div class="content">
<pre>Solver statistics
------------------------------------------------------------------------------
Wall clock time                            =   78.044 ms
------------------------------------------------------------------------------
Output writing                             =   76.767 ms
Master-Algorithm                           =    0.666 ms         324
Convergence failures                       =                      41
Convergence iteration limit exceeded       =                      41
Error test time and failure count          =    0.214 ms          85
------------------------------------------------------------------------------
Part1                               doStep =    0.101 ms        1229
                                  getState =    0.070 ms        1116
                                  setState =    0.020 ms         509
Part2                               doStep =    0.079 ms        1496
                                  getState =    0.039 ms        1116
                                  setState =    0.024 ms         776
Part3                               doStep =    0.071 ms        1496
                                  getState =    0.038 ms        1116
                                  setState =    0.040 ms         776
------------------------------------------------------------------------------</pre>
</div>
</div>
<div class="paragraph">
<p>Die selben Statistikdaten werden in die <code>summary.txt</code>-Logsdatei kopiert, dabei aber in ein eher <em>maschinenfreundliches</em> Format (mit Zeitangaben immer in <strong>Sekunden</strong> bzw. der jeweils verwendeten Master-Zeiteinheit):</p>
</div>
<div class="listingblock">
<div class="content">
<pre>WallClockTime=0.078044
FrameworkTimeWriteOutputs=0.076767
MasterAlgorithmSteps=324
MasterAlgorithmTime=0.000666
ConvergenceFails=41
ConvergenceIterLimitExceeded=41
ErrorTestFails=85
ErrorTestTime=0.000214
Slave[1]Time=0.000191
Slave[2]Time=0.000142
Slave[3]Time=0.000149</pre>
</div>
</div>
<div class="paragraph">
<p>Die Werte bedeuten im Einzelnen:</p>
</div>
<div class="dlist">
<dl>
<dt class="hdlist1">Wall clock time (<code>WallClockTime</code>)</dt>
<dd>
<p>gesamte Simulationszeit, die nach Abschluss der Initialisierung benötigt wurde. Die Dauer für Entpacken und Laden der Laufzeitbibliotheken wird nicht einbezogen</p>
</dd>
<dt class="hdlist1">Output writing (<code>FrameworkTimeWriteOutputs</code>)</dt>
<dd>
<p>Zeit, die für das Schreiben von Ausgabedateien und das Berechnen damit zusammenhängender Werte gebraucht wurde.</p>
</dd>
<dt class="hdlist1">Master-Algorithm</dt>
<dd>
<p>Zeit, die für den eigentlichen Master-Algorithmus (<code>MasterAlgorithmTime</code>) und die Anzahl der Aufrufe des Algorithmus und die gesamten genutzten Zeitschritte aufgewendet wurde (<code>MasterAlgorithmSteps</code>).</p>
</dd>
<dt class="hdlist1">Convergence failures (<code>ConvergenceFails</code>)</dt>
<dd>
<p>Anzahl der Konvergenzfehler bei iterativen Master-Algorithmen.</p>
</dd>
<dt class="hdlist1">Convergence iteration limit exceeded (<code>ConvergenceIterLimitExceeded</code>)</dt>
<dd>
<p>Anzahl der Überschreitungen der maximalen Iterationszahl in iterierenden Master-Algorithmen (diese Zahl sollte kleiner oder gleich der Anzahl der Konvergenzfehler sein).</p>
</dd>
<dt class="hdlist1">Error test time and failure count</dt>
<dd>
<p>Anzahl der Fehlertest-Überschreitungen (<code>ErrorTestFails</code>) und die insgesamt genutzte Zeit, um die Fehlertests durchzuführen (<code>ErrorTestTime</code>). Dies schließt die Zeit ein, die für das Speichern und Zurücksetzen des FMU-Zustands und für die zusätzlichen Kommunikationsschritte benötigt wurde. Dies gilt nur für Master-Algorithmen mit aktivierter Fehlerkontrolle (Richardson-Varianten).</p>
</dd>
</dl>
</div>
<div class="paragraph">
<p>Die übrigen Zeilen zeigen Dauer und Aufrufhäufigkeiten individuell für jeden Slave. Die Zeilen zeigen die genutzte Zeit in den Funktionsaufrufen <code>doStep()</code>, <code>getState()</code> und <code>setState()</code> und die jeweilige Häufigkeit des Aufrufs. Die den Zustand betreffenden Funktionen (state) werden nur für iterierende Master-Algorithmen genutzt, falls die FMUs diese FMI 2 Funktionalität unterstützt. Es ist zu beachten, dass diese Funktionen sowohl vom Master-Algorithmus als auch vom Fehlertest aufgerufen werden (wenn eingeschaltet).</p>
</div>
<div class="paragraph">
<p>Das Schreiben von Ausgaben (<strong>Output writing</strong>) und Ausführen des Master-Algorithmus (<strong>Master-Algorithm</strong>) sind die beiden Hauptkomponenten des <em>MasterSimulator</em>-Pogramms, sodass ihre addierten Zeiten nahe der Gesamtlaufzeit liegen sollten.</p>
</div>
<div class="paragraph">
<p>Die dritte Spalte in der Konsolen-Ausgabe-Statistik beinhaltet Zähler. Der Zähler für den Master-Algorithmus ist die Gesamtzahl der Ausführungen des Master-Algorithmus, also die Gesamtschrittzahl bzw. Gesamtzahl an <em>erfolgreich</em> absolvierten Kommunikationsintervallen. Neuversuche und Wiederholungen <em>innerhalb</em> des Master-Algorithmus werden hier nicht beachtet.</p>
</div>
<div class="admonitionblock tip">
<table>
<tr>
<td class="icon">
<i class="fa icon-tip" title="Tip"></i>
</td>
<td class="content">
<div class="paragraph">
<p>Sie sollten diese Profilierungswerte nutzen, um die Simulation abzustimmen und, im Fall einer sehr langsamen Simulation, herauszufinden, welche FMU die meiste Zeit benötigt. Diese kann man dann gezielt optimieren. Ebenso helfen sie zu erkennen, ob eine der eigentlich schnellen Funktionen, wie die zum Lesen und Rücksetzen des FMU-Zustands, ungewöhnlich lange braucht (beispielsweise, wenn FMU-Intern übermäßig lange Zeit für die  Neuinitialisierung benötigt wird).</p>
</div>
</td>
</tr>
</table>
</div>
</div>
</div>
</div>
</div>
<div class="sect1">
<h2 id="project_file_format">4. Format der Projekt-Datei</h2>
<div class="sectionbody">
<div class="paragraph">
<p><em>MasterSim</em> benutzt eine einfache Projekt-Datei, welche das Simulations-Szenario beschreibt. Diese Projekt-Datei besitzt die Erweiterung <code>msim</code> und beinhaltet alle Daten, um eine Simulation durchzuführen.</p>
</div>
<div class="paragraph">
<p>Eine zweite Datei mit demselben Namen und der Erweiterung <code>bm</code> wird im gleichen Verzeichnis wie die Projekt-Datei gespeichert. Diese beinhaltet die grafische Darstellung des Simulations-Szenarios. Da die grafische Netzwerkanzeige <em>rein optional</em> ist, kann die <code>bm</code>-Datei beliebig weggelassen/ignoriert/gelöscht werden.</p>
</div>
<div class="admonitionblock note">
<table>
<tr>
<td class="icon">
<i class="fa icon-note" title="Note"></i>
</td>
<td class="content">
<div class="title">SSP-Unterstützung</div>
<div class="paragraph">
<p>Derzeit ist die Forschung im Modelica Association Project SSP (<a href="https://modelica.org/projects">System Structure and Parameterization of Components for Virtual System Design</a>) in vollem Gang, um einen Standard für das Darstellen eines Simulations-Szenarios festzulegen. Wenn die Spezifizierungen rechtzeitig  hinreichend abgeschlossen sind, kann der Master-Simulator diesen Datei-Standard vielleicht unterstützen, zumindest den Import und Export solcher Dateien. Tatsächlich fügt eine solche Datei die Beschreibung der räumlichen Struktur der FMU-Verbindung und ihrer (nach wie vor optionalen) grafischen Darstellung in einer Datei zusammen. Allerdings ist dieses Datei-Format, ähnlich den FMUs, eigentlich eine Zip-komprimierte Verzeichnisstruktur, wodurch SSP-Projekt-Dateien vielleicht nicht länger effektiv in Versionskontrollsystemen genutzt werden können. Hier ist das ASCII-Format der aktuellen <code>msim</code>- und <code>bm</code>-Dateien gut geeignet und nützlich.</p>
</div>
</td>
</tr>
</table>
</div>
<div class="paragraph">
<p>Die Projektdatei wird im Klartext (ASCII,UTF8-kodiert) abgelegt und hat beispielsweise folgenden Inhalt:</p>
</div>
<div class="exampleblock">
<div class="title">Beispiel 2. MasterSim-Projektdatei</div>
<div class="content">
<div class="listingblock">
<div class="content">
<pre># Created:	Di. Aug. 14 17:02:20 2018
# LastModified:	Di. Aug. 14 17:02:20 2018

# Project file example for iterating GaussSeidel with time step adjustment
#
# No error test included, time step adjustment based on convergence failures.
tStart                   0 s
tEnd                     12 s
hMax                     30 min
hMin                     1e-06 s
hFallBackLimit           0.001 s
hStart                   1e-07 s
hOutputMin               0.12 s
adjustStepSize           no
preventOversteppingOfEndTime yes
absTol                   1e-06
relTol                   0.01
MasterMode               GAUSS_JACOBI
ErrorControlMode         NONE
maxIterations            1
writeInternalVariables   yes

simulator 0 0 Part1 #ff447cb4 "fmus/simx/Part1.fmu"
simulator 1 1 Part2 #ffc38200 "fmus/simx/Part2.fmu"
simulator 2 1 Part3 #ffff0000 "fmus/simx/Part3.fmu"

graph Part1.x2 Part2.x2
graph Part1.x1 Part2.x1
graph Part2.x3 Part3.x3
graph Part3.x4 Part2.x4

parameters Part1.para1  14.3</pre>
</div>
</div>
</div>
</div>
<div class="paragraph">
<p>Jede Zeile legt eine andere Eigenschaft fest. Die Wortbausteiner jeder Zeile sind durch Leerräume (Tabulatoren oder Leerzeichen) voneinander getrennt. Die Zeilen, die mit einem Rautezeichen # beginnen, werden als Kommentare interpretiert.</p>
</div>
<div class="admonitionblock important">
<table>
<tr>
<td class="icon">
<i class="fa icon-important" title="Important"></i>
</td>
<td class="content">
<div class="paragraph">
<p>Auf allen Betriebssystemen werden Zeichenketten (auch Pfade) UTF-8-kodiert erwartet. Unter Windows und auf dem Mac muss das beim Bearbeiten/Erstellen von Projektdateien mit dem Texteditor berücksichtigt werden.</p>
</div>
</td>
</tr>
</table>
</div>
<div class="paragraph">
<p>Alle Kommentarzeilen vor der ersten Nicht-Kommentarzeile werden als Kopfzeilen mit Projektinformationen interpretiert. Auf die Stichworte <code>Created:</code> und <code>LastModified:</code> sollte ein mehr oder weniger sinnvoller (aber nicht standardisierter) Datums-/Zeitstempel folgen, der in der Benutzeroberfläche gezeigt wird. Andere Kopfzeilen werden als Projektbeschreibung betrachtet, welche in der Projektzusammenfassung auf der Startseite der grafischen Benutzeroberfläche gezeigt werden (siehe <a href="#screenshot_project_properties">Abbildung 12</a>).</p>
</div>
<div id="screenshot_project_properties" class="imageblock">
<div class="content">
<img src="../images/welcome_page_project_properties.png" alt="welcome page project properties">
</div>
<div class="title">Abbildung 12. Auf der Startseite angezeigte Projekteigenschaften</div>
</div>
<div class="admonitionblock note">
<table>
<tr>
<td class="icon">
<i class="fa icon-note" title="Note"></i>
</td>
<td class="content">
<div class="paragraph">
<p>Nach der Kopfzeile mit der Beschreibung ist die Ordnung der Einträge/Zeilen willkürlich. Es ist aber übersichtlich, die oben gezeigte Ordnung der Parametrisierung beizubehalten (welche von der <em>MasterSim</em> Programmoberfläche auch so geschrieben wird).</p>
</div>
</td>
</tr>
</table>
</div>
<div class="sect2">
<h3 id="simulator_settings">4.1. Einstellungen für die Simulation</h3>
<div class="paragraph">
<p>Nachfolgend gibt es eine kurze Beschreibung der verschiedenen Parameter mit einer Formatsbeschreibung und den benötigten Werten. Für Details über ihren Gebrauch und welchen Einfluss sie haben, siehe Abschnitt <a href="#master_algorithms">Master-Algorithmen</a>.</p>
</div>
<div class="paragraph">
<p>Parameter werden als mit einer Einheit versehenen Zahl angegeben, abgesehen von die Zählern (Maximum an Wiederholungen) oder relativen Fehlerschranken (welche sowieso ohne Einheit angegeben werden).</p>
</div>
<div class="paragraph">
<p>Optionen, die Kommunikationsschritte/Zeitschritte betreffend:</p>
</div>
<div class="hdlist">
<table>
<tr>
<td class="hdlist1">
tStart
</td>
<td class="hdlist2">
<p>(<em>default=0 s</em>) Startzeitpunkt der Simulation</p>
</td>
</tr>
<tr>
<td class="hdlist1">
tEnd
</td>
<td class="hdlist2">
<p>(<em>default=1 a</em>) Endzeitpunkt der Simulation, muss &gt; <strong>tStart</strong> sein</p>
</td>
</tr>
<tr>
<td class="hdlist1">
hMax
</td>
<td class="hdlist2">
<p>(<em>default=30 min</em>) maximale Zeitschritt-Länge</p>
</td>
</tr>
<tr>
<td class="hdlist1">
hMin
</td>
<td class="hdlist2">
<p>(<em>default=1e-5 s</em>) untere Grenze für Zeitschritte, wenn Zeitschritt-Anpassung eingeschaltet ist. Falls der  Zeitschritt unter diese Grenze fällt, beendet der Master die Simulation mit einer Fehlermeldung</p>
</td>
</tr>
<tr>
<td class="hdlist1">
hFallBackLimit
</td>
<td class="hdlist2">
<p>(<em>default=1e-3 s</em>) für einen Gauss-Seidel-Algorithmus mit Zeitschritt-Anpassung: wenn die Zeitschritte unter diese Grenze fallen, wird der nicht-iterierende Gauss-Seidel genutzt (um diskontinuierliche Variablenänderungen zu überspringen), sollte &gt; <strong>hMin</strong> sein</p>
</td>
</tr>
<tr>
<td class="hdlist1">
hStart
</td>
<td class="hdlist2">
<p>(<em>default=10 min</em>) anfänglicher Zeitschritt, wird auch als konstante Schrittgröße verwendet, wenn Zeitschritt-Anpassung abgeschaltet ist</p>
</td>
</tr>
</table>
</div>
<div class="admonitionblock tip">
<table>
<tr>
<td class="icon">
<i class="fa icon-tip" title="Tip"></i>
</td>
<td class="content">
<div class="paragraph">
<p>Falls <strong>hStart</strong> in der Projekt-Datei auf 0 gesetzt ist, wird der Master automatisch <strong>hStart</strong> auf 1/1000 der Simulationsdauer festlegen, wobei die Simulationsdauer durch <strong>tEnd - tStart</strong> festgelegt ist.</p>
</div>
</td>
</tr>
</table>
</div>
<div class="dlist">
<dl>
<dt class="hdlist1">hOutputMin</dt>
<dd>
<p>(<em>default=10 min</em>) minimale Zeitspanne die verstreichen muss, bevor das nächste Mal Ausgaben geschrieben werden. Wenn die Kommunikationsschrittlänge größer als <strong>hOutputMin</strong> wird, werden einige Ausgabezeitpunkte eventuell übersprungen, aber das reguläre Ausgaberaster bleibt erhalten.</p>
</dd>
<dt class="hdlist1">outputTimeUnit</dt>
<dd>
<p>(<em>default=s</em>) Der Wert, der für die Zeitspalte (die erste Spalte) der Ausgabedateien genutzt wird.</p>
</dd>
<dt class="hdlist1">adjustStepSize</dt>
<dd>
<p>(<em>default=false</em>) aktiviert/deaktiviert die Zeitschritt-Anpassung, wenn der Fehlerkontroll-Modus <strong>ADAPT_STEP</strong> ist, wird das Deaktivieren von <strong>adjustStepSize</strong> als Fehler gemeldet.</p>
</dd>
<dt class="hdlist1">preventOversteppingOfEndTime</dt>
<dd>
<p>Diese Schalter wird für bestimmte FMUs gebraucht, welche einen Test gegen das Überschreiten der Simulationsendzeit enthalten. Dies ist in manchen Fällen mit Zeitreihen-Parameteren verbunden, die nur bis zum exakten Ende der Simulationszeit dauern. Ein anderes Problem ist, dass sich Rundungsfehler aufsummieren können und zu einer sehr kleinen Überschreitung des Endzeitpunktes führen können. Sich gut-verhaltende FMUs sollte zwar ein solches Überschreiten angemessen behandeln, es gibt jedoch auch FMUs, welche hier mit einer Fehlermeldung abbrechen. Um einen solchen FMU-Fehler und einen Simulationsabbruch zu vermeiden, kann <em>MasterSim</em> das letzte Kommunikationsintervall so anpassen, dass exakt die angegebene Endzeit der Simulation an das FMU übermittelt wird. Wenn dieser Schalter aktiviert ist, muss möglicherweise die letzte Intervallschritt-Größe verändert werden, selbst wenn eine Zeitschritt-Anpassung generell durch einen deaktivierten <strong>adjustStepSize</strong> Schalter verboten ist.</p>
</dd>
</dl>
</div>
<div class="paragraph">
<p><strong>MasterMode</strong> (<em>default=GAUSS_SEIDEL</em>) ist einer von:</p>
</div>
<div class="hdlist">
<table>
<tr>
<td class="hdlist1">
GAUSS_JACOBI
</td>
<td class="hdlist2">
<p>Gauss-Jacobi-Algorithmus (nicht iterierend)</p>
</td>
</tr>
<tr>
<td class="hdlist1">
GAUSS_SEIDEL
</td>
<td class="hdlist2">
<p>Gauss-Seidel-Algorithmus (iterierend oder nicht iterierend, abhängig von <strong>maxIterations</strong>)</p>
</td>
</tr>
<tr>
<td class="hdlist1">
NEWTON
</td>
<td class="hdlist2">
<p>Newton-Algorithmus mit einer Differenz-Quotient-Approximation der Jacobi-Matrix</p>
</td>
</tr>
</table>
</div>
<div class="paragraph">
<p>Iterations- und Konvergenzparameter:</p>
</div>
<div class="hdlist">
<table>
<tr>
<td class="hdlist1">
maxIterations
</td>
<td class="hdlist2">
<p>(<em>default=1=disabled</em>) max. Anzahl an Iterationen, wenn == 1 wird keine Iteration ausgeführt</p>
</td>
</tr>
<tr>
<td class="hdlist1">
absTol
</td>
<td class="hdlist2">
<p>(<em>default=1e-5</em>) absolute Toleranz für den Konvergenz-/Fehlertest</p>
</td>
</tr>
<tr>
<td class="hdlist1">
relTol
</td>
<td class="hdlist2">
<p>(<em>default=1e-6</em>) relative Toleranz für den Konvergenz-/Fehlertest</p>
</td>
</tr>
</table>
</div>
<div class="paragraph">
<p><strong>ErrorControlMode</strong> (<em>default=NONE=disabled</em>) ist einer von:</p>
</div>
<div class="hdlist">
<table>
<tr>
<td class="hdlist1">
NONE
</td>
<td class="hdlist2">
<p>keine Fehlerprüfung und Anpassung</p>
</td>
</tr>
<tr>
<td class="hdlist1">
CHECK
</td>
<td class="hdlist2">
<p>nur Fehlerprüfung; Protokollzeit und Größenordnung von überschreitendem Fehlerlimit. Funktioniert auch mit FMI 1 (indem die Daten der letzten beiden Schritte genutzt werden).</p>
<div class="paragraph">
<p><strong>WARNING:</strong> Noch nicht implementiert. Nicht benutzen!</p>
</div>
</td>
</tr>
<tr>
<td class="hdlist1">
ADAPT_STEP
</td>
<td class="hdlist2">
<p>aktiviert automatisch die Zeitschritt-Anpassung und vergrößert/verkleinert die Kommunikationsschrittlänge entsprechend des Fehlerschätzers.</p>
</td>
</tr>
</table>
</div>
<div class="sect3">
<h4 id="_fortgeschrittene_konfigurationen">4.1.1. Fortgeschrittene Konfigurationen</h4>
<div class="paragraph">
<p>Die folgenden Optionen werden zumeist für die Validierungs-Prozedur verwendet.</p>
</div>
<div class="hdlist">
<table>
<tr>
<td class="hdlist1">
writeInternalVariables
</td>
<td class="hdlist2">
<p>(<em>default=false</em>) Verfasst auch Variablen mit lokaler/interner Kausalität (wen es auf <strong>no</strong> gesetzt ist, werden nur Variablen mit der Kausalität <em>Ausgang</em> verfasst)</p>
</td>
</tr>
</table>
</div>
<div class="paragraph">
<p>Abhängig von den gewählten Optionen, müssen einige Fähigkeiten durch die FMUs unterstützt werden, siehe dazu Erläuterungen in Abschnitt <a href="#master_algorithms">Master-Algorithmen</a>. Grundsätzlich muss für die Verwendung eines iterierenden Master-Algorithmus oder für die Fehlerprüfung und Zeitschrittanpassung eine FMU den FMI 2 Standard und die Funktionalität für das Holen und Zurücksetzen des Zustands implementieren.</p>
</div>
</div>
</div>
<div class="sect2">
<h3 id="slave_definition">4.2. Simulator-/Slave-Definitionen</h3>
<div class="paragraph">
<p>Jeder Slave wird festgelegt durch:</p>
</div>
<div class="listingblock">
<div class="content">
<pre>simulator  &lt;priority&gt; &lt;cycle&gt;  &lt;slave-name&gt; &lt;html-color-code&gt; &lt;Pfad/zur/FMU-Datei&gt;</pre>
</div>
</div>
<div class="paragraph">
<p>Der <strong>Zyklus</strong> zeigt an, ob Slaves zu einem Zyklus mit anderen FMUs gehören. Der <strong>Slave-Name</strong> muss eine eindeutige Identifikation des Slaves zulassen (siehe Diskussion in Abschnitt <a href="#master_algorithms">Master-Algorithmen</a>).</p>
</div>
<div class="admonitionblock note">
<table>
<tr>
<td class="icon">
<i class="fa icon-note" title="Note"></i>
</td>
<td class="content">
<div class="paragraph">
<p>Die <strong>Priorität</strong> könnte genutzt werden, um die Reihenfolge der Auswertung innerhalb eines Zyklus auszuwählen (für Gauss-Jacobi/Gauss-Seidel). Die Funktion ist gegenwärtig aber nicht (mehr) implementiert und Slaves innerhalb des selben Zyklus werden in der Reihenfolge ausgewertet, in der sie festgelegt sind.</p>
</div>
</td>
</tr>
</table>
</div>
<div class="paragraph">
<p>Der Slave-/Simulatorname muss eindeutig innerhalb des Simulationsprojekts sein.</p>
</div>
<div class="admonitionblock important">
<table>
<tr>
<td class="icon">
<i class="fa icon-important" title="Important"></i>
</td>
<td class="content">
<div class="paragraph">
<p>Slave-Namen <strong>dürfen keine</strong> Leerzeichen oder Punkte enthalten. Wenn ein Slave-Name ein Leerzeichen oder einen Punkt enthält, wird der Parser der Projekt-Datei melden, dass die Definitionszeile der Simulation ungültig ist. Auch werden Slave-Namen für die Verzeichnisnamen genutzt (Zielverzeichnisse für Slave-spezifische Ergebnisse). Daher dürfen sie keine Zeichen beinhalten, die in Dateisystemnamen nicht erlaubt sind (wie z.B. <em>:</em> unter Windows).</p>
</div>
</td>
</tr>
</table>
</div>
<div class="paragraph">
<p>Der <strong>html-Farb-Code</strong> st eine übliche html-basierte Farbdefinition, die mit einem Rautezeichen beginnt, auf welches entweder 8 oder 6 Zeichen folgen, zum Beispiel: <code>#ff00ff00</code> oder <code>#00ff00</code> für grün. Im 8-Zeichen-Format ist die erste Hexadezimalzahl der Alphawert/Transparenzwert. Gegenwärtig gibt es keinen Gebrauch für diesen Wert auf der Benutzeroberfläche, sodass die 6-Zeichen-Variante die gebräuchliche Wahl ist.</p>
</div>
<div class="paragraph">
<p>Das letzte Argument in der Zeile ist der Dateipfad zur eigentlichen FMU-Datei. Der Pfad zur FMU-Datei kann in Anführungszeichen angefügt werden, wenn der Pfad oder der Dateiname Leerzeichen enthält. Der Pfad kann ein absoluter Pfad oder relativ zur <code>msim</code>-Projektdatei sein. Einige Slaves können durch die selbe FMU-Datei beschrieben werden (wenn die FMU diese Funktion unterstützt). In diesem Fall wird in einigen Simulatorzeilen der gleiche FMU-Dateipfad eingetragen.</p>
</div>
<div class="sect3">
<h4 id="csv_filereader_slaves">4.2.1. CSV-Datei-Lese-Slaves</h4>
<div class="paragraph">
<p>Bisweilen ist es sinnvoll/notwendig, vorgegebene Zeitreihen als Eingangsgrößen für FMUs bereitszustellen. Diese können in einer Datendatei bereitgestellt werden. Eine solche Datendatei (Erweiterung mit <code>tsv</code> oder <code>csv</code>) kann man wie eine FMU auswählen. <em>MasterSim</em> wird eine solche Datei wie eine FMU behandeln, und daraus CSV-Datei-Lese-Slaves erstellen, die lediglich Ausgabevariablen bereitstellen.</p>
</div>
<div class="paragraph">
<p>Effektiv unterstützt <em>MasterSim</em> zwei Varianten von CSV/TSV-Dateien (Dateierweiterung ist dabei egal). In beiden Varianten werden Zahlen immer im <strong>englischen Zahlenformat</strong> erwartet. Beim Einlesen wird zuerst versucht, eine durch Tabulatoren getrennte Spaltenstruktur zu erkennen, indem die ersten beiden Zeilen mit Tabulatorzeichen aufgeteilt werden. Wenn dies mehr als zwei Spalten ergibt und die Anzahl an Spalten in beiden Zeilen (in Kopf- und erster Datenzeile) übereinstimmt, wird eine Tabulator-getrennte CSV/TSV-Variante erkannt. Andernfalls wird eine CSV-Datei im "Excel"-Format erwartet (siehe unten).</p>
</div>
<div class="sect4">
<h5 id="_tabulator_getrennte_werte">Tabulator-getrennte Werte</h5>
<div class="paragraph">
<p>Das Format einer solchen Datei folgt denselben Konventionen wie das Dateiformat, dass von <a href="https://bauklimatik-dresden.de/postproc">PostProc 2</a> unterstützt wird (siehe auch Beschreibung dazu im <em>PostProc 2</em> Handbuch). <em>MasterSim</em> selbst schreibt Ergebnisse in diesem Dateiformat (siehe <a href="#simulation_outputs">Simulationsausgaben</a>).</p>
</div>
<div class="paragraph">
<p>Die Datei startet mit einer einzelnen Zeile (der Kopfzeile), in welcher Variablennamen und (optional) Einheiten angegeben werden. Es wird folgendes Format erwartet (wobei die Anzahl der Spalten nicht begrenzt ist).</p>
</div>
<div class="literalblock">
<div class="content">
<pre>Time [&lt;time unit&gt;] &lt;tab&gt; &lt;var1 name&gt; [&lt;unit&gt;] &lt;tab&gt; &lt;var2 name&gt; [&lt;unit&gt;]</pre>
</div>
</div>
<div class="paragraph">
<p><code>&lt;tab&gt;</code> ist ein Tabulatorzeichen. Beispiel:</p>
</div>
<div class="literalblock">
<div class="content">
<pre>Time [d]  &lt;tab&gt;  T_lab [C]  &lt;tab&gt;  T_sample [C]  &lt;tab&gt;  RH_lab [%]</pre>
</div>
</div>
<div id="ex_tsv_flavor" class="exampleblock">
<div class="title">Beispiel 3. Datei mit 3 Variablen</div>
<div class="content">
<div class="literalblock">
<div class="content">
<pre>Time [h]     T_lab [C]     T_sample [C]     RH_lab [%]
0            20            20.2             46
0.5          20.1          20.3             43
1.0          22            25               40
3.0          19            15               65</pre>
</div>
</div>
<div class="paragraph">
<p>Die Variablennamen entsprechen den Spaltenüberschriften in der Kopfzeile, ausgenommen der Einheiten (falls angegeben). Im Beispiel wird die erzeugte Datei-Lese-FMU Ausgangsvariablen mit den Namen <strong>T_lab</strong>, <strong>T_sample</strong> und <strong>TH_lab</strong> anbieten.</p>
</div>
</div>
</div>
<div class="admonitionblock tip">
<table>
<tr>
<td class="icon">
<i class="fa icon-tip" title="Tip"></i>
</td>
<td class="content">
<div class="paragraph">
<p>Eine Datei mit diesem Format erhält man automatisch, wenn eine Tabelle mit solchen Daten aus LibreOffice/Calc oder Excel etc. in einen einfachen Text-Editor kopiert wird.</p>
</div>
</td>
</tr>
</table>
</div>
</div>
<div class="sect4">
<h5 id="_kommatrennung_mit_anführungszeichen">Kommatrennung mit Anführungszeichen</h5>
<div class="paragraph">
<p>Das zweite unterstützte Format entspricht dem Format von Dateien, welche als CSV-Dateien gespeicherte Excel-Dateien haben. In solchen Dateien ist das Trennungszeichen das , (Komma) und Werte werden durch Anführungszeichen angegeben (siehe <a href="#ex_csv_Excel_flavor">Beispiel 4</a>).</p>
</div>
<div id="ex_csv_Excel_flavor" class="exampleblock">
<div class="title">Beispiel 4. Datei im CSV Format mit Komma-Trennung</div>
<div class="content">
<div class="literalblock">
<div class="content">
<pre>"time","T_lab [C]","T_sample [C]","RH_lab [%]"
"0","20","20.2","46"
"0.5","20.1","20.3","43"
"1.0","22","25","40"
"3.0","19","15","65"</pre>
</div>
</div>
<div class="paragraph">
<p>Der Inhalt dieser Datei entspricht der aus <a href="#ex_tsv_flavor">Beispiel 3</a>.</p>
</div>
</div>
</div>
<div class="admonitionblock important">
<table>
<tr>
<td class="icon">
<i class="fa icon-important" title="Important"></i>
</td>
<td class="content">
<div class="paragraph">
<p>Für beide Formatvarianten gilt: für Variablen ohne gegebene Einheiten, d.h. ohne [&#8230;&#8203;] in der Spaltenüberschrift, wird eine unbekannte/undefinierte Einheit <code>-</code> angenommen.</p>
</div>
</td>
</tr>
</table>
</div>
</div>
</div>
<div class="sect3">
<h4 id="_zeitpunkte_und_zeiteinheiten">4.2.2. Zeitpunkte und Zeiteinheiten</h4>
<div class="paragraph">
<p>Die Zeitpunkte können in beliebigen Intervallen angegeben sein. <em>MasterSim</em> geht davon aus, dass Sekunde als Basis-Zeiteinheit verwendet wird. Das bedeutet, dass Variablen intern zu einer Simulationszeit in Sekunden ausgetauscht werden. Wenn eine Eingangsdatei eine andere Einheit für die Zeit festlegt, konvertiert <em>MasterSim</em> diese Zeitangaben beim Einlesen der Datei in Sekunden.</p>
</div>
<div class="paragraph">
<p>Die folgenden Zeiteinheiten werden von MasterSim erkannt:</p>
</div>
<div class="hdlist">
<table>
<tr>
<td class="hdlist1">
ms
</td>
<td class="hdlist2">
<p>Millisekunden</p>
</td>
</tr>
<tr>
<td class="hdlist1">
s
</td>
<td class="hdlist2">
<p>Sekunden</p>
</td>
</tr>
<tr>
<td class="hdlist1">
min
</td>
<td class="hdlist2">
<p>Minuten</p>
</td>
</tr>
<tr>
<td class="hdlist1">
h
</td>
<td class="hdlist2">
<p>Stunden</p>
</td>
</tr>
<tr>
<td class="hdlist1">
d
</td>
<td class="hdlist2">
<p>Tage</p>
</td>
</tr>
<tr>
<td class="hdlist1">
a
</td>
<td class="hdlist2">
<p>Jahre (reguläre Jahre, 365 reguläre Tage, kein Schaltjahr/-tag)</p>
</td>
</tr>
</table>
</div>
<div class="admonitionblock note">
<table>
<tr>
<td class="icon">
<i class="fa icon-note" title="Note"></i>
</td>
<td class="content">
<div class="paragraph">
<div class="title">Die standardmäßige Zeiteinheit ist Sekunde</div>
<p>Im Falle einer fehlenden Zeiteinheit in der Kopfzeile der ersten Spalte (wie in <a href="#ex_csv_Excel_flavor">Beispiel 4</a>) nimmt <em>MasterSim</em> die Zeiteinheit <strong>Sekunden</strong> (s) an.</p>
</div>
</td>
</tr>
</table>
</div>
</div>
<div class="sect3">
<h4 id="_interpretation_der_von_den_datei_lese_slaves_bereitgestellten_daten">4.2.3. Interpretation der von den Datei-Lese-Slaves bereitgestellten Daten</h4>
<div class="admonitionblock important">
<table>
<tr>
<td class="icon">
<i class="fa icon-important" title="Important"></i>
</td>
<td class="content">
<div class="paragraph">
<p>Die von einem Datei-Lese-Slave exportierten Variablen sind zunächst keinem Datentyp zugewiesen, wie das sonst bei FMU Ergebnisvariablen ist. Daher prüft <em>MasterSim</em> während der Initialisierung nach den Verbindungen, die mit Datei-Lese-Slaves gemacht worden sind. Falls Verbindungen definiert sind übernimmt <em>MasterSim</em> den Datentyp der verknüpften Eingangsvariable auch für die Ausgangsvariable des Datei-Lese-Slaves.</p>
</div>
<div class="paragraph">
<p>Falls man versucht, die gleiche Ausgabevariable eines Datei-Lese-Slaves auf verschiedene Eingangsvariablen mit <em>unterschiedlichen Variablentypen</em> zuzuweisen, bricht <em>MasterSim</em> mit einer Fehlermeldung ab.</p>
</div>
</td>
</tr>
</table>
</div>
<div class="paragraph">
<p>Während der Simulation, wenn der Datei-Lese-Slave ausgewertet wird, gelten die folgenden Regeln: für die Berechnung der Ergebnisgrößen.</p>
</div>
<div class="sect4">
<h5 id="_boolean_integer_und_enumeration_datentypen"><strong>Boolean</strong>-, <strong>Integer</strong>- und <strong>Enumeration</strong>-Datentypen</h5>
<div class="paragraph">
<p>Für die Datentypen <strong>Boolean</strong>-, <strong>Integer</strong>- und <strong>Enumeration</strong> wird keine Interpolation vorgenommen. Die Werte in der Tabelle werden konstant zurückgeliefert, bis in einer Zeile ein neuer Wert definiert wird.</p>
</div>
<div class="paragraph">
<p><a href="#ex_filereader_constant">Beispiel 5</a> verdeutlicht die Auswertung der Werte.</p>
</div>
<div id="ex_filereader_constant" class="exampleblock">
<div class="title">Beispiel 5. Konstante Auswertung bei nicht-interpolierten Datentypen</div>
<div class="content">
<div class="paragraph">
<p>Datentabelle für die einheitenlose Variable <code>v</code>:</p>
</div>
<div class="listingblock">
<div class="content">
<pre>Zeit [s]   v [-]
 1         4
 3         4 <i class="conum" data-value="1"></i><b>(1)</b>
 3         7 <i class="conum" data-value="2"></i><b>(2)</b>
 6         4</pre>
</div>
</div>
<div class="colist arabic">
<table>
<tr>
<td><i class="conum" data-value="1"></i><b>1</b></td>
<td>Der Wert am Ende des Intervalls endet zum Zeitpunkt 3</td>
</tr>
<tr>
<td><i class="conum" data-value="2"></i><b>2</b></td>
<td>Der Wert zu Beginn des Intervalls startet mit Zeitpunkt 3; dieser Wert sollte von t&gt;=3 genutzt werden.</td>
</tr>
</table>
</div>
<div class="paragraph">
<p>Auswertung dieser Datentabelle für ausgewählte Zeitpunkte:</p>
</div>
<div class="literalblock">
<div class="content">
<pre>v(1) = 4
v(2) = 4
v(2.99999) = 4
v(3) = 7
v(4) = 7
v(5.99999) = 7
v(6) = 4</pre>
</div>
</div>
<div class="paragraph">
<p>Bei konstanter Auswertung ohne Interpolation könnte die Zeile <code>3     4</code> aus der Datei weggelassen werden.</p>
</div>
</div>
</div>
</div>
<div class="sect4">
<h5 id="_gleitkomma_werte">Gleitkomma-Werte</h5>
<div class="paragraph">
<p>Werte vom Datentyp <strong>Real</strong> (Gleitkommazahlen) werden linear interpoliert. Analog zum obigen Beispiel zeigt <a href="#ex_filereader_linear">Beispiel 6</a> die Auswertung bei Verwendung der linearen Interpolation.</p>
</div>
<div id="ex_filereader_linear" class="exampleblock">
<div class="title">Beispiel 6. Lineare Interpolation bei Gleitkommazahlen</div>
<div class="content">
<div class="listingblock">
<div class="content">
<pre> v(1) = 4
 v(2) = 4
 v(2.99999) = 6.99999 <i class="conum" data-value="1"></i><b>(1)</b>
 v(3) = 7
 v(4) = 6 <i class="conum" data-value="2"></i><b>(2)</b>
 v(5.99999) = 4.00001
 v(6) = 4</pre>
</div>
</div>
<div class="colist arabic">
<table>
<tr>
<td><i class="conum" data-value="1"></i><b>1</b></td>
<td>Wenn doppelte Zeitpunkte gefunden werden, überschreibt der zweite den ersten Wert, sodass die Zeile <code>3   4</code> ignoriert wird. Daher wird die Bewertung der Werte im Intervall 2&#8230;&#8203;3 ebenso mit linearer Interpolation durchgeführt.</td>
</tr>
<tr>
<td><i class="conum" data-value="2"></i><b>2</b></td>
<td>Die lineare Interpolation zwischen den Werten v(3)=7 und v(6)=4 bei t=4 ergibt 6.</td>
</tr>
</table>
</div>
</div>
</div>
<div class="admonitionblock tip">
<table>
<tr>
<td class="icon">
<i class="fa icon-tip" title="Tip"></i>
</td>
<td class="content">
<div class="paragraph">
<p>Wenn Sie Stufenfunktionen mit <strong>Real</strong>-Werten nachbilden möchten, nutzen Sie einfach ein sehr kurzes Wechsel-Intervall, z. B. <code>v(1) = 4; v(2.9999) = 4; v(3) = 7</code>. <em>MasterSim</em> wird nach wie vor den linearen Anstieg zwischen t=2.9999 und 3 verwenden, was aber unerheblich für die Ergebnisse sein sollte.</p>
</div>
</td>
</tr>
</table>
</div>
<div class="admonitionblock warning">
<table>
<tr>
<td class="icon">
<i class="fa icon-warning" title="Warning"></i>
</td>
<td class="content">
<div class="paragraph">
<p>Starke Änderungen des Anstiegs in benachbarten Intervallen (Unstetigkeiten in der ersten Ableitung) können bei Fehlerschätzer-basierter Zeitschrittanpassung zu sehr kleinen Zeitschritten führen und damit die Simulationszeit drastisch verlängern. Wann immer möglich (und ohne die Ergebnisse signifikant zu verfälschen) sollte man versuchen, größere Sprünge zwischen Anstiegen zu vermeiden oder geeignet zu glätten.</p>
</div>
</td>
</tr>
</table>
</div>
<div class="admonitionblock tip">
<table>
<tr>
<td class="icon">
<i class="fa icon-tip" title="Tip"></i>
</td>
<td class="content">
<div class="paragraph">
<p>Falls Sie einen Master-Algorithmus mit Zeitschrittanpassung in <em>MasterSim</em> verwenden, sollten Sie den maximalen Zeitschritt (max. Länge des Kommunikationsintervalls) auf einen Wert festlegen (Parameter <strong>hMax</strong>, siehe Abschnitt <a href="#simulator_settings">Einstellungen für die Simulation</a>), der kleiner als ihr kleinstes Zeitintervall in der Eingangsdatei ihres Datei-Lese-Slaves ist. Ansonsten könnte <em>MasterSim</em> unter Umständen ein Intervall überspringen und gar nicht merken, dass es zwischenzeitlich eine Änderung in den Eingangsdaten gab. Hierbei würden Daten fehlen und wahrscheinlich falsche Ergebnisse erzeugt.</p>
</div>
<div class="paragraph">
<p>Beispiel: wenn Sie mit stündlichen Klimadaten arbeiten, wählen Sie 30 Minuten als maximale Länge für ein Kommunikationsintervall.</p>
</div>
</td>
</tr>
</table>
</div>
</div>
<div class="sect4">
<h5 id="_zeichenketten_variablen">Zeichenketten-Variablen</h5>
<div class="paragraph">
<p>Zeichenketten (<strong>String</strong>)-Variablen werden wie <strong>ganzzahlige</strong> Werten behandelt.</p>
</div>
</div>
</div>
</div>
<div class="sect2">
<h3 id="connection_graph">4.3. Verbindungsgraph</h3>
<div class="paragraph">
<p>Der Verbindungsgraph beschreibt die Verknüpfung aller Slaves über Ein- und Ausgangsvariablen und legt damit den Datenaustausch zwischen den Slaves fest. Jede <code>graph</code> Zeile legt den Datentransfer zwischen einer Ausgangs- und einer Eingangsvariable fest.</p>
</div>
<div class="paragraph">
<p>Syntax der Definition:</p>
</div>
<div class="listingblock">
<div class="content">
<pre>graph &lt;outputvar&gt; &lt;inputvar&gt; [&lt;offset&gt; &lt;scale factor&gt;]</pre>
</div>
</div>
<div class="paragraph">
<p>Ausgangs- und Eingangvariablen werden jeweils aus Slave-Namen und Variablennamen zusammengesetzt:</p>
</div>
<div class="listingblock">
<div class="content">
<pre>graph &lt;slave-name&gt;.&lt;variable-name&gt; &lt;slave-name&gt;.&lt;variable-name&gt;  [&lt;offset&gt; &lt;scale factor&gt;]</pre>
</div>
</div>
<div class="paragraph">
<p>Der optionale Verschiebungs- und Skalierungsfaktor legt eine Umrechenvorschrift zwischen Ausgangsvariable und Eingangsvariable fest. Wenn eine Umrechnungsvorschrift angegeben wird, müssen immer beide Werte in der Zeile angegeben sein.</p>
</div>
<div class="paragraph">
<p>Die folgende Umrechnungsgleichung wird verwendet:</p>
</div>
<div class="literalblock">
<div class="content">
<pre>input = offset + scale * output</pre>
</div>
</div>
<div class="paragraph">
<p>Falls zum Beispiel ein FMU-Slave <em>Sensor</em> eine Temperatur in Kelvin liefert und ein anderer FMU-Slave <em>Heater</em> die Temperatur in Grad Celsius erwartet, können Sie die Verbindung wie folgt festlegen:</p>
</div>
<div class="literalblock">
<div class="content">
<pre>graph  Sensor.temperature  Heater.temperature  -273.15  1</pre>
</div>
</div>
<div class="paragraph">
<p>wodurch <em>MasterSim</em> folgende Gleichung ausführt:</p>
</div>
<div class="literalblock">
<div class="content">
<pre>input (in C) = -273.15 + 1 * output (in K)</pre>
</div>
</div>
<div class="paragraph">
<p>Auf ähnliche Weise können Sie das Vorzeichen einer Variable in einer Verbindung umkehren, wenn Sie zum Beispiel Wärmeströme oder  Masseströme durch Röhren verbinden. Angenommen der Wärmestrom ist positiv in Richtung der Oberflächennormalen festgelegt und Sie verbinden <em>SurfaceA.HeatFlow</em> und <em>SurfaceB.HeatFlow</em>, dann wird die Verknüpfung unter Berücksichtigung der Vorzeichenumkehr so definiert:</p>
</div>
<div class="literalblock">
<div class="content">
<pre>graph  SurfaceA.HeatFlow  SurfaceB.HeatFlow  0  -1</pre>
</div>
</div>
<div class="sect3">
<h4 id="_fmu_parameter">4.3.1. FMU-Parameter</h4>
<div class="paragraph">
<p>Sie können Parameter der FMUs (oder konkreter, die der individuellen FMU-Slaves) festlegen, indem Sie das <code>parameter</code>-Schlüsselwort benutzen.</p>
</div>
<div class="paragraph">
<p>Definition der Syntax:</p>
</div>
<div class="listingblock">
<div class="content">
<pre>parameter &lt;slave-name&gt;.&lt;variable-name&gt; &lt;value&gt;</pre>
</div>
</div>
<div class="paragraph">
<p>Für <strong>boolesche</strong> Parameter müssen Sie <code>true</code> als Wert verwenden (Kleinschreibung beachten) oder irgend einen anderen Wert (zum Beispiel <code>false</code>) für <strong>falsch</strong>.</p>
</div>
<div class="paragraph">
<p>Für ganzzahlige Werte (Typ <strong>Integer</strong>) müssen Sie einfach den Wert als Ziffer festlegen.</p>
</div>
<div class="paragraph">
<p>Werte für Parameter vom Typ <strong>Real</strong>" werden in der Einheit erwartet, die in der <code>modelDescription.xml</code>-Datei für den entsprechenden Parameter festgelegt worden sind. Eine Einheitenumrechnung wird hier <strong>nicht</strong> unterstützt.</p>
</div>
<div class="paragraph">
<p>Für <strong>String</strong>-Parameter wird alles nach dem Variablennamen als Zeichenkette angesehen (bis zum Ende der Zeile). Beispiel:</p>
</div>
<div class="literalblock">
<div class="content">
<pre>parameter building_model.projectFile C:\\My projects\\p2\\This tall building.project</pre>
</div>
</div>
<div class="paragraph">
<p>Leerstellen können enthalten sein. Aber die Rückwärts-Schrägstrich-Zeichen (<em>backslash</em>) müssen als <code>\\</code> kodiert sein. Dies ist notwendig, damit Sonderzeichen wie Zeilenumbrüche durch <code>\n</code> kodiert werden können, wie im folgenden Beispiel gezeigt:</p>
</div>
<div class="literalblock">
<div class="content">
<pre>parameter building_model.configPara First line\n    Some more lines with indentation\nlast line.</pre>
</div>
</div>
<div class="paragraph">
<p>Dies wird den folgenden String setzen:</p>
</div>
<div class="literalblock">
<div class="content">
<pre>First line
    Some more lines with indentation
last line</pre>
</div>
</div>
<div class="admonitionblock note">
<table>
<tr>
<td class="icon">
<i class="fa icon-note" title="Note"></i>
</td>
<td class="content">
<div class="paragraph">
<p>In dem seltenen Fall, wenn man Zeichenketten-Parameter mit führenden und abschließenden Leerzeichen festlegen möchte, kann man die Zeichenkette in "" einschließen. Beispiel:</p>
</div>
<div class="literalblock">
<div class="content">
<pre>parameter building_model.configPara "   Leerzeichen am Anfang und Ende    "</pre>
</div>
</div>
</td>
</tr>
</table>
</div>
</div>
</div>
<div class="sect2">
<h3 id="_blockmod_dateiformat_der_netzwerkdarstellungsdatei">4.4. BlockMod - Dateiformat der Netzwerkdarstellungsdatei</h3>
<div class="paragraph">
<p>Die <code>bm</code>-Datei ist eine simple XML-Datei und beschreibt die graphische Anordnung und die Visualisierung des modellierten Simulations-Szenarios.</p>
</div>
<div class="paragraph">
<p>Ein einfaches Netzwerk, wie:</p>
</div>
<div class="imageblock">
<div class="content">
<img src="../images/bm_network_example.png" alt="Blockmod Network Beispiel">
</div>
<div class="title">Abbildung 13. Beispiel für eine einfache grafische Präsentation eines Netzwerks</div>
</div>
<div class="paragraph">
<p>wird wie folgt in einer BlockMod Netzwerk-Beschreibungsdatei abgelegt:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="rouge highlight"><code data-lang="xml"><span class="cp">&lt;?xml version="1.0" encoding="UTF-8"?&gt;</span>
<span class="nt">&lt;BlockMod&gt;</span>
	<span class="c">&lt;!--Blocks--&gt;</span>
	<span class="nt">&lt;Blocks&gt;</span>
		<span class="nt">&lt;Block</span> <span class="na">name=</span><span class="s">"Part2"</span><span class="nt">&gt;</span>
			<span class="nt">&lt;Position&gt;</span>224, -160<span class="nt">&lt;/Position&gt;</span>
			<span class="nt">&lt;Size&gt;</span>64, 64<span class="nt">&lt;/Size&gt;</span>
			<span class="c">&lt;!--Sockets--&gt;</span>
			<span class="nt">&lt;Sockets&gt;</span>
				<span class="nt">&lt;Socket</span> <span class="na">name=</span><span class="s">"x1"</span><span class="nt">&gt;</span>
					<span class="nt">&lt;Position&gt;</span>0, 16<span class="nt">&lt;/Position&gt;</span>
					<span class="nt">&lt;Orientation&gt;</span>Horizontal<span class="nt">&lt;/Orientation&gt;</span>
					<span class="nt">&lt;Inlet&gt;</span>true<span class="nt">&lt;/Inlet&gt;</span>
				<span class="nt">&lt;/Socket&gt;</span>
				<span class="nt">&lt;Socket</span> <span class="na">name=</span><span class="s">"x2"</span><span class="nt">&gt;</span>
					<span class="nt">&lt;Position&gt;</span>0, 32<span class="nt">&lt;/Position&gt;</span>
					<span class="nt">&lt;Orientation&gt;</span>Horizontal<span class="nt">&lt;/Orientation&gt;</span>
					<span class="nt">&lt;Inlet&gt;</span>true<span class="nt">&lt;/Inlet&gt;</span>
				<span class="nt">&lt;/Socket&gt;</span>
				<span class="nt">&lt;Socket</span> <span class="na">name=</span><span class="s">"x4"</span><span class="nt">&gt;</span>
					<span class="nt">&lt;Position&gt;</span>0, 48<span class="nt">&lt;/Position&gt;</span>
					<span class="nt">&lt;Orientation&gt;</span>Horizontal<span class="nt">&lt;/Orientation&gt;</span>
					<span class="nt">&lt;Inlet&gt;</span>true<span class="nt">&lt;/Inlet&gt;</span>
				<span class="nt">&lt;/Socket&gt;</span>
				<span class="nt">&lt;Socket</span> <span class="na">name=</span><span class="s">"x3"</span><span class="nt">&gt;</span>
					<span class="nt">&lt;Position&gt;</span>64, 16<span class="nt">&lt;/Position&gt;</span>
					<span class="nt">&lt;Orientation&gt;</span>Horizontal<span class="nt">&lt;/Orientation&gt;</span>
					<span class="nt">&lt;Inlet&gt;</span>false<span class="nt">&lt;/Inlet&gt;</span>
				<span class="nt">&lt;/Socket&gt;</span>
			<span class="nt">&lt;/Sockets&gt;</span>
		<span class="nt">&lt;/Block&gt;</span>
		<span class="nt">&lt;Block</span> <span class="na">name=</span><span class="s">"Part3"</span><span class="nt">&gt;</span>
			<span class="nt">&lt;Position&gt;</span>352, -160<span class="nt">&lt;/Position&gt;</span>
			<span class="nt">&lt;Size&gt;</span>96, 32<span class="nt">&lt;/Size&gt;</span>
			<span class="c">&lt;!--Sockets--&gt;</span>
			<span class="nt">&lt;Sockets&gt;</span>
				<span class="nt">&lt;Socket</span> <span class="na">name=</span><span class="s">"x3"</span><span class="nt">&gt;</span>
					<span class="nt">&lt;Position&gt;</span>0, 16<span class="nt">&lt;/Position&gt;</span>
					<span class="nt">&lt;Orientation&gt;</span>Horizontal<span class="nt">&lt;/Orientation&gt;</span>
					<span class="nt">&lt;Inlet&gt;</span>true<span class="nt">&lt;/Inlet&gt;</span>
				<span class="nt">&lt;/Socket&gt;</span>
				<span class="nt">&lt;Socket</span> <span class="na">name=</span><span class="s">"x4"</span><span class="nt">&gt;</span>
					<span class="nt">&lt;Position&gt;</span>96, 16<span class="nt">&lt;/Position&gt;</span>
					<span class="nt">&lt;Orientation&gt;</span>Horizontal<span class="nt">&lt;/Orientation&gt;</span>
					<span class="nt">&lt;Inlet&gt;</span>false<span class="nt">&lt;/Inlet&gt;</span>
				<span class="nt">&lt;/Socket&gt;</span>
			<span class="nt">&lt;/Sockets&gt;</span>
		<span class="nt">&lt;/Block&gt;</span>
	<span class="nt">&lt;/Blocks&gt;</span>
	<span class="c">&lt;!--Connectors--&gt;</span>
	<span class="nt">&lt;Connectors&gt;</span>
		<span class="nt">&lt;Connector</span> <span class="na">name=</span><span class="s">"new connector"</span><span class="nt">&gt;</span>
			<span class="nt">&lt;Source&gt;</span>Part2.x3<span class="nt">&lt;/Source&gt;</span>
			<span class="nt">&lt;Target&gt;</span>Part3.x3<span class="nt">&lt;/Target&gt;</span>
			<span class="c">&lt;!--Connector segments (between start and end lines)--&gt;</span>
			<span class="nt">&lt;Segments&gt;</span>
				<span class="nt">&lt;Segment&gt;</span>
					<span class="nt">&lt;Orientation&gt;</span>Horizontal<span class="nt">&lt;/Orientation&gt;</span>
					<span class="nt">&lt;Offset&gt;</span>0<span class="nt">&lt;/Offset&gt;</span>
				<span class="nt">&lt;/Segment&gt;</span>
			<span class="nt">&lt;/Segments&gt;</span>
		<span class="nt">&lt;/Connector&gt;</span>
		<span class="nt">&lt;Connector</span> <span class="na">name=</span><span class="s">"auto-named"</span><span class="nt">&gt;</span>
			<span class="nt">&lt;Source&gt;</span>Part3.x4<span class="nt">&lt;/Source&gt;</span>
			<span class="nt">&lt;Target&gt;</span>Part2.x4<span class="nt">&lt;/Target&gt;</span>
			<span class="c">&lt;!--Connector segments (between start and end lines)--&gt;</span>
			<span class="nt">&lt;Segments&gt;</span>
				<span class="nt">&lt;Segment&gt;</span>
					<span class="nt">&lt;Orientation&gt;</span>Vertical<span class="nt">&lt;/Orientation&gt;</span>
					<span class="nt">&lt;Offset&gt;</span>80<span class="nt">&lt;/Offset&gt;</span>
				<span class="nt">&lt;/Segment&gt;</span>
				<span class="nt">&lt;Segment&gt;</span>
					<span class="nt">&lt;Orientation&gt;</span>Horizontal<span class="nt">&lt;/Orientation&gt;</span>
					<span class="nt">&lt;Offset&gt;</span>-288<span class="nt">&lt;/Offset&gt;</span>
				<span class="nt">&lt;/Segment&gt;</span>
				<span class="nt">&lt;Segment&gt;</span>
					<span class="nt">&lt;Orientation&gt;</span>Vertical<span class="nt">&lt;/Orientation&gt;</span>
					<span class="nt">&lt;Offset&gt;</span>-48<span class="nt">&lt;/Offset&gt;</span>
				<span class="nt">&lt;/Segment&gt;</span>
			<span class="nt">&lt;/Segments&gt;</span>
		<span class="nt">&lt;/Connector&gt;</span>
	<span class="nt">&lt;/Connectors&gt;</span>
<span class="nt">&lt;/BlockMod&gt;</span></code></pre>
</div>
</div>
<div class="paragraph">
<p>Das Format ist ziemlich selbsterklärend. Das erste und das letzte Segment einer Verbindung (<code>Connector</code> tag) wird automatisch abhängig von der Sockelposition auf dem Block festgelegt, und wird dadurch nicht in der Netzwerk-Beschreibungsdatei gespeichert.</p>
</div>
<div class="admonitionblock tip">
<table>
<tr>
<td class="icon">
<i class="fa icon-tip" title="Tip"></i>
</td>
<td class="content">
<div class="paragraph">
<p><a href="https://github.com/ghorwin/BlockMod">BlockMod</a> ist eine Open-Source-Bibliothek zum Modellieren solcher Netzwerke. Die Wiki-Seite des Projekts enthält mehr ausführliche Informationen über das Datenformat und die Funktionalität.</p>
</div>
</td>
</tr>
</table>
</div>
</div>
</div>
</div>
<div class="sect1">
<h2 id="_testreihen_und_validierung">5. Testreihen und Validierung</h2>
<div class="sectionbody">
<div class="paragraph">
<p>Das <em>MasterSim</em> Quelltext-Repository enthält ein Unterverzeichnis <code>data/tests</code> mit einem Regressionstest. Diese Testreihe wird genutzt, um zu prüfen, ob alle Algorithmen wie erwartet arbeiten und ob Änderungen am Quelltext versehentlich etwas kaputt machen.</p>
</div>
<div class="paragraph">
<p><em>MasterSim</em> durchläuft außerdem die FMU-Quer-Validierung (fmi-cross-check). Die Dateien und Skripte, die mit diesem Test in Verbindung stehen, befinden sich im Unterverzeichnis <code>cross-check</code>.</p>
</div>
<div class="sect2">
<h3 id="_regressionstests">5.1. Regressionstests</h3>
<div class="sect3">
<h4 id="_verzeichnisstruktur">5.1.1. Verzeichnisstruktur</h4>
<div class="literalblock">
<div class="content">
<pre>/data/tests                     - Basisverzeichnis für Tests
/data/tests/&lt;platform&gt;/&lt;test&gt;   - Basisverzeichnis für eine Testreihe</pre>
</div>
</div>
<div class="paragraph">
<p><code>platform</code> ist (gegenwärtig) eine von: <code>linux64</code>, <code>win32</code>,<code>win64</code> und <code>darwin64</code></p>
</div>
<div class="paragraph">
<p>Jede <em>Testreihe</em> hat eine Reihe von Unterverzeichnissen:</p>
</div>
<div class="literalblock">
<div class="content">
<pre>fmus                 - enthält für den Test benötigte FMU-Archive
description          - (mathematische) Beschreibung des Test-Problems</pre>
</div>
</div>
<div class="paragraph">
<p>Innerhalb der <em>Testreihe</em> können verschiedene ähnliche <em>Testfälle</em> mit modifizierten Parametern oder angepassten Problemlösungs-Szenarien gespeichert sein. <em>Testfälle</em> werden in der Regel als Testreihen gruppiert, wenn sie die gleichen FMUs oder andere Eingangsdateien benutzen.</p>
</div>
<div class="paragraph">
<p>Für jeden <em>Testfall</em> existiert eine <em>MasterSim</em>-Projektdatei mit der Erweiterung <code>msim</code>. Das Skript, welches die Testfälle durchführt, verarbeitet alle <code>msim</code>-Dateien, die in der Unterverzeichnisstruktur unter der aktuellen Plattform gefunden werden.</p>
</div>
<div class="paragraph">
<p>Um die Überprüfung in einem Testfall zu bestehen, muss eine Reihe von Referenzergebnissen vohanden sein, die in einem Unterverzeichnis mit folgendem Namen gespeichert sind:</p>
</div>
<div class="literalblock">
<div class="content">
<pre>&lt;project_file_without_extension&gt;.&lt;compiler&gt;_&lt;platform&gt;</pre>
</div>
</div>
<div class="paragraph">
<p>Zum Beispiel:</p>
</div>
<div class="literalblock">
<div class="content">
<pre>FeedthroughTest.gcc_linux
FeedthroughTest.vc14_win64</pre>
</div>
</div>
<div class="paragraph">
<p>Diese Verzeichnisse sind grundsätzlich nach einer durchlaufenen Simulation umbenannte Arbeitsverzeichnisse, in denen alles außer <code>summary.txt</code> und <code>values.csv</code> beseitigt worden ist.</p>
</div>
</div>
<div class="sect3">
<h4 id="_durchlauf_der_tests">5.1.2. Durchlauf der Tests</h4>
<div class="paragraph">
<p>Die Tests laufen automatisch nach Erstellen der Software ab. Ansonsten kann man die Testreihe auch über ein Skript selbst starten (je nach Plattform):</p>
</div>
<div class="ulist">
<ul>
<li>
<p><code>build/cmake/run_tests_win32.bat</code></p>
</li>
<li>
<p><code>build/cmake/run_tests_win64.bat</code></p>
</li>
<li>
<p><code>build/cmake/run_tests.sh</code></p>
</li>
</ul>
</div>
</div>
<div class="sect3">
<h4 id="_aktualisierung_der_referenzergebnisse">5.1.3. Aktualisierung der Referenzergebnisse</h4>
<div class="paragraph">
<p>Aus einem Testverzeichnis heraus kann man das Script  <code>update_reference_results.py</code> aufrufen und dabei die plattformspezifische Verzeichnisendung als Argument angeben.</p>
</div>
<div class="paragraph">
<p>Beispielsweise würde der Aufruf aus dem Verzeichnis</p>
</div>
<div class="literalblock">
<div class="content">
<pre>data/tests/linux64/Math_003_control_loop</pre>
</div>
</div>
<div class="paragraph">
<p>so aussehen:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="rouge highlight"><code data-lang="bash"><span class="o">&gt;</span> ../../../../scripts/TestSuite/update_reference_results.py gcc_linux</code></pre>
</div>
</div>
<div class="paragraph">
<p>Das Script aktualisiert nun alle Referenzergebnisse in diesem Verzeichnis. Falls die Referenzergebnisse mehrerer Testreihen bearbeitet/aktualisiert werden sollen, so führt man das Skript <code>update_reference_results_in_subdirs.py</code> aus einem der oberen Verzeichnisse durch, zum Beispiel von: <code>data/tests/linux64</code> (anderen Scriptnamen beachten!):</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="rouge highlight"><code data-lang="bash"><span class="o">&gt;</span> ../../../scripts/TestSuite/update_reference_results_in_subdirs.py gcc_linux</code></pre>
</div>
</div>
</div>
</div>
<div class="sect2">
<h3 id="_regeln_für_quervergleiche_und_die_fmi_standard_org_übersicht">5.2. Regeln für Quervergleiche und die FMI Standard.org Übersicht</h3>
<div class="paragraph">
<p>Siehe Dokumentation im Unterverzeichnis <code>cross-check</code>.</p>
</div>
</div>
<div class="sect2">
<h3 id="_verschieden_möglichkeiten_test_fmus_zu_erstellen">5.3. Verschieden Möglichkeiten, Test-FMUs zu erstellen</h3>
<div class="sect3">
<h4 id="_native_c_fmus">5.3.1. Native C++ FMUs</h4>
<div class="paragraph">
<p>Ein geeigneter Weg, um eine einfache, sehr spezielle Test-FMU zu erhalten, ist die Verwendung des <a href="https://github.com/ghorwin/FMICodeGenerator">FMI Code Generator</a>-Werkzeugs. Es ist ein Python-Skript mit einer grafischen Benutzeroberfläche, in der FMU-Variablen und -Eigenschaften festgelegt werden können. Mit dieser Information erstellt der Code-Generator ein Quelltextverzeichnis mit einer Programm-Quelltextvorlage und den benötigten Skripten für das Erstellen und Verpacken der FMUs. Damit ist es sehr einfach, eigene FMUs zu erstellen (siehe auch Dokumentation/Tutorial auf der Webseite <a href="https://github.com/ghorwin/FMICodeGenerator" class="bare">https://github.com/ghorwin/FMICodeGenerator</a>).</p>
</div>
</div>
<div class="sect3">
<h4 id="_modelica_basierte_fmus">5.3.2. Modelica-basierte FMUs</h4>
<div class="sect4">
<h5 id="_fmus_aus_kommerziellen_modelica_entwicklungsumgebungen">FMUs aus kommerziellen Modelica-Entwicklungsumgebungen</h5>
<div class="paragraph">
<p>Benötigt eine entsprechende passende Lizenz. Das Exportieren von FMUs aus SimulationX oder Dymola ist recht einfach, aber für die Windows-Plattform beschränkt.</p>
</div>
<div class="paragraph">
<p>OpenModelica kann ebenso FMUs exportieren. Nachfolgend sind die Schritte erläutert, um so eine FMU zu erstellen.</p>
</div>
</div>
</div>
<div class="sect3">
<h4 id="_erstellen_einer_fmu_mit_openmodelica">5.3.3. Erstellen einer FMU mit OpenModelica</h4>
<div class="paragraph">
<p>Zunächst wird ein Modelica-Modell erstellt.</p>
</div>
<div class="admonitionblock important">
<table>
<tr>
<td class="icon">
<i class="fa icon-important" title="Important"></i>
</td>
<td class="content">
<div class="paragraph">
<p>Versehen Sie Variablen, die als Ausgangsgrößen von der FMU bereitgestellt werden sollen, mit dem Stichwort <code>output</code>.</p>
</div>
</td>
</tr>
</table>
</div>
<div class="paragraph">
<p>Zum Beispiel:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="rouge highlight"><code data-lang="c++"><span class="n">model</span> <span class="n">BouncingBall</span> <span class="s">"The 'classic' bouncing ball model"</span>
  <span class="n">type</span> <span class="n">Height</span><span class="o">=</span><span class="n">Real</span><span class="p">(</span><span class="n">unit</span><span class="o">=</span><span class="s">"m"</span><span class="p">);</span>
  <span class="n">type</span> <span class="n">Velocity</span><span class="o">=</span><span class="n">Real</span><span class="p">(</span><span class="n">unit</span><span class="o">=</span><span class="s">"m/s"</span><span class="p">);</span>
  <span class="n">parameter</span> <span class="n">Real</span> <span class="n">e</span><span class="o">=</span><span class="mf">0.8</span> <span class="s">"Coefficient of restitution"</span><span class="p">;</span>
  <span class="n">parameter</span> <span class="n">Height</span> <span class="n">h0</span><span class="o">=</span><span class="mf">1.0</span> <span class="s">"Initial height"</span><span class="p">;</span>
  <span class="n">output</span> <span class="n">Height</span> <span class="n">h</span> <span class="s">"Height"</span><span class="p">;</span>
  <span class="n">output</span> <span class="n">Velocity</span> <span class="n">v</span><span class="p">(</span><span class="n">start</span><span class="o">=</span><span class="mf">0.0</span><span class="p">,</span> <span class="n">fixed</span><span class="o">=</span><span class="nb">true</span><span class="p">)</span> <span class="s">"Velocity"</span><span class="p">;</span>
  <span class="n">output</span> <span class="n">Integer</span> <span class="nf">bounceCounter</span><span class="p">(</span><span class="n">start</span><span class="o">=</span><span class="mi">0</span><span class="p">);</span>
  <span class="n">output</span> <span class="n">Boolean</span> <span class="n">falling</span><span class="p">;</span>
<span class="n">initial</span> <span class="n">equation</span>
  <span class="n">h</span> <span class="o">=</span> <span class="n">h0</span><span class="p">;</span>
<span class="n">equation</span>
  <span class="n">v</span> <span class="o">=</span> <span class="n">der</span><span class="p">(</span><span class="n">h</span><span class="p">);</span>
  <span class="n">der</span><span class="p">(</span><span class="n">v</span><span class="p">)</span> <span class="o">=</span> <span class="o">-</span><span class="mf">9.81</span><span class="p">;</span>
  <span class="k">if</span> <span class="n">v</span> <span class="o">&lt;</span> <span class="mi">0</span> <span class="n">then</span>
    <span class="n">falling</span> <span class="o">=</span> <span class="nb">true</span><span class="p">;</span>
  <span class="k">else</span>
    <span class="n">falling</span> <span class="o">=</span> <span class="nb">false</span><span class="p">;</span>
  <span class="n">end</span> <span class="k">if</span><span class="p">;</span>
  <span class="n">when</span> <span class="n">h</span><span class="o">&lt;</span><span class="mi">0</span> <span class="n">then</span>
    <span class="nf">reinit</span><span class="p">(</span><span class="n">v</span><span class="p">,</span> <span class="o">-</span><span class="n">e</span><span class="o">*</span><span class="n">pre</span><span class="p">(</span><span class="n">v</span><span class="p">));</span>
    <span class="n">bounceCounter</span> <span class="o">=</span> <span class="n">pre</span><span class="p">(</span><span class="n">bounceCounter</span><span class="p">)</span> <span class="o">+</span> <span class="mi">1</span><span class="p">;</span>
  <span class="n">end</span> <span class="n">when</span><span class="p">;</span>
<span class="n">annotation</span><span class="p">(</span>
    <span class="n">experiment</span><span class="p">(</span><span class="n">StartTime</span> <span class="o">=</span> <span class="mi">0</span><span class="p">,</span> <span class="n">StopTime</span> <span class="o">=</span> <span class="mi">5</span><span class="p">,</span> <span class="n">Tolerance</span> <span class="o">=</span> <span class="mf">1e-6</span><span class="p">,</span> <span class="n">Interval</span> <span class="o">=</span> <span class="mf">0.01</span><span class="p">));</span>
<span class="n">end</span> <span class="n">BouncingBall</span><span class="p">;</span></code></pre>
</div>
</div>
<div class="sect4">
<h5 id="_erstellungsvariante_1_die_fmu_manuell_erstellen">Erstellungsvariante 1: Die FMU manuell erstellen</h5>
<div class="paragraph">
<p>Öffnen Sie zunächst OMShell, tippen Sie dann die folgenden Befehle, um das Modell zu laden und erzeugen Sie eine Co-Simulations-FMU:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="rouge highlight"><code data-lang="bash"><span class="o">&gt;&gt;</span> loadFile<span class="o">(</span><span class="s2">"/path/to/modelica/models/BouncingBall/BouncingBall.mo"</span><span class="o">)</span>
<span class="o">&gt;&gt;</span> translateModelFMU<span class="o">(</span>BouncingBall, <span class="nv">fmuType</span><span class="o">=</span><span class="s2">"cs"</span><span class="o">)</span>
<span class="s2">"/tmp/OpenModelica/BouncingBall.fmu"</span></code></pre>
</div>
</div>
<div class="paragraph">
<p>Die Ausgabe <code>/tmp/OpenModelica/BouncingBall.fmu</code> zeigt an, dass die FMU erfolgreich erstellt wurde.</p>
</div>
<div class="paragraph">
<p>Zur Erstellung von FMUs mit FMI 2.0 Unterstützung:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="rouge highlight"><code data-lang="bash"><span class="o">&gt;&gt;</span> translateModelFMU<span class="o">(</span>BouncingBall, <span class="nv">fmuType</span><span class="o">=</span><span class="s2">"cs"</span>, <span class="nv">version</span><span class="o">=</span><span class="s2">"2.0"</span><span class="o">)</span></code></pre>
</div>
</div>
</div>
<div class="sect4">
<h5 id="_erstellungsvariante_2_skript_basierte_automatische_fmu_erzeugung">Erstellungsvariante 2: Skript-basierte automatische FMU-Erzeugung</h5>
<div class="paragraph">
<p>Erstellen Sie eine Skript-Datei (<code>createFMU.mos</code>) mit dem folgenden Inhalt:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="rouge highlight"><code data-lang="c++"><span class="n">loadModel</span><span class="p">(</span><span class="n">Modelica</span><span class="p">,</span> <span class="p">{</span><span class="s">"3.2.1"</span><span class="p">});</span> <span class="n">getErrorString</span><span class="p">();</span>
<span class="n">loadModel</span><span class="p">(</span><span class="n">Modelica_DeviceDrivers</span><span class="p">);</span> <span class="n">getErrorString</span><span class="p">();</span>

<span class="n">setLanguageStandard</span><span class="p">(</span><span class="s">"3.3"</span><span class="p">);</span> <span class="n">getErrorString</span><span class="p">();</span>

<span class="n">cd</span><span class="p">(</span><span class="s">"./fmus"</span><span class="p">);</span>
<span class="n">loadFile</span><span class="p">(</span><span class="s">"../reference_Modelica/BouncingBall.mo"</span><span class="p">);</span> <span class="n">getErrorString</span><span class="p">();</span>

<span class="n">setDebugFlags</span><span class="p">(</span><span class="s">"backenddaeinfo"</span><span class="p">);</span><span class="n">getErrorString</span><span class="p">();</span>
<span class="n">translateModelFMU</span><span class="p">(</span><span class="n">BouncingBall</span><span class="p">,</span> <span class="n">fmuType</span><span class="o">=</span><span class="s">"cs"</span><span class="p">);</span> <span class="n">getErrorString</span><span class="p">();</span></code></pre>
</div>
</div>
<div class="paragraph">
<p>Lassen Sie das Skript laufen, mittels:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="rouge highlight"><code data-lang="bash"><span class="o">&gt;</span> omc createFMU.mos</code></pre>
</div>
</div>
</div>
</div>
</div>
</div>
</div>
<div class="sect1">
<h2 id="fmu_dev_helpers">6. Assistenzfunktionen für FMU-Entwicklung und Fehlerbeseitigung</h2>
<div class="sectionbody">
<div class="paragraph">
<p>Dieser Abschnitt beschreibt einige Funktionen von <em>MasterSim</em>, die sehr nützlich für Entwickler eigener FMUs oder zum Identifizieren von FMU-Berechnungsproblemen sind.</p>
</div>
<div class="paragraph">
<p>Dadurch, dass der <em>MasterSim</em>-Quelltext frei verfügbar ist, kann die ganze Kommunikation zwischen Co-Simulations-Master und den Simulations-Slaves im Debugger verfolgt und analysiert werden. Doch auch ohne Entwicklungsumgebung und Quelltextzugriff, kann man mit <em>MasterSim</em> effizient FMU-Probleme beseitigen.</p>
</div>
<div class="sect2">
<h3 id="skip_FMU_extraction">6.1. Einfache Veränderung/Reparatur von fehlerhaften FMUs</h3>
<div class="paragraph">
<p>Häufig resultieren Fehler in FMUs aus fehlerhaften/unvollständigen <code>modelDescription.xml</code>-Dateien. Oder es fehlen Resourcen. Oder die im FMU-Archiv eingebetteten Resource sind veraltet, und müssen ersetzt werden (Datenbankdateien etc.).</p>
</div>
<div class="paragraph">
<p>In diesem Fall ist die klassische Arbeitsweise:</p>
</div>
<div class="olist arabic">
<ol class="arabic">
<li>
<p>FMU entpacken</p>
</li>
<li>
<p>Inhalt bearbeiten</p>
</li>
<li>
<p>FMU-Verzeichnis wieder komprimieren</p>
</li>
<li>
<p>Komprimierte Datei umbenennen/in das ursprüngliche Verzeichnis kopieren</p>
</li>
</ol>
</div>
<div class="paragraph">
<p>Dies kann recht mühsehlig und zeitaufwändig sein. <em>MasterSim</em> kann dieses Prozedere abkürzen.</p>
</div>
<div class="paragraph">
<p>Dazu startet man den <em>MasterSimulator</em> einmal regulär (und bricht dann ggfs. die Simulation ab). Die verwendeten FMUs wurden bei der Initialisierung in die jeweiligen Verzeichnisse entpackt (siehe auch Abschnitt <a href="#working_directory_structure">Struktur und Inhalt des Arbeitsverzeichnis</a>).</p>
</div>
<div class="paragraph">
<p>Nun kann man in diesem Verzeichnissen die benötigten Änderungen vornehmen, z.B. die <code>modelDescription.xml</code>-Datei im Texteditor bearbeiten oder Dateien austauschen. Auch kann man die Laufzeitbibliotheken der FMU selbst austauschen (oder neu compilieren).</p>
</div>
<div class="paragraph">
<p>Nun kann man <em>MasterSimulator</em> erneut durchlaufen lassen, jedoch diesmal mit der Befehlszeilen-Option <code>--skip-unzip</code>. <em>MasterSim</em> wird den Schritt des Entpackens überspringen und direkt auf die Dateien im extrahierten Verzeichnis zugreifen.</p>
</div>
<div class="admonitionblock tip">
<table>
<tr>
<td class="icon">
<i class="fa icon-tip" title="Tip"></i>
</td>
<td class="content">
<div class="paragraph">
<p>Beim Bearbeiten der <code>modelDescription.xml</code>-Datei kann man diese dabei auch im Texteditor geöffnet halten, was wiederum etwas Zeit spart.</p>
</div>
</td>
</tr>
</table>
</div>
</div>
</div>
</div>
<div class="sect1">
<h2 id="_informationen_für_entwickler">7. Informationen für Entwickler</h2>
<div class="sectionbody">
<div class="admonitionblock note">
<table>
<tr>
<td class="icon">
<i class="fa icon-note" title="Note"></i>
</td>
<td class="content">
<div class="paragraph">
<p>Die aktuellsten Informationen sind in der englischsprachigen Dokumentation enthalten.</p>
</div>
<div class="paragraph">
<p>Die in diesem Kapitel zur Verfügung gestellten Informationen werden eventuell in den <em>MasterSim Developers Guide</em> verschoben.</p>
</div>
</td>
</tr>
</table>
</div>
<div class="sect2">
<h3 id="_erstellen_von_bibliotheken_und_ausführbaren_programmen">7.1. Erstellen von Bibliotheken und ausführbaren Programmen</h3>
<div class="sect3">
<h4 id="_erstellen_mit_die_befehlszeile">7.1.1. Erstellen mit die Befehlszeile</h4>
<div class="sect4">
<h5 id="_linuxmacos">Linux/MacOS</h5>
<div class="listingblock">
<div class="content">
<pre class="rouge highlight"><code data-lang="bash"><span class="nb">cd </span>build/cmake
./build.sh</code></pre>
</div>
</div>
<div class="paragraph">
<p>Im Falle fehlender Abhängigkeiten (verlangt zlib) müssen ggfs. die benötigten Entwicklungspakete installiert werden.</p>
</div>
</div>
<div class="sect4">
<h5 id="_windows">Windows</h5>
<div class="paragraph">
<p>Es sind komfortable Skripte für die Erstellung mit Visual Studio 2015 und Qt5 (für die Benutzeroberfläche von <em>MasterSim</em>) enthalten. Andere Compiler, wie MinGW, arbeiten genauso gut, die Dateipfade/Suchpfade müssen allerdings manuell konfiguriert werden.</p>
</div>
<div class="paragraph">
<p>Folgende Dateien sind im <code>build/cmake</code>-Verzeichnis:</p>
</div>
<div class="listingblock">
<div class="content">
<pre>build\cmake\build_VC.bat <i class="conum" data-value="1"></i><b>(1)</b>
build\cmake\build_VC_x64.bat <i class="conum" data-value="2"></i><b>(2)</b></pre>
</div>
</div>
<div class="colist arabic">
<table>
<tr>
<td><i class="conum" data-value="1"></i><b>1</b></td>
<td>for x86 builds</td>
</tr>
<tr>
<td><i class="conum" data-value="2"></i><b>2</b></td>
<td>for x64 builds</td>
</tr>
</table>
</div>
<div class="paragraph">
<p>Damit die Skripte funktionieren, muss Qt am folgenden Ort installiert sein:</p>
</div>
<div class="listingblock">
<div class="content">
<pre>c:\Qt\5.11.3\msvc2015 <i class="conum" data-value="1"></i><b>(1)</b>
c:\Qt\5.11.3\msvc2015_64 <i class="conum" data-value="2"></i><b>(2)</b></pre>
</div>
</div>
<div class="colist arabic">
<table>
<tr>
<td><i class="conum" data-value="1"></i><b>1</b></td>
<td>für Aufbauten x86</td>
</tr>
<tr>
<td><i class="conum" data-value="2"></i><b>2</b></td>
<td>für Aufbauten x64</td>
</tr>
</table>
</div>
<div class="paragraph">
<p>und <strong>jom.exe</strong> findet man unter:</p>
</div>
<div class="listingblock">
<div class="content">
<pre>c:\Qt\Tools\QtCreator\bin\jom.exe</pre>
</div>
</div>
<div class="paragraph">
<p><code>cmake</code> muss ebenso im Pfad vorhanden sein. Wenn es irgendwo anders installiert ist, können alternativ die Umgebungsvariablen <code>JOM_PATH</code> und <code>CMAKE_PREFIX_PATH</code> gesetzt werden.</p>
</div>
<div class="paragraph">
<p>Mit dieser Konfiguration können Sie nun entweder im 32-bit- oder 64-bit-Modus weiter bauen:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="rouge highlight"><code data-lang="batch"><span class="nb">cd</span> <span class="kd">build</span>\cmake
<span class="kd">build_VC14</span>.bat</code></pre>
</div>
</div>
<div class="paragraph">
<p>oder:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="rouge highlight"><code data-lang="batch"><span class="nb">cd</span> <span class="kd">build</span>\cmake
<span class="kd">build_VC14_x64</span>.bat</code></pre>
</div>
</div>
<div class="paragraph">
<p>Für unterschiedliche Visual-Studio-Versionen oder MinGW kopieren Sie die Batch-Datei und bearbeiten die Pfade in den Batch-Dateien.</p>
</div>
</div>
</div>
<div class="sect3">
<h4 id="_bibliotheken">7.1.2. Bibliotheken</h4>
<div class="paragraph">
<p>Die <em>MasterSim</em>-Bibliothek und die Simulationsprojekte hängen von folgenden Bibliotheken ab,  wobei abgesehen von Qt alle im Quelltext-Repository enthalten sind. Somit ist es nicht notwendig, irgendwelche Bibliotheken separat zu installieren:</p>
</div>
<div class="paragraph">
<p><strong>MasterSimulator</strong> und <strong>MasterSimulatorUI</strong></p>
</div>
<div class="ulist">
<ul>
<li>
<p>IBK-Bibliothek (von IBK, TU Dresden, Germany)</p>
</li>
<li>
<p>IBKMK-Bibliothek (von IBK, TU Dresden, Germany), Untergruppe der Mathe-Kernel-Bibliothek der IBK</p>
</li>
<li>
<p>TiCPP-Bibliothek (eine angepasste Version, angeboten von IBK, TU Dresden, Germany)</p>
</li>
<li>
<p>Minizip and zlib zum Entpacken von FMUs</p>
</li>
</ul>
</div>
<div class="paragraph">
<p>nur <strong>MasterSimulatorUI</strong></p>
</div>
<div class="ulist">
<ul>
<li>
<p><a href="https://www.qt.io/developers">Qt 5 Library</a></p>
</li>
<li>
<p><a href="https://github.com/ghorwin/BlockMod">BlockMod library</a> (von IBK, TU Dresden, Germany, gehostet auf github)</p>
</li>
</ul>
</div>
<div class="paragraph">
<p>Die frei verfügbare Version der Bibliotheken (mit Ausnahme von Qt) sind im Unterverzeichnis <code>third-party</code> abgelegt.</p>
</div>
<div class="admonitionblock warning">
<table>
<tr>
<td class="icon">
<i class="fa icon-warning" title="Warning"></i>
</td>
<td class="content">
<div class="paragraph">
<p>Die Bibliotheken im <code>third-party</code>  Unterverzeichnis sind möglicherweise veraltet. Nutzen Sie bitte nur den Quelltext im <code>externals</code>-Unterverzeichnis des Repositories.</p>
</div>
</td>
</tr>
</table>
</div>
</div>
</div>
<div class="sect2">
<h3 id="_entwicklungsumgebungen_und_projekt_sitzungsdateien">7.2. Entwicklungsumgebungen und Projekt-/Sitzungsdateien</h3>
<div class="sect3">
<h4 id="_qt_creator">7.2.1. Qt Creator</h4>
<div class="paragraph">
<p>Die Entwicklung mit Qt Creator wird unterstützt (und explizit empfohlen) und Projektdateien stehen zur Verfügung. Individuelle Projektdateien befinden sich in Unterverzeichnissen:</p>
</div>
<div class="literalblock">
<div class="content">
<pre>&lt;library/app&gt;/projects/Qt/&lt;library/app&gt;.pro</pre>
</div>
</div>
<div class="paragraph">
<p>Ausführbare Programme werden abgelegt in:</p>
</div>
<div class="literalblock">
<div class="content">
<pre>bin/debug        - Ausgabepfad für Entwicklungen mit dem Qt Creator
bin/release      - standardisierter Ausgabepfad für Erstellung mit cmake</pre>
</div>
</div>
</div>
<div class="sect3">
<h4 id="_visual_studio">7.2.2. Visual Studio</h4>
<div class="sect4">
<h5 id="_cmake_erstellte_vc_projektdateien">CMake-erstellte VC-Projektdateien</h5>
<div class="paragraph">
<p>Die einfachste Variante, die immer funktionieren sollte, ist die CMake-erzeugte VC-Projektdatei und <em>Solution</em> zu verwenden.</p>
</div>
<div class="paragraph">
<p>Basisschritte: Öffnen Sie ein Konsolenfenster (VC Commandozeilen Fenster) und verwenden Sie dann CMake mit dem Visual Studio Erstellungsdatei-Generator.</p>
</div>
<div class="paragraph">
<p>Sie können die <code>build.bat</code>- oder <code>built_x64.bat</code>-Dateien für diesen Zweck wiederverwenden. Öffnen Sie ein Befehlszeilenfenster und wechseln in das Verzeichnis <code>build/cmake</code>.</p>
</div>
<div class="olist arabic">
<ol class="arabic">
<li>
<p>Starten Sie entweder <code>build.bat</code> oder <code>build_x64.bat</code> und drücken Sie Ctrl+C, wenn die Erstellung startet (dann sind alle Umgebungsvariablen und Pfade bereits gesetzt).</p>
</li>
<li>
<p>Verlassen Sie das Unterverzeichnis und erstellen Sie ein neues Unterverzeichnis vc:</p>
<div class="listingblock">
<div class="content">
<pre class="rouge highlight"><code data-lang="batch"><span class="o">&gt;</span> <span class="nb">mkdir</span> <span class="kd">vc</span>
<span class="o">&gt;</span> <span class="nb">cd</span> <span class="kd">vc</span></code></pre>
</div>
</div>
</li>
<li>
<p>Öffnen Sie <code>cmake-gui</code>, geben Sie das Elternverzeichnis als Quellverzeichnis an und wählen Sie einen Visual Studio Generator.</p>
</li>
</ol>
</div>
<div class="listingblock">
<div class="content">
<pre class="rouge highlight"><code data-lang="batch"><span class="o">&gt;</span> <span class="kd">cmake</span><span class="na">-gui </span>..</code></pre>
</div>
</div>
<div class="paragraph">
<p>Die so erstellte <code>*.sln</code> Datei kann man dann einfach in VC öffnen.</p>
</div>
</div>
</div>
</div>
<div class="sect2">
<h3 id="_weitere_entwickler_informationen">7.3. Weitere Entwickler-Informationen</h3>
<div class="paragraph">
<p>Alle weiteren Entwicklerinformationen werden der Einfachheit halber nur in der englischen Dokumentation beschrieben.</p>
</div>
</div>
</div>
</div>
</div>
<div id="footer">
<div id="footer-text">
Version 0.9.0<br>
Last updated 2021-09-10 16:28:56 +0200
</div>
</div>
<style>
pre.rouge table td { padding: 5px; }
pre.rouge table pre { margin: 0; }
pre.rouge .cm {
  color: #999988;
  font-style: italic;
}
pre.rouge .cp {
  color: #999999;
  font-weight: bold;
}
pre.rouge .c1 {
  color: #999988;
  font-style: italic;
}
pre.rouge .cs {
  color: #999999;
  font-weight: bold;
  font-style: italic;
}
pre.rouge .c, pre.rouge .ch, pre.rouge .cd, pre.rouge .cpf {
  color: #999988;
  font-style: italic;
}
pre.rouge .err {
  color: #a61717;
  background-color: #e3d2d2;
}
pre.rouge .gd {
  color: #000000;
  background-color: #ffdddd;
}
pre.rouge .ge {
  color: #000000;
  font-style: italic;
}
pre.rouge .gr {
  color: #aa0000;
}
pre.rouge .gh {
  color: #999999;
}
pre.rouge .gi {
  color: #000000;
  background-color: #ddffdd;
}
pre.rouge .go {
  color: #888888;
}
pre.rouge .gp {
  color: #555555;
}
pre.rouge .gs {
  font-weight: bold;
}
pre.rouge .gu {
  color: #aaaaaa;
}
pre.rouge .gt {
  color: #aa0000;
}
pre.rouge .kc {
  color: #000000;
  font-weight: bold;
}
pre.rouge .kd {
  color: #000000;
  font-weight: bold;
}
pre.rouge .kn {
  color: #000000;
  font-weight: bold;
}
pre.rouge .kp {
  color: #000000;
  font-weight: bold;
}
pre.rouge .kr {
  color: #000000;
  font-weight: bold;
}
pre.rouge .kt {
  color: #445588;
  font-weight: bold;
}
pre.rouge .k, pre.rouge .kv {
  color: #000000;
  font-weight: bold;
}
pre.rouge .mf {
  color: #009999;
}
pre.rouge .mh {
  color: #009999;
}
pre.rouge .il {
  color: #009999;
}
pre.rouge .mi {
  color: #009999;
}
pre.rouge .mo {
  color: #009999;
}
pre.rouge .m, pre.rouge .mb, pre.rouge .mx {
  color: #009999;
}
pre.rouge .sb {
  color: #d14;
}
pre.rouge .sc {
  color: #d14;
}
pre.rouge .sd {
  color: #d14;
}
pre.rouge .s2 {
  color: #d14;
}
pre.rouge .se {
  color: #d14;
}
pre.rouge .sh {
  color: #d14;
}
pre.rouge .si {
  color: #d14;
}
pre.rouge .sx {
  color: #d14;
}
pre.rouge .sr {
  color: #009926;
}
pre.rouge .s1 {
  color: #d14;
}
pre.rouge .ss {
  color: #990073;
}
pre.rouge .s, pre.rouge .sa, pre.rouge .dl {
  color: #d14;
}
pre.rouge .na {
  color: #008080;
}
pre.rouge .bp {
  color: #999999;
}
pre.rouge .nb {
  color: #0086B3;
}
pre.rouge .nc {
  color: #445588;
  font-weight: bold;
}
pre.rouge .no {
  color: #008080;
}
pre.rouge .nd {
  color: #3c5d5d;
  font-weight: bold;
}
pre.rouge .ni {
  color: #800080;
}
pre.rouge .ne {
  color: #990000;
  font-weight: bold;
}
pre.rouge .nf, pre.rouge .fm {
  color: #990000;
  font-weight: bold;
}
pre.rouge .nl {
  color: #990000;
  font-weight: bold;
}
pre.rouge .nn {
  color: #555555;
}
pre.rouge .nt {
  color: #000080;
}
pre.rouge .vc {
  color: #008080;
}
pre.rouge .vg {
  color: #008080;
}
pre.rouge .vi {
  color: #008080;
}
pre.rouge .nv, pre.rouge .vm {
  color: #008080;
}
pre.rouge .ow {
  color: #000000;
  font-weight: bold;
}
pre.rouge .o {
  color: #000000;
  font-weight: bold;
}
pre.rouge .w {
  color: #bbbbbb;
}
pre.rouge {
  background-color: #f8f8f8;
}
</style>
</body>
</html>