#LyX 2.3 created this file. For more info see http://www.lyx.org/
\lyxformat 544
\begin_document
\begin_header
\save_transient_properties true
\origin unavailable
\textclass article
\begin_preamble
\usepackage{parskip}

\usepackage[hang,scriptsize]{subfigure}
\usepackage[format=hang,
font={footnotesize},
labelfont={bf},
margin=1cm,
aboveskip=5pt,
position=bottom]{caption}

\usepackage{float}
\usepackage{color}
\usepackage{calc}

\definecolor{linkblue}{rgb}{0,0,0.4}
\definecolor{navy}{rgb}{0,0,0.3}
\definecolor{light-gray}{gray}{0.98}
\definecolor{dark-gray}{gray}{0.45}

\usepackage{dsfont}

\usepackage[utf8]{inputenc}

\newcommand{\wframe}[1]{\frame{#1}}

\usepackage[ruled,vlined]{algorithm2e}

\usepackage{booktabs}

\usepackage{lastpage}

\usepackage[a-2b]{pdfx}

\begin{filecontents*}{\jobname.xmpdata}
  \Title{Validierung des Co-Simulationsmasterprogramms MASTERSIM}
  \Author{A. Nicolai}
  \Keywords{Co-Simulation\sep FMI\sep MASTERSIM\sep Validierung\sep Genauigkeit}
  \Publisher{Qucosa}
\end{filecontents*}
\end_preamble
\use_default_options false
\maintain_unincluded_children false
\language ngerman
\language_package default
\inputencoding utf8
\fontencoding global
\font_roman "lmodern" "default"
\font_sans "default" "default"
\font_typewriter "default" "default"
\font_math "auto" "auto"
\font_default_family default
\use_non_tex_fonts false
\font_sc false
\font_osf false
\font_sf_scale 100 100
\font_tt_scale 100 100
\use_microtype false
\use_dash_ligatures true
\graphics default
\default_output_format default
\output_sync 0
\bibtex_command default
\index_command default
\paperfontsize 10
\spacing single
\use_hyperref true
\pdf_title "Validation of the FMI co-simulation master program MasterSim"
\pdf_author "Andreas Nicolai"
\pdf_keywords "Co-Simulation, FMI, validation, standard compliance, accuracy"
\pdf_bookmarks true
\pdf_bookmarksnumbered false
\pdf_bookmarksopen false
\pdf_bookmarksopenlevel 1
\pdf_breaklinks false
\pdf_pdfborder true
\pdf_colorlinks true
\pdf_backref false
\pdf_pdfusetitle true
\pdf_quoted_options "linkcolor=linkblue, citecolor=linkblue, urlcolor=linkblue, bookmarksnumbered=true"
\papersize a4paper
\use_geometry true
\use_package amsmath 2
\use_package amssymb 2
\use_package cancel 1
\use_package esint 1
\use_package mathdots 1
\use_package mathtools 1
\use_package mhchem 1
\use_package stackrel 1
\use_package stmaryrd 1
\use_package undertilde 1
\cite_engine basic
\cite_engine_type default
\biblio_style plain
\use_bibtopic false
\use_indices false
\paperorientation portrait
\suppress_date false
\justification true
\use_refstyle 0
\use_minted 0
\index Stichwortverzeichnis
\shortcut idx
\color #008000
\end_index
\leftmargin 2.5cm
\topmargin 2.5cm
\rightmargin 2cm
\bottommargin 2cm
\secnumdepth 3
\tocdepth 3
\paragraph_separation skip
\defskip smallskip
\is_math_indent 0
\math_numbering_side default
\quotes_style german
\dynamic_quotes 0
\papercolumns 1
\papersides 1
\paperpagestyle fancy
\listings_params "language={C++},basicstyle={\scriptsize\ttfamily\color{black}},commentstyle={\ttfamily\itshape\color{dark-gray}},stepnumber=1,showspaces=false,showstringspaces=false,showtabs=false,frame=single,tabsize=4,captionpos=b,breaklines=true,breakatwhitespace=false,texcl=true"
\tracking_changes false
\output_changes false
\html_math_output 0
\html_css_as_file 0
\html_be_strict false
\end_header

\begin_body

\begin_layout Title
Validierung des Co-Simulations-Masterprogramms MASTERSIM
\end_layout

\begin_layout Author
Andreas Nicolai
\begin_inset Newline newline
\end_inset

TU Dresden
\begin_inset Newline newline
\end_inset


\family typewriter
\size footnotesize
andreas.nicolai@tu-dresden.de
\end_layout

\begin_layout Abstract
Die im Functional Mock-Up Interface (FMI) Standard definierte Co-Simulations-Fun
ktionalität ist vielfältig und enthält viele Implementierungsregeln.
 Die korrekte Umsetzung dieser Regeln ist zwingend notwendig, um Simulationsmode
lle verschiedener Tools/Hersteller gemeinsam gekoppelt einsetzen zu können.
 In diesem Artikel wird die Methodik und Vorgehensweise bei der Prüfung
 der Implementierung des Co-Simulations-Programms MASTERSIM beschrieben.
 Es werden einige der dabei erkannten und behobenen Probleme beim Test der
 Implementierung mit anderen Simulationsmodellen diskutiert, sowie die dafür
 notwendigen Anpassungen und Erweiterungen am MASTERSIM Programm.
 Weiterhin werden die Ansätze zur Automatisierung des Testprozederes beschrieben
 und die verschiedenen entwickelten Skripte vorgestellt.
\end_layout

\begin_layout Standard

\size small
\begin_inset ERT
status open

\begin_layout Plain Layout


\backslash
thispagestyle{fancy}
\end_layout

\begin_layout Plain Layout


\backslash
fancyhf{} %alle Kopf- und Fußzeilenfelder bereinigen
\end_layout

\begin_layout Plain Layout

%
\backslash
fancyhead[L]{
\backslash
includegraphics[width=3cm]{logolinks}} %Kopfzeile links
\end_layout

\begin_layout Plain Layout

%
\backslash
fancyhead[C]{
\backslash
includegraphics[width=9.4cm]{logomitte}} %zentrierte Kopfzeile
\end_layout

\begin_layout Plain Layout

%
\backslash
fancyhead[R]{
\backslash
includegraphics[width=2.5cm]{logorechts}} %Kopfzeile rechts
\end_layout

\begin_layout Plain Layout


\backslash
renewcommand{
\backslash
headrulewidth}{0pt} %obere Trennlinie
\end_layout

\begin_layout Plain Layout


\backslash
fancyfoot[C]{
\backslash
small Seite 
\backslash
thepage
\backslash
 von
\backslash
 
\backslash
pageref{LastPage} } %Seitennummer
\end_layout

\begin_layout Plain Layout


\backslash
renewcommand{
\backslash
footrulewidth}{0.4pt} %untere Trennlinie
\end_layout

\end_inset


\end_layout

\begin_layout Standard

\size small
\begin_inset Newpage pagebreak
\end_inset


\end_layout

\begin_layout Standard

\size small
\begin_inset CommandInset toc
LatexCommand tableofcontents

\end_inset


\end_layout

\begin_layout Standard

\size small
\begin_inset ERT
status open

\begin_layout Plain Layout


\backslash
fancyhf{} %alle Kopf- und Fußzeilenfelder bereinigen
\end_layout

\begin_layout Plain Layout

%
\backslash
fancyhead[L]{} %Kopfzeile links
\end_layout

\begin_layout Plain Layout

%
\backslash
fancyhead[C]{} %zentrierte Kopfzeile
\end_layout

\begin_layout Plain Layout


\backslash
fancyhead[R]{Validatierung des Co-Simulationsmasters MASTERSIM}
\end_layout

\begin_layout Plain Layout

%
\backslash
fancyhead[R]{
\backslash
includegraphics[width=4cm]{gwt_logo}} %Kopfzeile rechts
\end_layout

\begin_layout Plain Layout


\backslash
renewcommand{
\backslash
headrulewidth}{0.4pt} %obere Trennlinie
\end_layout

\begin_layout Plain Layout


\backslash
fancyfoot[L]{
\backslash
small 
\backslash
today} %Seitennummer
\end_layout

\begin_layout Plain Layout


\backslash
fancyfoot[C]{
\backslash
small A.
 Nicolai } %Seitennummer
\end_layout

\begin_layout Plain Layout


\backslash
fancyfoot[R]{
\backslash
small Seite 
\backslash
thepage
\backslash
 von
\backslash
 
\backslash
pageref{LastPage} } %Seitennummer
\end_layout

\begin_layout Plain Layout


\backslash
renewcommand{
\backslash
footrulewidth}{0.4pt} %untere Trennlinie
\end_layout

\end_inset


\end_layout

\begin_layout Standard
\begin_inset Newpage newpage
\end_inset


\end_layout

\begin_layout Section
Hintergrund
\end_layout

\begin_layout Standard
Der 
\emph on
Functional Mock-Up Interface
\emph default
 (FMI) Standard definiert eine Programmierschnittstelle für eine Bibliothek,
 welche eine spezifische Modell-/Berechnungsfunktionalität kapselt.
 Dadurch können Simulationsmodelle zusammen mit anderen Modellen zur Laufzeit
 gekoppelt werden.
 Der Standard defiiert weiterhin den Inhalt und die Struktur von modellbeleitend
en Metadaten, welche die Eigenschaften des Modells und der Schnittstelle
 definieren (z.B.
 die veröffentlichten Variablennamen und -typen, etc.).
\end_layout

\begin_layout Standard
Programme, welche diese Bibliotheken und dazugehörige Metadaten erstellen
 werden als Exporttools bezeichnet.
 Die exportierte Programmbibliothek und Metadaten werden in einer Verzeichnisstr
uktur abgelegt und in einem zip-Archiv verpackt (welches die Endung 
\family typewriter
.fmu
\family default
 trägt) und als 
\emph on
Functional Mock-Up Unit
\emph default
 (FMU) bezeichnet wird.
 Programme, welche derartige FMUs verwenden und damit Simulationen durchführen
 sind Importtools.
 
\end_layout

\begin_layout Standard
Der Standard definiert zwei Kopplungsmodi: 
\emph on
FMI for Model Exchange
\emph default
 und 
\emph on
FMI for Co-Simulation
\emph default
.
 Bei Letzterem enthält jede FMU einen eigenen Zeitintegrator, sofern dynamische
 Gleichungen zu lösen sind.
 Bei Ersterem muss das importierende Tool einen solchen Integrationsalgorithmus
 zentral für alle importierten FMUs bereitstellen.
 Das Programm MASTERSIM ist ein Importtool für Co-Simulation FMUs, daher
 auch 
\emph on
Co-Simulations-Masterprogram
\emph default
 genannt.
\end_layout

\begin_layout Section
Validierungsmethodik
\end_layout

\begin_layout Standard
Bei der Entwicklung des Programms MASTERSIM wurden nach Erreichen einer
 Mindestfunktionalität, entwicklungsbegleitende Modultests entwickelt.
 Diese testen (und demonstrieren) die korrekte Implementierung der verschiedenen
 Masteralgorithmen und Zeitschrittsadaptionstechniken.
 Im Detail sind diese Tests in 
\begin_inset CommandInset citation
LatexCommand cite
key "nicolai:2018:qucosa_MastersimAlgorithms"
literal "false"

\end_inset

 und 
\begin_inset CommandInset citation
LatexCommand cite
key "nicolai:2019:TechReport_MasterSimTestCase"
literal "false"

\end_inset

 beschrieben.
\end_layout

\begin_layout Standard
Die Erstellung des Programms MASTERSIM erfolgt scriptgesteuert.
 Nachgelagert kann ein Python-Script (entwickelt am IBK, TU Dresden) gestartet
 werden, welches eine Verzeichnisstruktur durchläuft, und nach Testfällen
 sucht (
\family typewriter
*.msim
\family default
-Dateien) .
 Existiert für den Testfall ein Unterverzeichnis mit Referenzergebnissen
 für die aktuelle Plattform und Compiler, wird der Testfall simuliert und
 die Simulationsstatistiken und Ergebnisse verglichen.
 Listing
\begin_inset space ~
\end_inset

 zeigt exemplarisch einen Auszug aus dem Validierungsreport:
\end_layout

\begin_layout Standard
\begin_inset Box Frameless
position "t"
hor_pos "c"
has_inner_box 1
inner_pos "t"
use_parbox 0
use_makebox 0
width "100col%"
special "none"
height "1in"
height_special "totalheight"
thickness "0.4pt"
separation "3pt"
shadowsize "4pt"
framecolor "black"
backgroundcolor "none"
status open

\begin_layout Plain Layout
\begin_inset listings
lstparams "basicstyle={\scriptsize},breaklines=true,showstringspaces=false,tabsize=4,basicstyle={\footnotesize\ttfamily\color{black}},commentstyle={\ttfamily\itshape\color{dark-gray}},showtabs=false,frame=single,captionpos=b,breakatwhitespace=false,texcl=true"
inline false
status open

\begin_layout Plain Layout

...
\end_layout

\begin_layout Plain Layout

\end_layout

\begin_layout Plain Layout

../../data/tests/linux64/Math_003_control_loop/Math003_GaussSeidel_2iters_adaptive_R
ichardson.msim
\end_layout

\begin_layout Plain Layout

                                     Reference             New
\end_layout

\begin_layout Plain Layout

  ConvergenceFails                          41 ==           41
\end_layout

\begin_layout Plain Layout

  ConvergenceIterLimitExceeded              41 ==           41
\end_layout

\begin_layout Plain Layout

  ErrorTestFails                            85 ==           85
\end_layout

\begin_layout Plain Layout

  MasterAlgorithmSteps                     324 ==          324
\end_layout

\begin_layout Plain Layout

  --
\end_layout

\begin_layout Plain Layout

  ErrorTestTime                           0.00 ~~         0.00
\end_layout

\begin_layout Plain Layout

  FrameworkTimeWriteOutputs               0.01 ~~         0.07
\end_layout

\begin_layout Plain Layout

  MasterAlgorithmTime                     0.00 ~~         0.00
\end_layout

\begin_layout Plain Layout

  Slave[1]Time                            0.00 ~~         0.00
\end_layout

\begin_layout Plain Layout

  Slave[2]Time                            0.00 ~~         0.00
\end_layout

\begin_layout Plain Layout

  Slave[3]Time                            0.00 ~~         0.00
\end_layout

\begin_layout Plain Layout

  WallClockTime                           0.01 ~~         0.07
\end_layout

\begin_layout Plain Layout

\end_layout

\begin_layout Plain Layout

\end_layout

\begin_layout Plain Layout

Checked: values.csv
\end_layout

\begin_layout Plain Layout

../../data/tests/linux64/Math_003_control_loop/Math003_GaussSeidel_2iters_fixedStep.m
sim
\end_layout

\begin_layout Plain Layout

                                     Reference             New
\end_layout

\begin_layout Plain Layout

  ConvergenceFails                           0 ==            0
\end_layout

\begin_layout Plain Layout

  ConvergenceIterLimitExceeded              95 ==           95
\end_layout

\begin_layout Plain Layout

  ErrorTestFails                             0 ==            0
\end_layout

\begin_layout Plain Layout

  MasterAlgorithmSteps                    1000 ==         1000
\end_layout

\begin_layout Plain Layout

  --
\end_layout

\begin_layout Plain Layout

  ErrorTestTime                           0.00 ~~         0.00
\end_layout

\begin_layout Plain Layout

  FrameworkTimeWriteOutputs               0.02 ~~         0.02
\end_layout

\begin_layout Plain Layout

  MasterAlgorithmTime                     0.00 ~~         0.00
\end_layout

\begin_layout Plain Layout

  Slave[1]Time                            0.00 ~~         0.00
\end_layout

\begin_layout Plain Layout

  Slave[2]Time                            0.00 ~~         0.00
\end_layout

\begin_layout Plain Layout

  Slave[3]Time                            0.00 ~~         0.00
\end_layout

\begin_layout Plain Layout

  WallClockTime                           0.02 ~~         0.02
\end_layout

\begin_layout Plain Layout

\end_layout

\begin_layout Plain Layout

\end_layout

\begin_layout Plain Layout

Checked: values.csv
\end_layout

\begin_layout Plain Layout

\end_layout

\begin_layout Plain Layout

Successful projects:
\end_layout

\begin_layout Plain Layout

\end_layout

\begin_layout Plain Layout

Project path                                                 Wall clock
 time [s]
\end_layout

\begin_layout Plain Layout

FileReaderSlave/LV_Richardson_PredatorFromFile_noiter                  0.318
\end_layout

\begin_layout Plain Layout

Lotka_Volterra_System/LV_Richardson_5iter                              0.244
\end_layout

\begin_layout Plain Layout

Lotka_Volterra_System/LV_Richardson_noiter                             0.224
\end_layout

\begin_layout Plain Layout

Math_003_control_loop/Math003_GaussJacobi_1iters_fixedStep             0.040
\end_layout

\begin_layout Plain Layout

Math_003_control_loop/Math003_GaussSeidel_1iters_fixedStep             0.024
\end_layout

\begin_layout Plain Layout

Math_003_control_loop/Math003_GaussSeidel_2iters_adaptive              0.006
\end_layout

\begin_layout Plain Layout

Math_003_control_loop/Math003_GaussSeidel_2iters_adaptive_Richardson   0.073
\end_layout

\begin_layout Plain Layout

Math_003_control_loop/Math003_GaussSeidel_2iters_fixedStep             0.023
\end_layout

\begin_layout Plain Layout

\end_layout

\end_inset


\end_layout

\end_inset


\end_layout

\begin_layout Standard
\begin_inset CommandInset bibtex
LatexCommand bibtex
btprint "btPrintCited"
bibfiles "/home/ghorwin/svn/mastersim-code/doc/articles/Literature"
options "plaindin"

\end_inset


\end_layout

\end_body
\end_document
